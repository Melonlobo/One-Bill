!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t,a){if(!t)return;if("string"==typeof t)return e(t,a);var i=Object.prototype.toString.call(t).slice(8,-1);"Object"===i&&t.constructor&&(i=t.constructor.name);if("Map"===i||"Set"===i)return Array.from(t);if("Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i))return e(t,a)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var a=0,i=new Array(e);a<e;a++)i[a]=t[a];return i}function a(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function i(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{"9xt4":function(t,e,a){"use strict";a.d(e,"a",(function(){return b}));var i=a("ofXK"),s=a("3Pt+"),o=a("KthW"),r=a("WCGO"),c=a("0jmt"),l=a("+0xr"),u=a("zWnM"),f=a("zeEN"),d=a("fXoL"),b=function(){var t=function t(){n(this,t)};return t.\u0275mod=d.Lb({type:t}),t.\u0275inj=d.Kb({factory:function(e){return new(e||t)},imports:[[i.c,s.l,o.a,r.a,c.a,l.l,u.a,f.a]]}),t}()},"a+RD":function(t,e,a){"use strict";a.d(e,"a",(function(){return C}));var s=a("fXoL"),o=a("xgIS"),r=a("/uUt"),c=a("Kj3r"),l=a("ofXK"),u=a("STbY"),f=a("XiUz"),d=a("NFeN"),b=a("bTqV"),p=a("bSwM"),m=a("3Pt+"),h=["filter"];function g(t,e){if(1&t&&(s.Tb(0,"button",12),s.Tb(1,"mat-icon"),s.Rc(2,"filter_list"),s.Sb(),s.Sb()),2&t){s.fc(2);var a=s.Ac(3);s.mc("matMenuTriggerFor",a)}}function y(t,e){if(1&t&&(s.Tb(0,"div",5),s.Tb(1,"div",6),s.Rc(2),s.Sb(),s.Tb(3,"div",7),s.Tb(4,"mat-icon",8),s.Rc(5,"search"),s.Sb(),s.Ob(6,"input",9,10),s.Sb(),s.Pc(8,g,3,1,"button",11),s.kc(9,1),s.Sb()),2&t){var a=s.fc();s.Cb(2),s.Sc(a.name),s.Cb(6),s.mc("ngIf",!a.hideFilter)}}function S(t,e){if(1&t){var a=s.Ub();s.Tb(0,"button",13),s.bc("click",(function(t){s.Ec(a);var i=e.$implicit;return s.fc().toggleColumnVisibility(i,t)})),s.Tb(1,"mat-checkbox",14,15),s.bc("ngModelChange",(function(t){return s.Ec(a),e.$implicit.visible=t}))("click",(function(t){return s.Ec(a),t.stopPropagation()})),s.Rc(3),s.Sb(),s.Sb()}if(2&t){var i=e.$implicit;s.Cb(1),s.mc("ngModel",i.visible),s.Cb(2),s.Tc(" ",i.name," ")}}var v=["*",[["",8,"actions"]]],T=["*",".actions"],C=function(){var t=function(){function t(){n(this,t),this.filterChange=new s.o}return i(t,[{key:"ngAfterViewInit",value:function(){var t=this;this.hideHeader||Object(o.a)(this.filter.nativeElement,"keyup").pipe(Object(r.a)(),Object(c.a)(150)).subscribe((function(){t.filterChange.emit(t.filter.nativeElement.value)}))}},{key:"toggleColumnVisibility",value:function(t,e){e.stopPropagation(),e.stopImmediatePropagation(),t.visible=!t.visible}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["fury-list"]],viewQuery:function(t,e){var a;1&t&&s.Vc(h,!0),2&t&&s.zc(a=s.cc())&&(e.filter=a.first)},inputs:{name:"name",columns:"columns",hideHeader:"hideHeader",hideFilter:"hideFilter"},outputs:{filterChange:"filterChange"},ngContentSelectors:T,decls:6,vars:2,consts:[[1,"fury-list-table"],["class","fury-list-header","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",4,"ngIf"],["yPosition","below","xPosition","before"],["columnFilter","matMenu"],["class","checkbox-item mat-menu-item",3,"click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",1,"fury-list-header"],[1,"fury-list-name"],["fxLayout","row","fxLayoutAlign","start center","fxFlex",""],[1,"fury-filter-input-icon"],["fxFlex","","placeholder","Search\u2026",1,"fury-filter-input"],["filter",""],["class","fury-column-filter","type","button","mat-icon-button","",3,"matMenuTriggerFor",4,"ngIf"],["type","button","mat-icon-button","",1,"fury-column-filter",3,"matMenuTriggerFor"],[1,"checkbox-item","mat-menu-item",3,"click"],[1,"checkbox",3,"ngModel","ngModelChange","click"],["checkbox",""]],template:function(t,e){1&t&&(s.lc(v),s.Tb(0,"div",0),s.Pc(1,y,10,2,"div",1),s.Tb(2,"mat-menu",2,3),s.Pc(4,S,4,2,"button",4),s.Sb(),s.kc(5),s.Sb()),2&t&&(s.Cb(1),s.mc("ngIf",!e.hideHeader),s.Cb(3),s.mc("ngForOf",e.columns))},directives:[l.o,u.e,l.n,f.d,f.c,f.e,f.b,d.a,b.a,u.d,p.a,m.q,m.t],styles:[".fury-list-table{display:flex;flex-direction:column}.fury-list-table .fury-list-header{padding-left:24px;padding-right:24px;height:64px;border-top-left-radius:8px;border-top-right-radius:8px}@media screen and (max-width:599px){.fury-list-table .fury-list-header{height:auto;padding-top:24px;padding-bottom:24px}}.fury-list-table .fury-list-header .fury-list-name{font-size:20px;line-height:32px;font-weight:500;padding-right:24px}@media screen and (max-width:599px){.fury-list-table .fury-list-header .fury-list-name{border-right:none}}.fury-list-table .fury-list-header .fury-filter-input{font-size:16px;line-height:1.125;border:none;height:32px}.fury-list-table .fury-list-header .fury-filter-input:focus{outline:none}.fury-list-table .fury-list-header .fury-filter-input-icon{width:1.2em;vertical-align:bottom;height:22px;font-size:22px;margin-right:8px}.fury-list-table table{width:100%}.fury-list-table .mat-header-row .mat-header-cell .mat-sort-header-button{text-transform:uppercase}.fury-list-table .mat-cell.image-cell,.fury-list-table .mat-header-cell.image-cell{flex:0;width:59px}.fury-list-table .mat-cell.image-cell img,.fury-list-table .mat-header-cell.image-cell img{border-radius:50%;height:35px;width:35px;margin-right:24px;vertical-align:middle}.fury-list-table .mat-cell,.fury-list-table .mat-header-cell{white-space:nowrap;padding-left:12px;padding-right:12px}.fury-list-table .mat-cell.actions-cell,.fury-list-table .mat-header-cell.actions-cell{flex:0;width:40px;overflow:visible}.fury-list-table .paginator{display:block}"],encapsulation:2}),t}()},zWnM:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var i=a("fXoL"),s=function(){var t=function t(){n(this,t)};return t.\u0275mod=i.Lb({type:t}),t.\u0275inj=i.Kb({factory:function(e){return new(e||t)},imports:[[]]}),t}()},zeEN:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var i=a("fXoL"),s=function(){var t=function t(){n(this,t)};return t.\u0275mod=i.Lb({type:t}),t.\u0275inj=i.Kb({factory:function(e){return new(e||t)},imports:[[]]}),t}()},zxEL:function(e,a,s){"use strict";s.r(a),s.d(a,"TariffSettingsModule",(function(){return Dt}));var o=s("ofXK"),r=s("3Pt+"),c=s("VCcF"),l=s("WCGO"),u=s("KthW"),f=s("9xt4"),d=s("tyNb"),b=s("nStZ"),p=s("Ku73"),m=s("KGtp"),h=s("zSPf"),g=s("fXoL"),y=s("dNgK"),S=s("XiUz"),v=s("kmnG"),T=s("qFsG"),C=s("d3UM"),k=s("FKr1"),x=["allSelected"];function M(t,e){if(1&t&&(g.Tb(0,"mat-option",10),g.Rc(1),g.Sb()),2&t){var a=e.$implicit;g.mc("value",a.value),g.Cb(1),g.Tc(" ",a.label," ")}}function w(t,e){1&t&&(g.Tb(0,"mat-error"),g.Rc(1,"Utility type is required."),g.Sb())}function I(t,e){if(1&t){var a=g.Ub();g.Tb(0,"mat-option",11),g.bc("click",(function(){g.Ec(a);var t=g.fc(),e=g.Ac(20);return t.tosslePerOne(e.viewValue)})),g.Rc(1),g.Sb()}if(2&t){var i=e.$implicit;g.mc("optionSelected",i.selected)("value",i.id),g.Cb(1),g.Tc(" ",i.clientName," ")}}var P,_,N=((P=function(){function e(t,a,i){n(this,e),this.fb=t,this.cd=a,this.snackbar=i,this.listParameters=[{label:"Select",value:0}],this.listUtilityTypes=[{label:"Select",value:0}],this.listClients=[],this.utilityType="",this.parameter="",this.tariffName="",this.wefDate="",this.selectedClients=[],this.tariffMaster={},this.season_tariff=t.group({tariff_name:["",r.y.required],utility_type:[null,r.y.required],client_select:[null,r.y.required]})}return i(e,[{key:"ngOnInit",value:function(){this.tariffMaster&&(this.tariffName=this.tariffMaster.tariffName)}},{key:"onChangeUtilityType",value:function(t){var e=this;this.utilityTypeId=t,this.utilityType=this.utilityTypes.find((function(t){return t.value===e.utilityTypeId})).label}},{key:"onChangeParameter",value:function(t){var e=this;this.parameterId=t,this.parameter=this.parameters.find((function(t){return t.value===e.parameterId})).label}},{key:"tosslePerOne",value:function(t){if(this.allSelected.selected)return this.allSelected.deselect(),!1;this.season_tariff.controls.client_select.value.length==this.clients.length&&this.allSelected.select()}},{key:"toggleAllSelection",value:function(){this.season_tariff.controls.client_select.patchValue(this.allSelected.selected?[].concat(t(this.clients.map((function(t){return t.id}))),[0]):[])}},{key:"utilityTypes",get:function(){return this.listUtilityTypes},set:function(t){t&&t.length?(this.listUtilityTypes=t,this.tariffMaster&&(this.utilityType=this.tariffMaster.parameter,this.utilityTypeId=this.tariffMaster.utilityTypeId,this.season_tariff.controls.utility_type.setValue(this.utilityTypeId))):this.listUtilityTypes=[{label:"Select",value:0}]}},{key:"parameters",get:function(){return this.listParameters},set:function(t){this.listParameters=t&&t.length?t:[{label:"Select",value:0}]}},{key:"clients",get:function(){return this.listClients},set:function(e){if(e&&e.length&&(this.listClients=e,this.tariffMaster&&this.tariffMaster.tariffClients&&this.tariffMaster.tariffClients.length)){for(var a=0;a<this.tariffMaster.tariffClients.length;a++)this.tariffMaster.tariffClients[a].clientId&&this.tariffMaster.tariffClients[a].clientId>0&&(this.selectedClients[a]=this.tariffMaster.tariffClients[a].clientId);this.season_tariff.controls.client_select.patchValue(t(this.tariffMaster.tariffClients.filter((function(t){return t.clientId>0})).map((function(t){return t.clientId}))))}}},{key:"data",set:function(t){t&&(this.tariffMaster=t)}}]),e}()).\u0275fac=function(t){return new(t||P)(g.Nb(r.f),g.Nb(g.h),g.Nb(y.b))},P.\u0275cmp=g.Hb({type:P,selectors:[["app-create-seasonal-tariff-settings"]],viewQuery:function(t,e){var a;1&t&&g.Vc(x,!0),2&t&&g.zc(a=g.cc())&&(e.allSelected=a.first)},inputs:{utilityTypes:"utilityTypes",parameters:"parameters",clients:"clients",data:"data"},decls:23,vars:8,consts:[["fxLayout","column","fxLayoutGap","8px",1,"content",3,"formGroup"],["fxFlex","auto"],["formControlName","tariff_name","matInput","","required","",3,"ngModel","ngModelChange"],["formControlName","utility_type","required","",3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["multiple","","formControlName","client_select",3,"ngModel","ngModelChange"],[3,"value","click"],["allSelected",""],[3,"optionSelected","value","click",4,"ngFor","ngForOf"],[3,"value"],[3,"optionSelected","value","click"]],template:function(t,e){1&t&&(g.Tb(0,"div",0),g.Tb(1,"mat-form-field",1),g.Tb(2,"mat-label"),g.Rc(3,"Tariff Name"),g.Sb(),g.Tb(4,"input",2),g.bc("ngModelChange",(function(t){return e.tariffName=t})),g.Sb(),g.Tb(5,"mat-hint"),g.Rc(6,"This will be unique tariff name."),g.Sb(),g.Sb(),g.Tb(7,"mat-form-field",1),g.Tb(8,"mat-label"),g.Rc(9,"Utility Type"),g.Sb(),g.Tb(10,"mat-select",3),g.bc("selectionChange",(function(t){return e.onChangeUtilityType(t.value)}))("valueChange",(function(t){return e.utilityTypeId=t})),g.Pc(11,M,2,2,"mat-option",4),g.Sb(),g.Tb(12,"mat-hint"),g.Rc(13,"This will be utility type."),g.Sb(),g.Pc(14,w,2,0,"mat-error",5),g.Sb(),g.Tb(15,"mat-form-field",1),g.Tb(16,"mat-label"),g.Rc(17,"Clients"),g.Sb(),g.Tb(18,"mat-select",6),g.bc("ngModelChange",(function(t){return e.selectedClients=t})),g.Tb(19,"mat-option",7,8),g.bc("click",(function(){return e.toggleAllSelection()})),g.Rc(21,"Select All"),g.Sb(),g.Pc(22,I,2,3,"mat-option",9),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.mc("formGroup",e.season_tariff),g.Cb(4),g.mc("ngModel",e.tariffName),g.Cb(6),g.mc("value",e.utilityTypeId),g.Cb(1),g.mc("ngForOf",e.listUtilityTypes),g.Cb(3),g.mc("ngIf",e.season_tariff.invalid),g.Cb(4),g.mc("ngModel",e.selectedClients),g.Cb(1),g.mc("value",0),g.Cb(3),g.mc("ngForOf",e.clients))},directives:[S.d,S.e,r.r,r.k,v.d,S.b,v.h,r.c,T.b,r.q,r.i,r.x,v.g,C.a,o.n,o.o,k.n,v.c],styles:[""],data:{animation:[b.a,p.a,m.a]}}),P),R=s("+WJP"),O=s("wd/R"),D=s("0IaG"),H=s("sXtk"),F=s("tk/3"),L=((_=function(){function t(e,a){n(this,t),this.http=e,this.envService=a,this.baseUrl="",this.baseUrl=a.backend}return i(t,[{key:"saveTariffMaster",value:function(t){return this.http.post(this.baseUrl+"/tariffs",t)}},{key:"getTariffMasters",value:function(){return this.http.get(this.baseUrl+"/tariffs")}},{key:"updateTariffMaster",value:function(t){return this.http.put(this.baseUrl+"/tariffs/"+t.id,t)}},{key:"saveTariffSettings",value:function(t){return this.http.post(this.baseUrl+"/tariffs/settings",t)}},{key:"getTariffSettings",value:function(){return this.http.get(this.baseUrl+"/tariffs/settings")}},{key:"deleteTariffSettings",value:function(t){return this.http.post(this.baseUrl+"/tariffs/delete/settings",t)}},{key:"deleteTariffMaster",value:function(t){return this.http.delete(this.baseUrl+"/tariffs/"+t.id)}}]),t}()).\u0275fac=function(t){return new(t||_)(g.Xb(F.c),g.Xb(H.a))},_.\u0275prov=g.Jb({token:_,factory:_.\u0275fac,providedIn:"root"}),_),E=s("/t3+"),A=s("bTqV"),G=s("NFeN"),U=s("MutI"),z=s("4FRi"),q=["allSelected"];function V(t,e){if(1&t){var a=g.Ub();g.Tb(0,"mat-option",19),g.bc("click",(function(){g.Ec(a);var t=g.fc(),e=g.Ac(25);return t.tosslePerOne(e.viewValue)})),g.Rc(1),g.Sb()}if(2&t){var i=e.$implicit;g.mc("optionSelected",i.selected)("value",i.id),g.Cb(1),g.Tc(" ",i.description," ")}}var j,B=((j=function(){function e(t,a,i,s,o){n(this,e),this.fb=t,this.tariffItem=a,this.dialogRef=i,this.tariffMasterService=s,this.snackbar=o,this.type="",this.subItems=[],this.selectedSubItems=[],this.dataSource=[],this.columns=[],this.tariffSettings=null,this.typeNameColumnName="Type Name",this.subItemColumnName="Sub Item",this.buttonName="CREATE ITEM",a&&(this.type=a.type,this.subItems=a.subItems,this.dataSource=a.tariffSettings)}return i(e,[{key:"ngOnInit",value:function(){this.createGridColumns(),this.tariff_items_create=this.fb.group({itemName:["",r.y.required],subItem_select:[null,r.y.required]})}},{key:"createGridColumns",value:function(){this.columns=[{name:this.typeNameColumnName,property:"typeName",visible:!0,isModelProperty:!0},{name:this.subItemColumnName,property:"subItemNames",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0,isModelProperty:!1}]}},{key:"close",value:function(){this.dialogRef.close()}},{key:"closeDialog",value:function(){}},{key:"save",value:function(){var t,e=this,a=this.tariff_items_create.controls.itemName.value;if(this.tariffSettings&&a!==this.tariffSettings.typeName){if(this.dataSource.findIndex((function(t){return t.typeName===a}))>-1)return void this.notificationMessage(this.type+" name already exist","red-snackbar")}else if(!this.tariffSettings&&this.dataSource.findIndex((function(t){return t.typeName===a}))>-1)return void this.notificationMessage(this.type+" name already exist","red-snackbar");var i=0;this.dataSource&&this.dataSource.length&&(i=null!==(t=Math.max.apply(Math,this.dataSource.map((function(t){return t.typeId}))))&&void 0!==t?t:0);var n,s=this.tariff_items_create.controls.subItem_select.value,o=[],r="Season"===this.type?1:2,c="";if(s&&s.length){if(s.filter((function(t){return 0!=t})).forEach((function(t){e.tariffSettings?e.tariffItem.tariffSettings.filter((function(t){return t.typeId!==e.tariffSettings.typeId})).forEach((function(e){var a=e.subItems.find((function(e){return e.id===t}));a&&(c+=a.description+",")})):e.dataSource.forEach((function(e){var a=e.subItems.find((function(e){return e.id===t}));a&&(c+=a.description+",")}))})),c&&c.length)return void this.notificationMessage("Already ".concat(c.slice(0,-1)," assigned to another ").concat(this.type),"red-snackbar");s.filter((function(t){return 0!=t})).forEach((function(t){o.push({id:t})}))}n=this.tariffSettings?{typeName:a,typeId:this.tariffSettings.typeId,type:this.tariffSettings.type,subItems:o}:{typeName:a,typeId:i+1,type:r,subItems:o},this.dialogRef.close(n)}},{key:"onDeleteRow",value:function(t){t&&this.deleteTariffSettings(t)}},{key:"onUpdateRow",value:function(e){if(this.tariffSettings={},e){if(this.tariff_items_create.controls.itemName.setValue(e.typeName),e.subItems&&e.subItems.length){for(var a=0;a<e.subItems.length;a++)this.selectedSubItems[a]=e.subItems[a].id;this.tariff_items_create.controls.subItem_select.patchValue(t(e.subItems.map((function(t){return t.id}))))}this.tariffSettings=e,this.buttonName="UPDATE ITEM"}}},{key:"tosslePerOne",value:function(t){if(this.allSelected.selected)return this.allSelected.deselect(),!1;this.tariff_items_create.controls.subItem_select.value.length==this.subItems.length&&this.allSelected.select()}},{key:"toggleAllSelection",value:function(){this.tariff_items_create.controls.subItem_select.patchValue(this.allSelected.selected?[].concat(t(this.subItems.map((function(t){return t.id}))),[0]):[])}},{key:"deleteTariffSettings",value:function(t){var e=this;this.tariffMasterService.deleteTariffSettings(t).subscribe({next:function(a){if(a){if(e.tariffItem.tariffSettings&&e.tariffItem.tariffSettings.length){var i=e.tariffItem.tariffSettings.findIndex((function(e){return e.typeName===t.typeName&&e.typeId===t.typeId&&e.type===t.type}));i>-1&&(e.dataSource=[],e.tariffItem.tariffSettings.splice(i,1),e.dataSource=e.tariffItem.tariffSettings,e.tableStructureComponent.tableData=e.dataSource)}else e.dataSource=[],e.dataSource=e.tariffItem.tariffSettings,e.tableStructureComponent.tableData=e.dataSource;e.notificationMessage("Tariff settings deleted successfully","green-snackbar")}else e.notificationMessage("Tariff settings delete failed","red-snackbar")},error:function(t){e.notificationMessage("Tariff settings delete failed","red-snackbar")}})}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}}]),e}()).\u0275fac=function(t){return new(t||j)(g.Nb(r.f),g.Nb(D.a),g.Nb(D.h),g.Nb(L),g.Nb(y.b))},j.\u0275cmp=g.Hb({type:j,selectors:[["fury-add-tariff-items"]],viewQuery:function(t,e){var a;1&t&&(g.Vc(q,!0),g.Jc(R.a,!0)),2&t&&(g.zc(a=g.cc())&&(e.allSelected=a.first),g.zc(a=g.cc())&&(e.tableStructureComponent=a.first))},decls:36,vars:12,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"padding-top"],[1,"person"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","48px"],["fxFlex",""],["formControlName","itemName","matInput","","required",""],["multiple","","formControlName","subItem_select",3,"ngModel","ngModelChange"],[3,"value","click"],["allSelected",""],[3,"optionSelected","value","click",4,"ngFor","ngForOf"],[2,"width","100%",3,"visibleUpdateButton","visibleDeleteButton","tableData","columns","updateRow","deleteRow"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button",""],[3,"optionSelected","value","click"]],template:function(t,e){1&t&&(g.Tb(0,"div",0),g.Tb(1,"mat-toolbar",1),g.Tb(2,"span"),g.Rc(3),g.Sb(),g.Ob(4,"span",2),g.Tb(5,"button",3),g.bc("click",(function(){return e.close()})),g.Tb(6,"mat-icon",4),g.Rc(7,"close"),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(8,"form",5),g.bc("ngSubmit",(function(){return e.save()})),g.Tb(9,"mat-dialog-content"),g.Tb(10,"fury-card"),g.Tb(11,"fury-card-content",6),g.Tb(12,"div",7),g.Tb(13,"div",8),g.Tb(14,"mat-form-field",9),g.Tb(15,"mat-label"),g.Rc(16),g.Sb(),g.Ob(17,"input",10),g.Tb(18,"mat-hint"),g.Rc(19),g.Sb(),g.Sb(),g.Tb(20,"mat-form-field",9),g.Tb(21,"mat-label"),g.Rc(22,"Sub Items"),g.Sb(),g.Tb(23,"mat-select",11),g.bc("ngModelChange",(function(t){return e.selectedSubItems=t})),g.Tb(24,"mat-option",12,13),g.bc("click",(function(){return e.toggleAllSelection()})),g.Rc(26,"Select All "),g.Sb(),g.Pc(27,V,2,3,"mat-option",14),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(28,"div",7),g.Tb(29,"div",8),g.Tb(30,"app-table-structure",15),g.bc("updateRow",(function(t){return e.onUpdateRow(t)}))("deleteRow",(function(t){return e.onDeleteRow(t)})),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(31,"mat-dialog-actions",16),g.Tb(32,"button",17),g.bc("click",(function(){return e.closeDialog()})),g.Rc(33,"CANCEL"),g.Sb(),g.Tb(34,"button",18),g.Rc(35),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.Cb(3),g.Tc("Add ",e.type,""),g.Cb(5),g.mc("formGroup",e.tariff_items_create),g.Cb(8),g.Tc("",e.type," Name"),g.Cb(3),g.Tc("This will be ",e.type," name."),g.Cb(4),g.mc("ngModel",e.selectedSubItems),g.Cb(1),g.mc("value",0),g.Cb(3),g.mc("ngForOf",e.subItems),g.Cb(3),g.mc("visibleUpdateButton",!0)("visibleDeleteButton",!0)("tableData",e.dataSource)("columns",e.columns),g.Cb(5),g.Sc(e.buttonName))},directives:[D.i,E.a,A.a,G.a,U.c,r.z,r.r,r.k,D.f,z.a,z.c,S.d,S.e,v.d,S.b,v.h,r.c,T.b,r.q,r.i,r.x,v.g,C.a,k.n,o.n,R.a,D.c,S.c],styles:[".task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]}),j),W=s("xXXn");function X(t,e){if(1&t&&(g.Tb(0,"mat-option",18),g.Rc(1),g.Sb()),2&t){var a=e.$implicit;g.mc("value",a.value),g.Cb(1),g.Tc(" ",a.label," ")}}function K(t,e){1&t&&(g.Tb(0,"mat-error"),g.Rc(1,"Season is required."),g.Sb())}function J(t,e){if(1&t&&(g.Tb(0,"mat-option",18),g.Rc(1),g.Sb()),2&t){var a=e.$implicit;g.mc("value",a.value),g.Cb(1),g.Tc(" ",a.label," ")}}function $(t,e){1&t&&(g.Tb(0,"mat-error"),g.Rc(1,"Week type is required."),g.Sb())}function Q(t,e){if(1&t&&(g.Tb(0,"mat-option",18),g.Rc(1),g.Sb()),2&t){var a=e.$implicit;g.mc("value",a.value),g.Cb(1),g.Tc(" ",a.label," ")}}function Y(t,e){1&t&&(g.Tb(0,"mat-error"),g.Rc(1,"Type is required."),g.Sb())}var Z,tt,et=((tt=function(){function t(e,a,i){n(this,t),this.fb=e,this.snackbar=a,this.dialog=i,this._gap=16,this.gap=this._gap+"px",this.col2="1 1 calc(50% - ".concat(this._gap/2,"px)"),this.col3="1 1 calc(33.3333% - ".concat(this._gap/1.5,"px)"),this.col4="1 1 calc(5% - ".concat(this._gap/1,"px)"),this.dataSource=[],this.deletedDataSource=[],this.sortDataSource=[],this.columns=[],this.tariffMaster={},this.months=[],this.peakTypes=[],this.days=[],this.seasons=[],this.weekTypes=[],this.tariffSettings=[],this.isDisable=new g.o,this.tariffSettingsChanged=new g.o,this.season="",this.peakType="",this.weekType="",this.fromHour="00:00:00",this.toHour="23:59:59",this.rowNumberColumnName="#",this.seasonColumnName="Season",this.weekTypeColumnName="Week Type",this.peakTypeColumnName="Peak Type",this.fromHourColumnName="From",this.toHourColumnName="To",this.rateColumnName="Rate",this.isContentChange=!1,this.peak_settings=e.group({season:[null,r.y.required],peakType:[null,r.y.required],weekType:[null,r.y.required],fromHour:["",r.y.required],toHour:["",r.y.required],rate:[null,r.y.required]})}return i(t,[{key:"ngOnInit",value:function(){this.createGridColumns()}},{key:"createGridColumns",value:function(){this.columns=[{name:this.rowNumberColumnName,property:"rowNumber",visible:!0,isModelProperty:!0},{name:this.seasonColumnName,property:"season",visible:!0,isModelProperty:!0},{name:this.weekTypeColumnName,property:"weekType",visible:!0,isModelProperty:!0},{name:this.peakTypeColumnName,property:"peakType",visible:!0,isModelProperty:!0},{name:this.fromHourColumnName,property:"hourStart",visible:!0,isModelProperty:!0},{name:this.toHourColumnName,property:"hourEnd",visible:!0,isModelProperty:!0},{name:this.rateColumnName,property:"rate",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0,isModelProperty:!1}]}},{key:"addNewItem",value:function(){this.peak_settings.valid?(this.addItemToDataSource(),this.peak_settings.reset(),this.fromHour="00:00:00",this.toHour="23:59:59",this.peak_settings.controls.fromHour.setValue(this.fromHour),this.peak_settings.controls.toHour.setValue(this.toHour),this.isDisable.emit(!1)):this.validateAllFormFields(this.peak_settings)}},{key:"addItemToDataSource",value:function(){var t=this,e=O(),a=O();if(this.seasons&&this.seasons.length&&this.weekTypes&&this.weekTypes.length)if(this.sortDataSource.findIndex((function(e){return e.seasonId===t.seasonId&&e.weekTypeId===t.weekTypeId&&e.hourEnd===t.toHour}))>-1)this.notificationMessage("Time already exist","red-snackbar");else{if(this.sortDataSource.sort((function(t,e){return e.hourEnd.localeCompare(t.hourEnd)})).find((function(e){return e.monthId===t.seasonId&&e.dayId===t.weekTypeId}))){if(e=O(this.fromHour,"HH:mm:ss"),a=O(this.toHour,"HH:mm:ss"),this.strfromHour=""+e.format("HH:mm:ss"),this.strToHour=""+a.format("HH:mm:ss"),e>a)return void this.notificationMessage("To-hour should be greater than From-hour","red-snackbar")}else e=O(this.fromHour,"HH:mm:ss"),a=O(this.toHour,"HH:mm:ss"),this.strfromHour=""+e.format("HH:mm:ss"),this.strToHour=""+a.format("HH:mm:ss");var i={season:this.season,seasonId:this.seasonId,weekType:this.weekType,weekTypeId:this.weekTypeId,peakType:this.peakType,peakTypeId:this.peakTypeId,hourStart:""+this.strfromHour,hourEnd:""+this.strToHour,rate:Number(this.rate),rowNumber:this.dataSource&&this.dataSource.length?this.dataSource.length+1:1};i&&(this.isContentChange=!0,this.dataSource.push(i)),this.tableStructureComponent.tableData=this.sortDataSource=this.dataSource,"23:59:59"!==this.strToHour&&(this.fromHour=this.strToHour.slice(0,-1)+"1",this.toHour="23:59:59")}else this.notificationMessage("Months Or Days not configured","red-snackbar")}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"onChangeWeekTypes",value:function(t){var e=this;if(this.weekTypeId=t,this.weekType=this.weekTypes.find((function(t){return t.value===e.weekTypeId})).label,this.seasonId&&this.weekTypeId){var a=this.sortDataSource.sort((function(t,e){return e.hourEnd.localeCompare(t.hourEnd)})).find((function(t){return t.monthId===e.seasonId&&t.dayId===e.weekTypeId}));a?(this.fromHour=a.hourStart,this.toHour="23:59:59"):(this.fromHour="00:00:00",this.toHour="23:59:59")}}},{key:"onChangeType",value:function(t){var e=this;if(this.peakTypeId=t,this.peakType=this.peakTypes.find((function(t){return t.value===e.peakTypeId})).label,this.seasonId&&this.weekTypeId){var a=this.sortDataSource.sort((function(t,e){return e.hourEnd.localeCompare(t.hourEnd)})).find((function(t){return t.monthId===e.seasonId&&t.dayId===e.weekTypeId}));a?(this.fromHour=a.hourStart,this.toHour="23:59:59"):(this.fromHour="00:00:00",this.toHour="23:59:59")}}},{key:"onChangeSeasons",value:function(t){var e=this;if(this.seasonId=t,this.season=this.seasons.find((function(t){return t.value===e.seasonId})).label,this.seasonId&&this.weekTypeId){var a=this.sortDataSource.sort((function(t,e){return e.hourEnd.localeCompare(t.hourEnd)})).find((function(t){return t.monthId===e.seasonId&&t.dayId===e.weekTypeId}));a?(this.fromHour=a.hourStart,this.toHour="23:59:59"):(this.fromHour="00:00:00",this.toHour="23:59:59")}}},{key:"validateAllFormFields",value:function(t){var e=this;Object.keys(t.controls).forEach((function(a){var i=t.get(a);i instanceof r.g?i.markAsTouched({onlySelf:!0}):i instanceof r.j&&e.validateAllFormFields(i)}))}},{key:"onDeleteRow",value:function(t){var e=this;this.dialog.open(W.a,{data:{label:"Are you sure you want to Delete?",selected:!1}}).afterClosed().subscribe((function(a){if(a){var i=e.dataSource.findIndex((function(e){return e.seasonId==t.seasonId&&e.peakTypeId===t.peakTypeId&&e.weekTypeId===t.weekTypeId}));i>-1&&(e.deletedDataSource.push(e.dataSource[i]),e.dataSource.splice(i,1)),e.tableStructureComponent.tableData=e.dataSource,e.isDisable.emit(!(e.dataSource&&e.dataSource.length>0))}}))}},{key:"addItem",value:function(t){var e,a=this;e=this.tariffSettings.filter("Season"===t?function(t){return 1==t.type}:function(t){return 2==t.type}),this.dialog.open(B,{data:{type:t,subItems:"Season"==t?this.months:this.days,tariffSettings:e}}).afterClosed().subscribe((function(t){t&&a.tariffSettingsChanged.emit(t)}))}},{key:"data",set:function(t){if(t&&(this.tariffMaster=t,t.seasonPeakSettings&&t.seasonPeakSettings.length)){for(var e=0;e<t.seasonPeakSettings.length;e++)this.tariffMaster.seasonPeakSettings[e].rowNumber=e+1;this.dataSource=this.sortDataSource=t.seasonPeakSettings}}}]),t}()).\u0275fac=function(t){return new(t||tt)(g.Nb(r.f),g.Nb(y.b),g.Nb(D.b))},tt.\u0275cmp=g.Hb({type:tt,selectors:[["app-create-peak-settings"]],viewQuery:function(t,e){var a;1&t&&g.Jc(R.a,!0),2&t&&g.zc(a=g.cc())&&(e.tableStructureComponent=a.first)},inputs:{months:"months",peakTypes:"peakTypes",days:"days",seasons:"seasons",weekTypes:"weekTypes",tariffSettings:"tariffSettings",data:"data"},outputs:{isDisable:"isDisable",tariffSettingsChanged:"tariffSettingsChanged"},decls:63,vars:17,consts:[["fxLayout","row","fxLayoutGap","8px",1,"actions"],["fxFlex","noshrink","fxLayout","column","fxLayout.gt-sm","column","fxLayoutAlign.gt-sm","start stretch",3,"fxLayoutGap"],[3,"formGroup"],[1,"person"],["fxLayout","row","fxLayoutGap","8px",1,"content"],["fxFlex","auto"],["formControlName","season","required","",3,"value","selectionChange","valueChange"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["formControlName","weekType","required","",3,"value","selectionChange","valueChange"],["formControlName","peakType","required","",3,"value","selectionChange","valueChange"],["formControlName","fromHour","type","time","step","2","format","hh:mm:ss","matInput","","required","",3,"ngModel","ngModelChange"],["formControlName","toHour","type","time","step","2","format","hh:mm:ss","matInput","","required","",3,"ngModel","ngModelChange"],["formControlName","rate","matInput","","required","",3,"ngModel","ngModelChange"],[2,"text-align","right"],["fxLayout","row",1,"result",2,"padding-top","10px"],[2,"width","100%",3,"visibleDeleteButton","tableData","columns","deleteRow"],[3,"value"]],template:function(t,e){1&t&&(g.Tb(0,"div",0),g.Tb(1,"div",1),g.Tb(2,"form",2),g.Tb(3,"div",3),g.Tb(4,"div",4),g.Tb(5,"mat-form-field",5),g.Tb(6,"mat-label"),g.Rc(7,"Seasons"),g.Sb(),g.Tb(8,"mat-select",6),g.bc("selectionChange",(function(t){return e.onChangeSeasons(t.value)}))("valueChange",(function(t){return e.seasonId=t})),g.Pc(9,X,2,2,"mat-option",7),g.Sb(),g.Tb(10,"mat-hint"),g.Rc(11,"This will be season."),g.Sb(),g.Pc(12,K,2,0,"mat-error",8),g.Sb(),g.Tb(13,"div",5),g.Tb(14,"button",9),g.bc("click",(function(){return e.addItem("Season")})),g.Tb(15,"mat-icon"),g.Rc(16,"add"),g.Sb(),g.Sb(),g.Sb(),g.Tb(17,"mat-form-field",5),g.Tb(18,"mat-label"),g.Rc(19,"Week Types"),g.Sb(),g.Tb(20,"mat-select",10),g.bc("selectionChange",(function(t){return e.onChangeWeekTypes(t.value)}))("valueChange",(function(t){return e.weekTypeId=t})),g.Pc(21,J,2,2,"mat-option",7),g.Sb(),g.Tb(22,"mat-hint"),g.Rc(23,"This will be week type."),g.Sb(),g.Pc(24,$,2,0,"mat-error",8),g.Sb(),g.Tb(25,"div",5),g.Tb(26,"button",9),g.bc("click",(function(){return e.addItem("WeekType")})),g.Tb(27,"mat-icon"),g.Rc(28,"add"),g.Sb(),g.Sb(),g.Sb(),g.Tb(29,"mat-form-field",5),g.Tb(30,"mat-label"),g.Rc(31,"Type"),g.Sb(),g.Tb(32,"mat-select",11),g.bc("selectionChange",(function(t){return e.onChangeType(t.value)}))("valueChange",(function(t){return e.peakTypeId=t})),g.Pc(33,Q,2,2,"mat-option",7),g.Sb(),g.Tb(34,"mat-hint"),g.Rc(35,"This will be peak type."),g.Sb(),g.Pc(36,Y,2,0,"mat-error",8),g.Sb(),g.Sb(),g.Sb(),g.Tb(37,"div",3),g.Tb(38,"div",4),g.Tb(39,"mat-form-field",5),g.Tb(40,"mat-label"),g.Rc(41,"From"),g.Sb(),g.Tb(42,"input",12),g.bc("ngModelChange",(function(t){return e.fromHour=t})),g.Sb(),g.Tb(43,"mat-hint"),g.Rc(44,"This will be from Hour start."),g.Sb(),g.Sb(),g.Tb(45,"mat-form-field",5),g.Tb(46,"mat-label"),g.Rc(47,"To"),g.Sb(),g.Tb(48,"input",13),g.bc("ngModelChange",(function(t){return e.toHour=t})),g.Sb(),g.Tb(49,"mat-hint"),g.Rc(50,"This will be to Hour end."),g.Sb(),g.Sb(),g.Tb(51,"mat-form-field",5),g.Tb(52,"mat-label"),g.Rc(53,"Rate"),g.Sb(),g.Tb(54,"input",14),g.bc("ngModelChange",(function(t){return e.rate=t})),g.Sb(),g.Tb(55,"mat-hint"),g.Rc(56,"This will be rate."),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(57,"div",15),g.Tb(58,"button",9),g.bc("click",(function(){return e.addNewItem()})),g.Tb(59,"mat-icon"),g.Rc(60,"add"),g.Sb(),g.Sb(),g.Sb(),g.Tb(61,"div",16),g.Tb(62,"app-table-structure",17),g.bc("deleteRow",(function(t){return e.onDeleteRow(t)})),g.Sb(),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.Cb(1),g.mc("fxLayoutGap",e.gap),g.Cb(1),g.mc("formGroup",e.peak_settings),g.Cb(6),g.mc("value",e.seasonId),g.Cb(1),g.mc("ngForOf",e.seasons),g.Cb(3),g.mc("ngIf",e.peak_settings.invalid),g.Cb(8),g.mc("value",e.weekTypeId),g.Cb(1),g.mc("ngForOf",e.weekTypes),g.Cb(3),g.mc("ngIf",e.peak_settings.invalid),g.Cb(8),g.mc("value",e.peakTypeId),g.Cb(1),g.mc("ngForOf",e.peakTypes),g.Cb(3),g.mc("ngIf",e.peak_settings.invalid),g.Cb(6),g.mc("ngModel",e.fromHour),g.Cb(6),g.mc("ngModel",e.toHour),g.Cb(6),g.mc("ngModel",e.rate),g.Cb(8),g.mc("visibleDeleteButton",!0)("tableData",e.dataSource)("columns",e.columns))},directives:[S.d,S.e,S.b,S.c,r.z,r.r,r.k,v.d,v.h,C.a,r.q,r.i,r.x,o.n,v.g,o.o,A.a,G.a,r.c,T.b,R.a,k.n,v.c],styles:[".bottomPadding[_ngcontent-%COMP%]{padding-bottom:10px}"],data:{animation:[b.a,p.a,m.a]}}),tt),at=((Z=function(){function t(e,a,i,s){n(this,t),this.fb=e,this.cd=a,this.snackbar=i,this.dialog=s,this._gap=16,this.gap=this._gap+"px",this.col2="1 1 calc(50% - ".concat(this._gap/2,"px)"),this.col3="1 1 calc(33.3333% - ".concat(this._gap/1.5,"px)"),this.col4="1 1 calc(5% - ".concat(this._gap/1,"px)"),this.dataSource=[],this.deletedDataSource=[],this.columns=[],this.tariffMaster={},this.isDisable=new g.o,this.slabs=[],this.slabName="",this.slabNameColumnName="Slab Name",this.minColumnName="Min",this.maxColumnName="Max",this.rateColumnName="Rate",this.isContentChange=!1,this.slab_rate=e.group({slab:["",r.y.required],minimumConsumption:["",r.y.required],maximumConsumption:["",r.y.required],rate:["",r.y.required]})}return i(t,[{key:"ngOnInit",value:function(){this.createGridColumns()}},{key:"createGridColumns",value:function(){this.columns=[{name:this.slabNameColumnName,property:"slab",visible:!0,isModelProperty:!0},{name:this.minColumnName,property:"consumptionMin",visible:!0,isModelProperty:!0},{name:this.maxColumnName,property:"consumptionMax",visible:!0,isModelProperty:!0},{name:this.rateColumnName,property:"tariffRate",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0,isModelProperty:!1}]}},{key:"addNewItem",value:function(){this.slab_rate.valid?(this.addItemToDataSource(),this.isDisable.emit(!1),this.slab_rate.reset()):this.validateAllFormFields(this.slab_rate)}},{key:"addItemToDataSource",value:function(){var t=this;if(this.dataSource&&this.dataSource.length&&this.dataSource.findIndex((function(e){return e.slab===t.slabName&&e.consumptionMin===t.minimumConsumption&&e.consumptionMax===t.maximumConsumption}))>-1)this.notificationMessage("Slab already exist","red-snackbar");else{var e={slab:this.slabName,tariffRate:Number(this.rate),consumptionMin:Number(this.minimumConsumption),consumptionMax:Number(this.maximumConsumption)};e&&(this.isContentChange=!0,this.dataSource.push(e),this.tableStructureComponent.tableData=this.dataSource.sort((function(t,e){return t.consumptionMin-e.consumptionMin||t.consumptionMax-e.consumptionMax})))}}},{key:"validateAllFormFields",value:function(t){var e=this;Object.keys(t.controls).forEach((function(a){var i=t.get(a);i instanceof r.g?i.markAsTouched({onlySelf:!0}):i instanceof r.j&&e.validateAllFormFields(i)}))}},{key:"onDeleteRow",value:function(t){var e=this;this.dialog.open(W.a,{data:{label:"Are you sure you want to Delete?",selected:!1}}).afterClosed().subscribe((function(a){if(a){var i=e.dataSource.findIndex((function(e){return e.slab==t.slab&&e.consumptionMin===t.consumptionMin&&e.consumptionMax===t.consumptionMax}));i>-1&&(e.deletedDataSource.push(e.dataSource[i]),e.dataSource.splice(i,1)),e.tableStructureComponent.tableData=e.dataSource,e.isDisable.emit(!(e.dataSource&&e.dataSource.length>0))}}))}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"data",set:function(t){t&&(this.tariffMaster=t,t.tariffConsumptionSettings&&t.tariffConsumptionSettings.length&&(this.dataSource=t.tariffConsumptionSettings))}}]),t}()).\u0275fac=function(t){return new(t||Z)(g.Nb(r.f),g.Nb(g.h),g.Nb(y.b),g.Nb(D.b))},Z.\u0275cmp=g.Hb({type:Z,selectors:[["app-create-slab-rate-settings"]],viewQuery:function(t,e){var a;1&t&&g.Jc(R.a,!0),2&t&&g.zc(a=g.cc())&&(e.tableStructureComponent=a.first)},inputs:{slabs:"slabs",data:"data"},outputs:{isDisable:"isDisable"},decls:36,vars:9,consts:[["fxLayout","row","fxLayoutGap","8px",1,"actions"],["fxFlex","noshrink","fxLayout","column","fxLayout.gt-sm","column","fxLayoutAlign.gt-sm","start stretch",3,"fxLayoutGap"],[3,"formGroup"],[1,"person"],["fxLayout","row","fxLayoutGap","8px",1,"content"],["fxFlex","auto"],["formControlName","slab","matInput","","required","",3,"ngModel","ngModelChange"],["type","number","formControlName","minimumConsumption","min","1","matInput","","required","",3,"ngModel","ngModelChange"],["type","number","formControlName","maximumConsumption","matInput","","required","",3,"ngModel","ngModelChange"],[1,"person","padding-top"],["formControlName","rate","matInput","","required","",3,"ngModel","ngModelChange"],["type","button","mat-mini-fab","","color","primary",1,"create",3,"click"],["fxLayout","row",1,"result","padding-top"],[2,"width","100%",3,"visibleDeleteButton","tableData","columns","deleteRow"]],template:function(t,e){1&t&&(g.Tb(0,"div",0),g.Tb(1,"div",1),g.Tb(2,"form",2),g.Tb(3,"div",3),g.Tb(4,"div",4),g.Tb(5,"mat-form-field",5),g.Tb(6,"mat-label"),g.Rc(7,"Slab"),g.Sb(),g.Tb(8,"input",6),g.bc("ngModelChange",(function(t){return e.slabName=t})),g.Sb(),g.Tb(9,"mat-hint"),g.Rc(10,"This will be slab name."),g.Sb(),g.Sb(),g.Tb(11,"mat-form-field",5),g.Tb(12,"mat-label"),g.Rc(13,"Minimum"),g.Sb(),g.Tb(14,"input",7),g.bc("ngModelChange",(function(t){return e.minimumConsumption=t})),g.Sb(),g.Tb(15,"mat-hint"),g.Rc(16,"This will be minimum."),g.Sb(),g.Sb(),g.Tb(17,"mat-form-field",5),g.Tb(18,"mat-label"),g.Rc(19,"Maximum"),g.Sb(),g.Tb(20,"input",8),g.bc("ngModelChange",(function(t){return e.maximumConsumption=t})),g.Sb(),g.Tb(21,"mat-hint"),g.Rc(22,"This will be maximum."),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(23,"div",9),g.Tb(24,"div",4),g.Tb(25,"mat-form-field",5),g.Tb(26,"mat-label"),g.Rc(27,"Rate"),g.Sb(),g.Tb(28,"input",10),g.bc("ngModelChange",(function(t){return e.rate=t})),g.Sb(),g.Tb(29,"mat-hint"),g.Rc(30,"This will be with rate."),g.Sb(),g.Sb(),g.Tb(31,"button",11),g.bc("click",(function(){return e.addNewItem()})),g.Tb(32,"mat-icon"),g.Rc(33,"add"),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(34,"div",12),g.Tb(35,"app-table-structure",13),g.bc("deleteRow",(function(t){return e.onDeleteRow(t)})),g.Sb(),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.Cb(1),g.mc("fxLayoutGap",e.gap),g.Cb(1),g.mc("formGroup",e.slab_rate),g.Cb(6),g.mc("ngModel",e.slabName),g.Cb(6),g.mc("ngModel",e.minimumConsumption),g.Cb(6),g.mc("ngModel",e.maximumConsumption),g.Cb(8),g.mc("ngModel",e.rate),g.Cb(7),g.mc("visibleDeleteButton",!0)("tableData",e.dataSource)("columns",e.columns))},directives:[S.d,S.e,S.b,S.c,r.z,r.r,r.k,v.d,v.h,r.c,T.b,r.q,r.i,r.x,v.g,r.u,A.a,G.a,R.a],styles:[""],data:{animation:[b.a,p.a,m.a]}}),Z),it=s("5cYQ"),nt=s("xHqg");function st(t,e){1&t&&g.Rc(0,"Tariff Settings")}function ot(t,e){1&t&&g.Rc(0,"Season Settings")}var rt,ct,lt,ut=((rt=function(){function t(e,a,i,s,o,r,c){n(this,t),this.snackbar=e,this.masterService=a,this.announcementService=i,this.dialogRef=s,this.defaults=o,this.tariffMasterService=r,this.dialog=c,this._gap=16,this.gap=this._gap+"px",this.col2="1 1 calc(50% - ".concat(this._gap/2,"px)"),this.col3="1 1 calc(33.3333% - ".concat(this._gap/1.5,"px)"),this.utilityTypes=[],this.parameters=[],this.seasons=[],this.weekTypes=[],this.days=[],this.peakTypes=[],this.months=[],this.slabs=[],this.clients=[],this.tariffSettings=[],this.utilityTypeId=0,this.parameterId=0,this.passwordInputType="password",this.tariffName="",this.rate=0,this.peakTypeId=0,this.weekTypeId=0,this.from=0,this.to=0,this.tariffDate=new Date,this.isDisable=!0,this.tariffMaster={},this.peakSettingsHide=!0,this.slabSettingsHide=!0,this.buttonName="CREATE TARIFF",s.disableClose=!0}return i(t,[{key:"ngOnInit",value:function(){this.defaults&&(this.peakSettingsHide=!1,this.buttonName="UPDATE TARIFF"),this.seasonSettingsFormGroup=this.createSeasonalTariffSettingsComponent.season_tariff,this.peakSettingsFormGroup=this.createPeakSettingsComponent.peak_settings,this.getMonths(),this.getDays(),this.getTariffSettings(),this.getUtilityTypes(),this.getParameters(),this.getClients(),this.getSeasons(),this.getWeekTypes(),this.getPeakTypes(),this.getSlabs()}},{key:"getClients",value:function(){var t=this;this.clients=[],this.announcementService.getClients().subscribe((function(e){e&&(t.clients=e)}))}},{key:"submit",value:function(){this.updateValues()&&this.dialogRef.close(this.tariffMaster)}},{key:"updateValues",value:function(){var t=this,e=[],a=this.createSeasonalTariffSettingsComponent.selectedClients;a&&a.forEach((function(t){e.push({clientId:Number(t)})}));var i=0;this.defaults&&(i=this.defaults.id);var n=[],s=this.createPeakSettingsComponent.dataSource;s&&s.length&&this.seasons&&this.seasons.length&&s.forEach((function(e){var a=t.seasons.find((function(t){return t.value===e.seasonId}));if(a&&a.subListItems&&a.subListItems.length&&t.weekTypes&&t.weekTypes.length){var i=t.weekTypes.find((function(t){return t.value===e.weekTypeId}));a.subListItems.forEach((function(t){i.subListItems.forEach((function(s){n.push({season:a.label,seasonId:a.value,weekType:i.label,weekTypeId:i.value,month:t.description,monthId:t.id,day:s.description,dayId:s.id,peakType:e.peakType,peakTypeId:e.peakTypeId,hourStart:e.hourStart,hourEnd:e.hourEnd,rate:e.rate,rowNumber:n&&n.length?n.length+1:1})}))}))}}));var o=this.validateSeasonPeakSettings(n);if(!o)return this.notificationMessage("Season peak settings not fully complete","red-snackbar"),o;var r={id:i,tariffName:this.createSeasonalTariffSettingsComponent.tariffName,utility:this.createSeasonalTariffSettingsComponent.utilityType,utilityTypeId:this.createSeasonalTariffSettingsComponent.utilityTypeId,parameter:this.createSeasonalTariffSettingsComponent.parameter?this.createSeasonalTariffSettingsComponent.parameter:"",parameterId:this.createSeasonalTariffSettingsComponent.parameterId?this.createSeasonalTariffSettingsComponent.parameterId:0,wefDate:this.createSeasonalTariffSettingsComponent.wefDate?new Date(this.createSeasonalTariffSettingsComponent.wefDate):null,tariffClients:e,seasonPeakSettings:n};return this.tariffMaster=r,o}},{key:"validateSeasonPeakSettings",value:function(t){var e=!0,a=0,i=t.find((function(t){return t.monthId}));return t.filter((function(t){return t.monthId===i.monthId})).sort((function(t,e){return t.dayId-e.dayId||t.hourStart.localeCompare(e.hourStart)})).forEach((function(t){var e=new Date,i=new Date,n=t.hourEnd;"23:59:59"===t.hourEnd&&(n="24:00:00");var s=t.hourStart.split(":"),o=n.split(":");e.setHours(Number(s[0]),Number(s[1]),Number(s[2]),0),i.setHours(Number(o[0]),Number(o[1]),Number(o[2]),0);var r=O(i).diff(O(e),"hours");a+=r})),168!=a&&(e=!1),e}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"getUtilityTypes",value:function(){var t=this;this.utilityTypes=[];var e=[];this.masterService.getSystemMasterdata(16,0).subscribe((function(a){a&&(a.forEach((function(t){e.push({label:t.description,value:t.id})})),t.utilityTypes=e)}))}},{key:"getParameters",value:function(){var t=this;this.parameters=[];var e=[];this.masterService.getSystemMasterdata(33,0).subscribe((function(a){a&&(a.forEach((function(t){e.push({label:t.description,value:t.id})})),t.parameters=e)}))}},{key:"getSeasons",value:function(){var t=this;this.seasons=[],this.masterService.getUserMasterParentData(1).subscribe((function(e){e&&e.forEach((function(e){t.seasons.push({label:e.description,value:e.id,subListItems:e.masters})}))}))}},{key:"getWeekTypes",value:function(){var t=this;this.weekTypes=[],this.masterService.getUserMasterParentData(2).subscribe((function(e){e&&e.forEach((function(e){t.weekTypes.push({label:e.description,value:e.id,subListItems:e.masters})}))}))}},{key:"getDays",value:function(){var t=this;this.days=[],this.masterService.getSystemMasterdata(32,0).subscribe((function(e){e&&(t.days=e)}))}},{key:"getPeakTypes",value:function(){var t=this;this.peakTypes=[],this.masterService.getSystemMasterdata(13,0).subscribe((function(e){e&&e.forEach((function(e){t.peakTypes.push({label:e.description,value:e.id})}))}))}},{key:"getMonths",value:function(){var t=this;this.months=[],this.masterService.getSystemMasterdata(65,0).subscribe((function(e){e&&(t.months=e)}))}},{key:"getSlabs",value:function(){var t=this;this.slabs=[],this.masterService.getUserMasterdata(38,0).subscribe((function(e){e&&e.forEach((function(e){t.slabs.push({label:e.description,value:e.id})}))}))}},{key:"isSlabSettingsAdded",value:function(t){this.slabSettingsHide=t}},{key:"isPeakSettingsAdded",value:function(t){this.peakSettingsHide=t}},{key:"close",value:function(){var t=this;this.createPeakSettingsComponent.deletedDataSource&&this.createPeakSettingsComponent.deletedDataSource.length||this.createPeakSettingsComponent.isContentChange?this.dialog.open(W.a,{data:{label:"By Closing the Page added data will be lost . Do you want to Exit?",selected:!1}}).afterClosed().subscribe((function(e){e&&(t.createPeakSettingsComponent.deletedDataSource&&t.createPeakSettingsComponent.deletedDataSource.length?(t.createPeakSettingsComponent.deletedDataSource.forEach((function(e){return t.createPeakSettingsComponent.dataSource.push(e)})),t.createPeakSettingsComponent.deletedDataSource=[]):t.createPeakSettingsComponent.isContentChange=!1,t.dialogRef.close())})):this.dialogRef.close()}},{key:"getTariffSettings",value:function(){var t=this;this.tariffSettings=[],this.tariffMasterService.getTariffSettings().subscribe((function(e){e&&(t.tariffSettings=e)}))}},{key:"saveTariffSettings",value:function(t){var e=this;this.tariffMasterService.saveTariffSettings(t).subscribe({next:function(t){t?e.notificationMessage("Tariff settings saved successfully","green-snackbar"):e.notificationMessage("Tariff settings save failed","red-snackbar"),e.getTariffSettings(),e.getSeasons(),e.getWeekTypes()},error:function(t){e.notificationMessage("Tariff settings save failed","red-snackbar")}})}}]),t}()).\u0275fac=function(t){return new(t||rt)(g.Nb(y.b),g.Nb(h.a),g.Nb(it.a),g.Nb(D.h),g.Nb(D.a),g.Nb(L),g.Nb(D.b))},rt.\u0275cmp=g.Hb({type:rt,selectors:[["app-create-tariff-settings"]],viewQuery:function(t,e){var a;1&t&&(g.Jc(N,!0),g.Jc(et,!0),g.Jc(at,!0)),2&t&&(g.zc(a=g.cc())&&(e.createSeasonalTariffSettingsComponent=a.first),g.zc(a=g.cc())&&(e.createPeakSettingsComponent=a.first),g.zc(a=g.cc())&&(e.createSlabRateSettingsComponent=a.first))},decls:34,vars:19,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"linear"],["stepper","matHorizontalStepper"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"heading"],[1,"subheading"],[3,"utilityTypes","data","parameters","clients"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-button","","type","button",3,"disabled","click"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled"],[3,"tariffSettings","peakTypes","days","months","weekTypes","seasons","data","tariffSettingsChanged","isDisable"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions",2,"padding-top","20px"],["color","primary","mat-button","","matStepperPrevious","","type","button"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled","click"]],template:function(t,e){if(1&t){var a=g.Ub();g.Tb(0,"div",0),g.Tb(1,"mat-toolbar",1),g.Tb(2,"span"),g.Rc(3,"Tariff Settings"),g.Sb(),g.Ob(4,"span",2),g.Tb(5,"button",3),g.bc("click",(function(){return e.close()})),g.Tb(6,"mat-icon",4),g.Rc(7,"close"),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(8,"mat-dialog-content"),g.Tb(9,"fury-card"),g.Tb(10,"mat-horizontal-stepper",5,6),g.Tb(12,"mat-step",7),g.Tb(13,"form",8),g.Pc(14,st,1,0,"ng-template",9),g.Ob(15,"div",10),g.Ob(16,"div",11),g.Ob(17,"app-create-seasonal-tariff-settings",12),g.Tb(18,"div",13),g.Tb(19,"button",14),g.bc("click",(function(){return g.Ec(a),g.Ac(11).reset()})),g.Rc(20,"RESET "),g.Sb(),g.Tb(21,"button",15),g.Rc(22,"NEXT "),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(23,"mat-step"),g.Tb(24,"form",8),g.Pc(25,ot,1,0,"ng-template",9),g.Ob(26,"div",10),g.Ob(27,"div",11),g.Tb(28,"app-create-peak-settings",16),g.bc("tariffSettingsChanged",(function(t){return e.saveTariffSettings(t)}))("isDisable",(function(t){return e.isPeakSettingsAdded(t)})),g.Sb(),g.Tb(29,"div",17),g.Tb(30,"button",18),g.Rc(31,"PREVIOUS"),g.Sb(),g.Tb(32,"button",19),g.bc("click",(function(){return e.submit()})),g.Rc(33),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb()}2&t&&(g.Cb(10),g.mc("linear",!0),g.Cb(2),g.mc("stepControl",e.seasonSettingsFormGroup),g.Cb(1),g.mc("formGroup",e.seasonSettingsFormGroup),g.Cb(4),g.mc("utilityTypes",e.utilityTypes)("data",e.defaults)("parameters",e.parameters)("clients",e.clients),g.Cb(2),g.mc("disabled",e.seasonSettingsFormGroup.pristine),g.Cb(2),g.mc("disabled",e.seasonSettingsFormGroup.invalid),g.Cb(3),g.mc("formGroup",e.peakSettingsFormGroup),g.Cb(4),g.mc("tariffSettings",e.tariffSettings)("peakTypes",e.peakTypes)("days",e.days)("months",e.months)("weekTypes",e.weekTypes)("seasons",e.seasons)("data",e.defaults),g.Cb(4),g.mc("disabled",e.peakSettingsHide),g.Cb(1),g.Tc(" ",e.buttonName," "))},directives:[D.i,E.a,A.a,G.a,U.c,D.f,z.a,nt.a,nt.b,r.z,r.r,r.k,nt.c,N,S.d,S.c,S.e,nt.e,et,nt.f],styles:["[_nghost-%COMP%]{background:url(/assets/img/backgrounds/form-wizard.jpg);background-size:cover;display:block}.title[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.padding[_ngcontent-%COMP%]{padding-bottom:0}.titleSelector[_ngcontent-%COMP%]{margin-top:auto;margin-right:24px}.profile[_ngcontent-%COMP%]{width:50%;display:flex}.profileImage[_ngcontent-%COMP%]{height:100px;margin-left:24px;margin-right:10px;padding:10px}.profileButton[_ngcontent-%COMP%]{align-self:center;padding:3px 15px}.document[_ngcontent-%COMP%]{width:50%;display:flex}.selectDocument[_ngcontent-%COMP%]{width:inherit;margin-right:30px;align-self:center;padding:3px 15px;overflow:hidden}.uploadButton[_ngcontent-%COMP%]{align-self:center;padding:5px 15px;border:1px solid grey;border-radius:3px;box-shadow:1px 1px 1px grey;cursor:pointer}.uploadButtonDisabled[_ngcontent-%COMP%]{align-self:center;padding:5px 15px;border:1px solid rgba(0,0,0,.26);border-radius:3px;box-shadow:1px 1px 1px rgba(0,0,0,.26);color:rgba(0,0,0,.26)}.deleteIcon[_ngcontent-%COMP%]{cursor:pointer}.company[_ngcontent-%COMP%]{align-self:center;margin-left:24px}.companyName[_ngcontent-%COMP%]{margin-top:10px;margin-right:24px}.mat-slide-toggle[_ngcontent-%COMP%]{padding-right:10px}.hide[_ngcontent-%COMP%]{display:none}.under-line[_ngcontent-%COMP%]{text-decoration:underline;cursor:pointer}.duplicateMessage[_ngcontent-%COMP%]{color:red;font-size:small}.duplicate[_ngcontent-%COMP%]{color:red}.task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],data:{animation:[b.a,p.a,m.a]}}),rt),ft=s("KHMF"),dt=s("xBcV"),bt=s("Hbgg"),pt=s("rnAf"),mt=s("rvYj"),ht=s("M9IT"),gt=s("Dh3D"),yt=s("a8hA"),St=((ct=function(){function t(e,a){n(this,t),this.router=e,this.clientSelectionService=a,this.columns=[],this.innerColumns=[],this.columnNames=[],this.tariffMasters=[],this.selectedRows=[],this.rowsSelected=new g.o,this.updateRow=new g.o,this.deleteRow=new g.o,this.addItemClicked=new g.o,this.hideHeader=!0,this.tariffColumnName="Tariff Name",this.utilityTypeColumnName="Utility Type",this.parameterColumnName="Parameter",this.wefDateColumnName="WEF Date",this.formName="Create Tariff"}return i(t,[{key:"ngOnInit",value:function(){this.clientSelectionService.setIsClientVisible(!1),this.formName=this.router.url.includes("slab-tariff-settings")?"Create Slab Tariff":"Create Tariff",this.createGridColumns()}},{key:"createGridColumns",value:function(){this.columns=[{name:this.tariffColumnName,property:"tariffName",visible:!0,isModelProperty:!0},{name:this.utilityTypeColumnName,property:"utility",visible:!0,isModelProperty:!0},{name:"Actions",property:"actions",visible:!0,isModelProperty:!1}]}},{key:"onSelectedRows",value:function(t){this.selectedRows=[],this.selectedRows=t,this.rowsSelected.emit(this.selectedRows)}},{key:"onUpdateRow",value:function(t){this.updateRow.emit(t)}},{key:"onAddItem",value:function(){this.addItemClicked.emit()}},{key:"onDeleteRow",value:function(t){this.deleteRow.emit(t)}},{key:"content",set:function(t){this.sort=t,this.sort&&(this.dataSource.sort=this.sort)}},{key:"dataSource",set:function(t){t&&t.length&&(this.tariffMasters=t)}}]),t}()).\u0275fac=function(t){return new(t||ct)(g.Nb(d.f),g.Nb(yt.a))},ct.\u0275cmp=g.Hb({type:ct,selectors:[["fury-edit-tariff-settings-details"]],viewQuery:function(t,e){var a;1&t&&(g.Jc(ht.a,!0),g.Vc(gt.a,!0)),2&t&&(g.zc(a=g.cc())&&(e.paginator=a.first),g.zc(a=g.cc())&&(e.content=a.first))},inputs:{dataSource:"dataSource",hideHeader:"hideHeader"},outputs:{rowsSelected:"rowsSelected",updateRow:"updateRow",deleteRow:"deleteRow",addItemClicked:"addItemClicked"},decls:5,vars:6,consts:[[1,"person"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","24px"],["fxFlex","",1,"fury-flex-form-field"],[3,"visibleUpdateButton","visibleDeleteButton","formName","tableData","columns","hideHeader","addItemClicked","deleteRow","updateRow","selectedRows"]],template:function(t,e){1&t&&(g.Tb(0,"mat-dialog-content"),g.Tb(1,"div",0),g.Tb(2,"div",1),g.Tb(3,"div",2),g.Tb(4,"app-table-structure",3),g.bc("addItemClicked",(function(){return e.onAddItem()}))("deleteRow",(function(t){return e.onDeleteRow(t)}))("updateRow",(function(t){return e.onUpdateRow(t)}))("selectedRows",(function(t){return e.onSelectedRows(t)})),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.Cb(4),g.mc("visibleUpdateButton",!0)("visibleDeleteButton",!0)("formName",e.formName)("tableData",e.tariffMasters)("columns",e.columns)("hideHeader",!1))},directives:[D.f,S.d,S.e,S.b,R.a],styles:[""]}),ct),vt=function(){return[]},Tt=((lt=function(){function t(e,a,i,s,o){var r;n(this,t),this.tariffMasterService=e,this.date=a,this.dialog=i,this.snackbar=s,this.envService=o,this._gap=16,this.gap=this._gap+"px",this.col2="1 1 calc(50% - ".concat(this._gap/2,"px)"),this.col3="1 1 calc(33.3333% - ".concat(this._gap/1.5,"px)"),this.tariffMasters=[],this.dateFormat="",this.dateFormat=null!==(r=Object(ft.e)("DateFormat"))&&void 0!==r?r:o.dateFormat}return i(t,[{key:"ngOnInit",value:function(){this.getTariffMasters()}},{key:"getTariffMasters",value:function(){var t=this;this.tariffMasterService.getTariffMasters().subscribe((function(e){e&&(e.forEach((function(e){e.wefDateLocal=t.date.transform(e.wefDate,t.dateFormat)})),t.tariffMasters=e.filter((function(t){return t.seasonPeakSettings.length>0})))}))}},{key:"onUpdateRow",value:function(t){var e=this;this.dialog.open(ut,{data:t}).afterClosed().subscribe((function(t){t?e.tariffMasterService.updateTariffMaster(t).subscribe({next:function(t){t?e.notificationMessage("Tariff master updated successfully","green-snackbar"):e.notificationMessage("Tariff master update failed","red-snackbar"),e.getTariffMasters()},error:function(t){e.notificationMessage("Tariff master update failed","red-snackbar")}}):e.getTariffMasters()}))}},{key:"onAddItem",value:function(){var t=this;this.dialog.open(ut).afterClosed().subscribe((function(e){e&&t.tariffMasterService.saveTariffMaster(e).subscribe({next:function(e){e?t.notificationMessage("Tariff master saved successfully","green-snackbar"):t.notificationMessage("Tariff master save failed","red-snackbar"),t.getTariffMasters()},error:function(e){t.notificationMessage("Tariff master save failed","red-snackbar")}})}))}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"onDeleteRow",value:function(t){var e=this;t.isTariffUsed?this.notificationMessage("Cannot delete as tariff is in use","red-snackbar"):this.dialog.open(W.a,{data:{label:"Are you sure you want to Delete?",selected:!1}}).afterClosed().subscribe((function(a){a&&e.tariffMasterService.deleteTariffMaster(t).subscribe({next:function(t){t?e.notificationMessage("Tariff master deleted successfully","green-snackbar"):e.notificationMessage("Tariff master delete failed","red-snackbar"),e.getTariffMasters()},error:function(t){e.notificationMessage("Tariff master delete failed","red-snackbar")}})}))}}]),t}()).\u0275fac=function(t){return new(t||lt)(g.Nb(L),g.Nb(o.f),g.Nb(D.b),g.Nb(y.b),g.Nb(H.a))},lt.\u0275cmp=g.Hb({type:lt,selectors:[["fury-edit-tariff-settings"]],decls:7,vars:6,consts:[["mode","card"],["current","Tariff Settings",3,"crumbs"],["fxFlex","noshrink","fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","start stretch",3,"fxLayoutGap"],["fxLayout","column",1,"containerDiv"],[3,"dataSource","updateRow","deleteRow","addItemClicked"]],template:function(t,e){1&t&&(g.Tb(0,"fury-page-layout",0),g.Tb(1,"fury-page-layout-header"),g.Ob(2,"fury-breadcrumbs",1),g.Sb(),g.Tb(3,"fury-page-layout-content"),g.Tb(4,"div",2),g.Tb(5,"div",3),g.Tb(6,"fury-edit-tariff-settings-details",4),g.bc("updateRow",(function(t){return e.onUpdateRow(t)}))("deleteRow",(function(t){return e.onDeleteRow(t)}))("addItemClicked",(function(){return e.onAddItem()})),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.Cb(2),g.mc("@fadeInRight",void 0)("crumbs",g.qc(5,vt)),g.Cb(1),g.mc("@fadeInUp",void 0),g.Cb(1),g.mc("fxLayoutGap",e.gap),g.Cb(2),g.mc("dataSource",e.tariffMasters))},directives:[dt.a,bt.a,pt.a,mt.a,S.b,S.d,S.c,S.e,St],styles:["[_nghost-%COMP%]{background:url(/assets/img/backgrounds/form-wizard.jpg);background-size:cover;display:block}.title[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.containerDiv[_ngcontent-%COMP%]{padding:0 0 24px;display:flex;width:100%}"],data:{animation:[b.a,p.a]}}),lt),Ct=s("nST0");function kt(t,e){1&t&&g.Rc(0,"Tariff Settings")}function xt(t,e){1&t&&g.Rc(0,"Slab Settings")}var Mt,wt,It,Pt,_t=((Mt=function(){function t(e,a,i,s,o,r,c,l,u,f,d){n(this,t),this.fb=e,this.cd=a,this.snackbar=i,this.masterService=s,this.announcementService=o,this.tariffMasterService=r,this.clientService=c,this.clientSelectionService=l,this.dialogRef=u,this.defaults=f,this.dialog=d,this._gap=16,this.gap=this._gap+"px",this.col2="1 1 calc(50% - ".concat(this._gap/2,"px)"),this.col3="1 1 calc(33.3333% - ".concat(this._gap/1.5,"px)"),this.utilityTypes=[],this.parameters=[],this.days=[],this.peakTypes=[],this.months=[],this.slabs=[],this.clients=[],this.utilityTypeId=0,this.parameterId=0,this.passwordInputType="password",this.tariffName="",this.rate=0,this.peakTypeId=0,this.weekTypeId=0,this.from=0,this.to=0,this.tariffDate=new Date,this.isDisable=!0,this.tariffMaster={},this.isSlabTariffSettings=!1,this.isSeasonalTariffSettings=!1,this.peakSettingsHide=!0,this.slabSettingsHide=!0,this.buttonName="CREATE SLAB TARIFF",u.disableClose=!0}return i(t,[{key:"ngOnInit",value:function(){this.clientSelectionService.setIsClientVisible(!1),this.defaults&&(this.slabSettingsHide=!1,this.buttonName="UPDATE SLAB TARIFF"),this.seasonSettingsFormGroup=this.createSeasonalTariffSettingsComponent.season_tariff,this.slabSettingsFormGroup=this.createSlabRateSettingsComponent.slab_rate,this.getUtilityTypes(),this.getParameters(),this.getClients(),this.getDays(),this.getPeakTypes(),this.getMonths(),this.getSlabs()}},{key:"getClients",value:function(){var t=this;this.clients=[],this.announcementService.getClients().subscribe((function(e){e&&(t.clients=e)}))}},{key:"submit",value:function(){this.updateValues(),this.dialogRef.close(this.tariffMaster)}},{key:"updateValues",value:function(){var t=[],e=this.createSeasonalTariffSettingsComponent.selectedClients;e&&e.forEach((function(e){t.push({clientId:Number(e)})}));var a=0;this.defaults&&(a=this.defaults.id);var i={id:a,tariffName:this.createSeasonalTariffSettingsComponent.tariffName,utility:this.createSeasonalTariffSettingsComponent.utilityType,utilityTypeId:this.createSeasonalTariffSettingsComponent.utilityTypeId,parameter:this.createSeasonalTariffSettingsComponent.parameter,parameterId:this.createSeasonalTariffSettingsComponent.parameterId,wefDate:new Date(this.createSeasonalTariffSettingsComponent.wefDate),tariffClients:t,tariffConsumptionSettings:this.createSlabRateSettingsComponent.dataSource};this.tariffMaster=i}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"getUtilityTypes",value:function(){var t=this;this.utilityTypes=[];var e=[];this.masterService.getSystemMasterdata(16,0).subscribe((function(a){a&&(a.forEach((function(t){e.push({label:t.description,value:t.id})})),t.utilityTypes=e)}))}},{key:"getParameters",value:function(){var t=this;this.parameters=[];var e=[];this.masterService.getSystemMasterdata(33,0).subscribe((function(a){a&&(a.forEach((function(t){e.push({label:t.description,value:t.id})})),t.parameters=e)}))}},{key:"getDays",value:function(){var t=this;this.days=[],this.masterService.getSystemMasterdata(32,0).subscribe((function(e){e&&e.forEach((function(e){t.days.push({label:e.description,value:e.id})}))}))}},{key:"getPeakTypes",value:function(){var t=this;this.peakTypes=[],this.masterService.getSystemMasterdata(13,0).subscribe((function(e){e&&e.forEach((function(e){t.peakTypes.push({label:e.description,value:e.id})}))}))}},{key:"getMonths",value:function(){var t=this;this.months=[],this.masterService.getSystemMasterdata(65,0).subscribe((function(e){e&&e.forEach((function(e){t.months.push({label:e.description,value:e.id})}))}))}},{key:"getSlabs",value:function(){var t=this;this.slabs=[],this.masterService.getUserMasterdata(38,0).subscribe((function(e){e&&e.forEach((function(e){t.slabs.push({label:e.description,value:e.id})}))}))}},{key:"isSlabSettingsAdded",value:function(t){this.slabSettingsHide=t}},{key:"isPeakSettingsAdded",value:function(t){this.peakSettingsHide=t}},{key:"close",value:function(){var t=this;this.createSlabRateSettingsComponent.deletedDataSource&&this.createSlabRateSettingsComponent.deletedDataSource.length||this.createSlabRateSettingsComponent.isContentChange?this.dialog.open(W.a,{data:{label:"By Closing the Page added data will be lost . Do you want to Exit?",selected:!1}}).afterClosed().subscribe((function(e){e&&(t.createSlabRateSettingsComponent.dataSource.length?(t.createSlabRateSettingsComponent.deletedDataSource.forEach((function(e){return t.createSlabRateSettingsComponent.dataSource.push(e)})),t.createSlabRateSettingsComponent.dataSource.sort((function(t,e){return t.consumptionMin-e.consumptionMin||t.consumptionMax-e.consumptionMax})),t.createSlabRateSettingsComponent.deletedDataSource=[]):t.createSlabRateSettingsComponent.isContentChange=!1,t.dialogRef.close())})):this.dialogRef.close()}}]),t}()).\u0275fac=function(t){return new(t||Mt)(g.Nb(r.f),g.Nb(g.h),g.Nb(y.b),g.Nb(h.a),g.Nb(it.a),g.Nb(L),g.Nb(Ct.a),g.Nb(yt.a),g.Nb(D.h),g.Nb(D.a),g.Nb(D.b))},Mt.\u0275cmp=g.Hb({type:Mt,selectors:[["app-create-slab-tariff-settings"]],viewQuery:function(t,e){var a;1&t&&(g.Jc(N,!0),g.Jc(et,!0),g.Jc(at,!0)),2&t&&(g.zc(a=g.cc())&&(e.createSeasonalTariffSettingsComponent=a.first),g.zc(a=g.cc())&&(e.createPeakSettingsComponent=a.first),g.zc(a=g.cc())&&(e.createSlabRateSettingsComponent=a.first))},decls:34,vars:14,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"linear"],["stepper","matHorizontalStepper"],[3,"stepControl"],[3,"formGroup"],["matStepLabel",""],[1,"heading"],[1,"subheading"],[3,"utilityTypes","data","parameters","clients"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions"],["color","primary","mat-button","","type","button",3,"disabled","click"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled"],[3,"slabs","data","isDisable"],["fxLayout","row","fxLayoutAlign","end center","fxLayoutGap","8px",1,"actions",2,"padding-top","20px"],["color","primary","mat-button","","matStepperPrevious","","type","button"],["color","primary","mat-raised-button","","matStepperNext","",3,"disabled","click"]],template:function(t,e){if(1&t){var a=g.Ub();g.Tb(0,"div",0),g.Tb(1,"mat-toolbar",1),g.Tb(2,"span"),g.Rc(3,"Slab Tariff Settings"),g.Sb(),g.Ob(4,"span",2),g.Tb(5,"button",3),g.bc("click",(function(){return e.close()})),g.Tb(6,"mat-icon",4),g.Rc(7,"close"),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(8,"mat-dialog-content"),g.Tb(9,"fury-card"),g.Tb(10,"mat-horizontal-stepper",5,6),g.Tb(12,"mat-step",7),g.Tb(13,"form",8),g.Pc(14,kt,1,0,"ng-template",9),g.Ob(15,"div",10),g.Ob(16,"div",11),g.Ob(17,"app-create-seasonal-tariff-settings",12),g.Tb(18,"div",13),g.Tb(19,"button",14),g.bc("click",(function(){return g.Ec(a),g.Ac(11).reset()})),g.Rc(20,"RESET "),g.Sb(),g.Tb(21,"button",15),g.Rc(22,"NEXT "),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Tb(23,"mat-step"),g.Tb(24,"form",8),g.Pc(25,xt,1,0,"ng-template",9),g.Ob(26,"div",10),g.Ob(27,"div",11),g.Tb(28,"app-create-slab-rate-settings",16),g.bc("isDisable",(function(t){return e.isSlabSettingsAdded(t)})),g.Sb(),g.Tb(29,"div",17),g.Tb(30,"button",18),g.Rc(31,"PREVIOUS"),g.Sb(),g.Tb(32,"button",19),g.bc("click",(function(){return e.submit()})),g.Rc(33),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb()}2&t&&(g.Cb(10),g.mc("linear",!0),g.Cb(2),g.mc("stepControl",e.seasonSettingsFormGroup),g.Cb(1),g.mc("formGroup",e.seasonSettingsFormGroup),g.Cb(4),g.mc("utilityTypes",e.utilityTypes)("data",e.defaults)("parameters",e.parameters)("clients",e.clients),g.Cb(2),g.mc("disabled",e.seasonSettingsFormGroup.pristine),g.Cb(2),g.mc("disabled",e.seasonSettingsFormGroup.invalid),g.Cb(3),g.mc("formGroup",e.slabSettingsFormGroup),g.Cb(4),g.mc("slabs",e.slabs)("data",e.defaults),g.Cb(4),g.mc("disabled",e.slabSettingsHide),g.Cb(1),g.Tc(" ",e.buttonName," "))},directives:[D.i,E.a,A.a,G.a,U.c,D.f,z.a,nt.a,nt.b,r.z,r.r,r.k,nt.c,N,S.d,S.c,S.e,nt.e,at,nt.f],styles:["[_nghost-%COMP%]{background:url(/assets/img/backgrounds/form-wizard.jpg);background-size:cover;display:block}.title[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.padding[_ngcontent-%COMP%]{padding-bottom:0}.titleSelector[_ngcontent-%COMP%]{margin-top:auto;margin-right:24px}.profile[_ngcontent-%COMP%]{width:50%;display:flex}.profileImage[_ngcontent-%COMP%]{height:100px;margin-left:24px;margin-right:10px;padding:10px}.profileButton[_ngcontent-%COMP%]{align-self:center;padding:3px 15px}.document[_ngcontent-%COMP%]{width:50%;display:flex}.selectDocument[_ngcontent-%COMP%]{width:inherit;margin-right:30px;align-self:center;padding:3px 15px;overflow:hidden}.uploadButton[_ngcontent-%COMP%]{align-self:center;padding:5px 15px;border:1px solid grey;border-radius:3px;box-shadow:1px 1px 1px grey;cursor:pointer}.uploadButtonDisabled[_ngcontent-%COMP%]{align-self:center;padding:5px 15px;border:1px solid rgba(0,0,0,.26);border-radius:3px;box-shadow:1px 1px 1px rgba(0,0,0,.26);color:rgba(0,0,0,.26)}.deleteIcon[_ngcontent-%COMP%]{cursor:pointer}.company[_ngcontent-%COMP%]{align-self:center;margin-left:24px}.companyName[_ngcontent-%COMP%]{margin-top:10px;margin-right:24px}.mat-slide-toggle[_ngcontent-%COMP%]{padding-right:10px}.hide[_ngcontent-%COMP%]{display:none}.under-line[_ngcontent-%COMP%]{text-decoration:underline;cursor:pointer}.duplicateMessage[_ngcontent-%COMP%]{color:red;font-size:small}.duplicate[_ngcontent-%COMP%]{color:red}.task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"],data:{animation:[b.a,p.a,m.a]}}),Mt),Nt=function(){return[]},Rt=[{path:"create-tariff-settings",component:ut},{path:"tariff-settings",component:Tt},{path:"slab-tariff-settings",component:(wt=function(){function t(e,a,i,s,o){var r;n(this,t),this.tariffMasterService=e,this.date=a,this.dialog=i,this.snackbar=s,this.envService=o,this._gap=16,this.gap=this._gap+"px",this.col2="1 1 calc(50% - ".concat(this._gap/2,"px)"),this.col3="1 1 calc(33.3333% - ".concat(this._gap/1.5,"px)"),this.tariffMasters=[],this.dateFormat="",this.dateFormat=null!==(r=Object(ft.e)("DateFormat"))&&void 0!==r?r:o.dateFormat}return i(t,[{key:"ngOnInit",value:function(){this.getTariffMasters()}},{key:"getTariffMasters",value:function(){var t=this;this.tariffMasterService.getTariffMasters().subscribe((function(e){e&&(e.forEach((function(e){e.wefDateLocal=t.date.transform(e.wefDate,t.dateFormat)})),t.tariffMasters=e.filter((function(t){return t.tariffConsumptionSettings.length>0})))}))}},{key:"onUpdateRow",value:function(t){var e=this;this.dialog.open(_t,{data:t}).afterClosed().subscribe((function(t){t?e.tariffMasterService.updateTariffMaster(t).subscribe({next:function(t){t?e.notificationMessage("Tariff master updated successfully","green-snackbar"):e.notificationMessage("Tariff master update failed","red-snackbar"),e.getTariffMasters()},error:function(t){e.notificationMessage("Tariff master update failed","red-snackbar")}}):e.getTariffMasters()}))}},{key:"onAddItem",value:function(){var t=this;this.dialog.open(_t).afterClosed().subscribe((function(e){e&&t.tariffMasterService.saveTariffMaster(e).subscribe({next:function(e){e?t.notificationMessage("Tariff master saved successfully","green-snackbar"):t.notificationMessage("Tariff master save failed","red-snackbar"),t.getTariffMasters()},error:function(e){t.notificationMessage("Tariff master save failed","red-snackbar")}})}))}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"onDeleteRow",value:function(t){var e=this;t.isTariffUsed?this.notificationMessage("Cannot delete as tariff is in use","red-snackbar"):this.dialog.open(W.a,{data:{label:"Are you sure you want to Delete?",selected:!1}}).afterClosed().subscribe((function(a){a&&e.tariffMasterService.deleteTariffMaster(t).subscribe({next:function(t){t?e.notificationMessage("Tariff master deleted successfully","green-snackbar"):e.notificationMessage("Tariff master delete failed","red-snackbar"),e.getTariffMasters()},error:function(t){e.notificationMessage("Tariff master delete failed","red-snackbar")}})}))}}]),t}(),wt.\u0275fac=function(t){return new(t||wt)(g.Nb(L),g.Nb(o.f),g.Nb(D.b),g.Nb(y.b),g.Nb(H.a))},wt.\u0275cmp=g.Hb({type:wt,selectors:[["fury-edit-slab-tariff-settings"]],decls:7,vars:6,consts:[["mode","card"],["current","Slab Tariff Settings",3,"crumbs"],["fxFlex","noshrink","fxLayout","column","fxLayout.gt-sm","row","fxLayoutAlign.gt-sm","start stretch",3,"fxLayoutGap"],["fxLayout","column",1,"containerDiv"],[3,"dataSource","updateRow","deleteRow","addItemClicked"]],template:function(t,e){1&t&&(g.Tb(0,"fury-page-layout",0),g.Tb(1,"fury-page-layout-header"),g.Ob(2,"fury-breadcrumbs",1),g.Sb(),g.Tb(3,"fury-page-layout-content"),g.Tb(4,"div",2),g.Tb(5,"div",3),g.Tb(6,"fury-edit-tariff-settings-details",4),g.bc("updateRow",(function(t){return e.onUpdateRow(t)}))("deleteRow",(function(t){return e.onDeleteRow(t)}))("addItemClicked",(function(){return e.onAddItem()})),g.Sb(),g.Sb(),g.Sb(),g.Sb(),g.Sb()),2&t&&(g.Cb(2),g.mc("@fadeInRight",void 0)("crumbs",g.qc(5,Nt)),g.Cb(1),g.mc("@fadeInUp",void 0),g.Cb(1),g.mc("fxLayoutGap",e.gap),g.Cb(2),g.mc("dataSource",e.tariffMasters))},directives:[dt.a,bt.a,pt.a,mt.a,S.b,S.d,S.c,S.e,St],styles:["[_nghost-%COMP%]{background:url(/assets/img/backgrounds/form-wizard.jpg);background-size:cover;display:block}.title[_ngcontent-%COMP%]{color:#fff}.card[_ngcontent-%COMP%]{margin:24px;max-width:100%;border-radius:8px;overflow:hidden;box-shadow:0 6px 6px -3px rgba(0,0,0,.2),0 10px 14px 1px rgba(0,0,0,.14),0 4px 18px 3px rgba(0,0,0,.12)}.card[_ngcontent-%COMP%]   .heading[_ngcontent-%COMP%]{font:var(--font-title)}.card[_ngcontent-%COMP%]   .subheading[_ngcontent-%COMP%]{font:var(--font-subheading-1)}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{margin:12px 0}.card[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{margin-top:12px}.card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{margin-top:24px;padding:24px 8px 0}.copyright[_ngcontent-%COMP%]{position:absolute;bottom:24px;right:24px;color:#fff}.containerDiv[_ngcontent-%COMP%]{padding:0 0 24px;display:flex;width:100%}"],data:{animation:[b.a,p.a]}}),wt)}],Ot=((Pt=function t(){n(this,t)}).\u0275mod=g.Lb({type:Pt}),Pt.\u0275inj=g.Kb({factory:function(t){return new(t||Pt)},imports:[[d.j.forChild(Rt)],d.j]}),Pt),Dt=((It=function t(){n(this,t)}).\u0275mod=g.Lb({type:It}),It.\u0275inj=g.Kb({factory:function(t){return new(t||It)},imports:[[o.c,r.l,c.a,l.a,r.w,u.a,Ot,f.a,D.g]]}),It)}}])}();