(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{"6GKC":function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var a=i("KHMF"),o=i("fXoL");let l=(()=>{class t{constructor(t){this.el=t,this.roundOffFormat="",this.decimalPlaces=0,this.keyString="Decimal",this.regex=new RegExp(/^\d*\.?\d{0,2}$/g),this.specialKeys=["Backspace","Tab","End","Home","-","ArrowLeft","ArrowRight","Del","Delete"],this.roundOffFormat=Object(a.e)("RoundOff"),this.decimalPlaces=parseInt(this.roundOffFormat.substring(this.roundOffFormat.indexOf("-")+1,this.roundOffFormat.length))}onKeyDown(t){if(this.regex=new RegExp("^\\d*\\.?\\d{0,"+this.decimalPlaces+"}$"),-1!==this.specialKeys.indexOf(t.key))return;let e=this.el.nativeElement.value;const i=this.el.nativeElement.selectionStart,a=[e.slice(0,i),t.key===this.keyString||t.key===this.keyString.toLowerCase()?".":t.key,e.slice(i)].join("");a&&!String(a).match(this.regex)&&t.preventDefault()}}return t.\u0275fac=function(e){return new(e||t)(o.Nb(o.l))},t.\u0275dir=o.Ib({type:t,selectors:[["","furyValidateDecimalPlacesDirective",""]],hostBindings:function(t,e){1&t&&o.bc("keydown",(function(t){return e.onKeyDown(t)}))}}),t})()},"a+RD":function(t,e,i){"use strict";i.d(e,"a",(function(){return T}));var a=i("fXoL"),o=i("xgIS"),l=i("/uUt"),s=i("Kj3r"),n=i("ofXK"),r=i("STbY"),c=i("XiUz"),u=i("NFeN"),d=i("bTqV"),m=i("bSwM"),f=i("3Pt+");const h=["filter"];function p(t,e){if(1&t&&(a.Tb(0,"button",12),a.Tb(1,"mat-icon"),a.Rc(2,"filter_list"),a.Sb(),a.Sb()),2&t){a.fc(2);const t=a.Ac(3);a.mc("matMenuTriggerFor",t)}}function b(t,e){if(1&t&&(a.Tb(0,"div",5),a.Tb(1,"div",6),a.Rc(2),a.Sb(),a.Tb(3,"div",7),a.Tb(4,"mat-icon",8),a.Rc(5,"search"),a.Sb(),a.Ob(6,"input",9,10),a.Sb(),a.Pc(8,p,3,1,"button",11),a.kc(9,1),a.Sb()),2&t){const t=a.fc();a.Cb(2),a.Sc(t.name),a.Cb(6),a.mc("ngIf",!t.hideFilter)}}function g(t,e){if(1&t){const t=a.Ub();a.Tb(0,"button",13),a.bc("click",(function(i){a.Ec(t);const o=e.$implicit;return a.fc().toggleColumnVisibility(o,i)})),a.Tb(1,"mat-checkbox",14,15),a.bc("ngModelChange",(function(i){return a.Ec(t),e.$implicit.visible=i}))("click",(function(e){return a.Ec(t),e.stopPropagation()})),a.Rc(3),a.Sb(),a.Sb()}if(2&t){const t=e.$implicit;a.Cb(1),a.mc("ngModel",t.visible),a.Cb(2),a.Tc(" ",t.name," ")}}const y=["*",[["",8,"actions"]]],C=["*",".actions"];let T=(()=>{class t{constructor(){this.filterChange=new a.o}ngAfterViewInit(){this.hideHeader||Object(o.a)(this.filter.nativeElement,"keyup").pipe(Object(l.a)(),Object(s.a)(150)).subscribe(()=>{this.filterChange.emit(this.filter.nativeElement.value)})}toggleColumnVisibility(t,e){e.stopPropagation(),e.stopImmediatePropagation(),t.visible=!t.visible}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Hb({type:t,selectors:[["fury-list"]],viewQuery:function(t,e){var i;1&t&&a.Vc(h,!0),2&t&&a.zc(i=a.cc())&&(e.filter=i.first)},inputs:{name:"name",columns:"columns",hideHeader:"hideHeader",hideFilter:"hideFilter"},outputs:{filterChange:"filterChange"},ngContentSelectors:C,decls:6,vars:2,consts:[[1,"fury-list-table"],["class","fury-list-header","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",4,"ngIf"],["yPosition","below","xPosition","before"],["columnFilter","matMenu"],["class","checkbox-item mat-menu-item",3,"click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",1,"fury-list-header"],[1,"fury-list-name"],["fxLayout","row","fxLayoutAlign","start center","fxFlex",""],[1,"fury-filter-input-icon"],["fxFlex","","placeholder","Search\u2026",1,"fury-filter-input"],["filter",""],["class","fury-column-filter","type","button","mat-icon-button","",3,"matMenuTriggerFor",4,"ngIf"],["type","button","mat-icon-button","",1,"fury-column-filter",3,"matMenuTriggerFor"],[1,"checkbox-item","mat-menu-item",3,"click"],[1,"checkbox",3,"ngModel","ngModelChange","click"],["checkbox",""]],template:function(t,e){1&t&&(a.lc(y),a.Tb(0,"div",0),a.Pc(1,b,10,2,"div",1),a.Tb(2,"mat-menu",2,3),a.Pc(4,g,4,2,"button",4),a.Sb(),a.kc(5),a.Sb()),2&t&&(a.Cb(1),a.mc("ngIf",!e.hideHeader),a.Cb(3),a.mc("ngForOf",e.columns))},directives:[n.o,r.e,n.n,c.d,c.c,c.e,c.b,u.a,d.a,r.d,m.a,f.q,f.t],styles:[".fury-list-table{display:flex;flex-direction:column}.fury-list-table .fury-list-header{padding-left:24px;padding-right:24px;height:64px;border-top-left-radius:8px;border-top-right-radius:8px}@media screen and (max-width:599px){.fury-list-table .fury-list-header{height:auto;padding-top:24px;padding-bottom:24px}}.fury-list-table .fury-list-header .fury-list-name{font-size:20px;line-height:32px;font-weight:500;padding-right:24px}@media screen and (max-width:599px){.fury-list-table .fury-list-header .fury-list-name{border-right:none}}.fury-list-table .fury-list-header .fury-filter-input{font-size:16px;line-height:1.125;border:none;height:32px}.fury-list-table .fury-list-header .fury-filter-input:focus{outline:none}.fury-list-table .fury-list-header .fury-filter-input-icon{width:1.2em;vertical-align:bottom;height:22px;font-size:22px;margin-right:8px}.fury-list-table table{width:100%}.fury-list-table .mat-header-row .mat-header-cell .mat-sort-header-button{text-transform:uppercase}.fury-list-table .mat-cell.image-cell,.fury-list-table .mat-header-cell.image-cell{flex:0;width:59px}.fury-list-table .mat-cell.image-cell img,.fury-list-table .mat-header-cell.image-cell img{border-radius:50%;height:35px;width:35px;margin-right:24px;vertical-align:middle}.fury-list-table .mat-cell,.fury-list-table .mat-header-cell{white-space:nowrap;padding-left:12px;padding-right:12px}.fury-list-table .mat-cell.actions-cell,.fury-list-table .mat-header-cell.actions-cell{flex:0;width:40px;overflow:visible}.fury-list-table .paginator{display:block}"],encapsulation:2}),t})()},dUAH:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var a=i("fXoL");let o=(()=>{class t{transform(t){return null!=t?t.toString().replace(/,/g,""):""}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=a.Mb({name:"noComma",type:t,pure:!0}),t})()},xoEb:function(t,e,i){"use strict";i.r(e),i.d(e,"CreateBillheadModule",(function(){return fe}));var a=i("ofXK"),o=i("3Pt+"),l=i("q8Jb"),s=i("0jmt"),n=i("KthW"),r=i("tyNb"),c=i("M9IT"),u=i("Dh3D"),d=i("+0xr"),m=i("jtHE"),f=i("pLZG");class h{constructor(t){this.id=t.id||0,this.clientId=t.clientId||0,this.accountHeadName=t.accountHeadName||"",this.accountHeadType=t.accountHeadType||"",this.headType=t.headType||"",this.utilityTypeId=t.utilityTypeId||0,this.utilityType=t.utilityType||"",this.formulaField=t.formulaField||0,this.formulaFieldName=t.formulaFieldName||"",this.operator=t.operator||0,this.operatorName=t.operatorName||"",this.tariffId=t.tariffId||0,this.tariff=t.tariff||"",this.fixedAmount=t.fixedAmount||0,this.accountNumber=t.accountNumber||"",this.accountNumberName=t.accountNumberName||"",this.noOfDays=t.noOfDays||0,this.position=t.position||0,this.isVAT=t.isVAT||!1,this.isDiscount=t.isDiscount||!1,this.measuringUnitId=t.measuringUnitId||0,this.discountAmount=t.discountAmount||0,this.discountType=t.discountType||"",this.contractType=t.contractType||"",this.contractTypeId=t.contractTypeId||0,this.isProportional=t.isProportional||!1}}var p=i("Ku73"),b=i("nStZ"),g=i("tk/3"),y=i("sXtk"),C=i("fXoL");let T=(()=>{class t{constructor(t,e){this.http=t,this.envService=e,this.baseUrl="",this.baseUrl=e.backend}getBillHeads(t){return this.http.get(this.baseUrl+"/accountheads/clientId/"+t)}createBillHead(t){return this.http.post(this.baseUrl+"/accountheads",t)}updateBillHeadById(t,e){return this.http.put(this.baseUrl+"/accountheads/"+t,e)}deleteBillHeadById(t){return this.http.delete(this.baseUrl+"/accountheads/"+t)}getTariffs(t,e){return this.http.get(this.baseUrl+"/accountheads/getTariffs/"+t+"/"+e)}copyBillHead(t){return this.http.post(this.baseUrl+"/accountheads/copy/contents",t)}checkForDuplicatePosition(t,e,i){let a=new g.f;return a=a.append("position",""+t),a=a.append("id",""+e),a=a.append("clientId",""+i),this.http.get(this.baseUrl+"/accountheads/position",{params:a})}getNextPosition(t){let e=new g.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/accountheads/nextposition",{params:e})}getGracePeriod(t,e){let i=new g.f;return i=i.append("clientId",""+t),i=i.append("formula",""+e),this.http.get(this.baseUrl+"/accountheads/gracePeriod",{params:i})}getBillSettingClientMapping(t){let e=new g.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/accountheads/billSettingClientMapping",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(C.Xb(g.c),C.Xb(y.a))},t.\u0275prov=C.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var S=i("0IaG"),F=i("zSPf"),v=i("xXXn"),x=i("zP6O"),P=i("KHMF"),A=i("b6Qw"),I=i("/t3+"),N=i("bTqV"),O=i("NFeN"),L=i("MutI"),B=i("4FRi"),k=i("XiUz"),w=i("kmnG"),D=i("qFsG"),R=i("YaQ2"),V=i("d3UM"),M=i("FKr1"),H=i("/1cH"),U=i("bSwM"),E=i("QibW"),j=i("6GKC"),q=i("dUAH");const z=["automcomplete"];function $(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.description),C.Cb(1),C.Tc(" ",t.description," ")}}function _(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.description),C.Cb(1),C.Tc(" ",t.description," ")}}function G(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please select Utility Type"),C.Sb())}function K(t,e){if(1&t){const t=C.Ub();C.Tb(0,"mat-form-field",10),C.Tb(1,"mat-label"),C.Rc(2,"Utility Type"),C.Sb(),C.Tb(3,"mat-select",42),C.bc("selectionChange",(function(e){return C.Ec(t),C.fc().selectUtilityType(e)}))("ngModelChange",(function(e){return C.Ec(t),C.fc().utilityType=e})),C.Tb(4,"mat-option",14),C.Rc(5,"----Select----"),C.Sb(),C.Pc(6,_,2,2,"mat-option",15),C.Sb(),C.Ob(7,"app-show-errors",12),C.Pc(8,G,2,0,"mat-hint",23),C.Sb()}if(2&t){const t=C.fc();C.Cb(3),C.mc("ngModel",t.utilityType),C.Cb(1),C.mc("value",0),C.Cb(2),C.mc("ngForOf",t.metadataUtilityTypes),C.Cb(1),C.mc("ctrl",t.form.get("utilityTypeId")),C.Cb(1),C.mc("ngIf","Tariff"==t.calculationType)}}function X(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.id),C.Cb(1),C.Tc(" ",t.description," ")}}function Q(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please enter Position"),C.Sb())}function J(t,e){if(1&t&&(C.Tb(0,"mat-hint",43),C.Rc(1),C.Sb()),2&t){const t=C.fc();C.Cb(1),C.Sc(t.duplicatePosition)}}function W(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.description),C.Cb(1),C.Tc(" ",t.description," ")}}function Y(t,e){if(1&t){const t=C.Ub();C.Tb(0,"div",44),C.Tb(1,"mat-checkbox",45),C.bc("change",(function(e){return C.Ec(t),C.fc().enableMeasuringUnitCheckChanged(e)})),C.Rc(2," Measurement Unit in TH "),C.Sb(),C.Sb()}}function Z(t,e){if(1&t){const t=C.Ub();C.Tb(0,"div",47),C.Tb(1,"mat-checkbox",48),C.bc("change",(function(e){return C.Ec(t),C.fc(2).enableFormulaCheckChanged(e)})),C.Rc(2," * Configure the Formula Based on the Requirement "),C.Sb(),C.Sb()}}function tt(t,e){if(1&t&&(C.Tb(0,"div",17),C.Tb(1,"mat-label",35),C.Rc(2,"Bill Line Formula"),C.Sb(),C.Pc(3,Z,3,0,"div",46),C.Sb()),2&t){const t=C.fc();C.Cb(3),C.mc("ngIf","Consumption Charge"!=t.headType&&""!=t.headType)}}function et(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.tariffName),C.Cb(1),C.Tc(" ",t.tariffName," ")}}function it(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please select Tariff"),C.Sb())}function at(t,e){if(1&t){const t=C.Ub();C.Tb(0,"div",49),C.Tb(1,"mat-radio-button",50),C.bc("click",(function(){return C.Ec(t),C.fc().getConsumptionCalculation("Tariff")})),C.Rc(2," Calculation Based on Tariff"),C.Sb(),C.Tb(3,"mat-form-field",51),C.Tb(4,"mat-label"),C.Rc(5,"Tariff"),C.Sb(),C.Tb(6,"input",52),C.bc("ngModelChange",(function(e){return C.Ec(t),C.fc().tariffName=e})),C.Sb(),C.Tb(7,"mat-autocomplete",26,53),C.bc("optionSelected",(function(e){return C.Ec(t),C.fc().selectTariff(e)})),C.Pc(9,et,2,2,"mat-option",15),C.Sb(),C.Ob(10,"app-show-errors",12),C.Pc(11,it,2,0,"mat-hint",23),C.Sb(),C.Sb()}if(2&t){const t=C.Ac(8),e=C.fc();C.Cb(1),C.mc("checked",e.isTariff),C.Cb(5),C.mc("matAutocomplete",t)("ngModel",e.tariffName),C.Cb(3),C.mc("ngForOf",e.filteredTariffs),C.Cb(1),C.mc("ctrl",e.form.get("tariffId")),C.Cb(1),C.mc("ngIf","Tariff"==e.calculationType)}}function ot(t,e){if(1&t){const t=C.Ub();C.Tb(0,"div",54),C.Tb(1,"mat-radio-button",50),C.bc("click",(function(){return C.Ec(t),C.fc().getConsumptionCalculation("Formula")})),C.Rc(2,"Calculation Based on Formula"),C.Sb(),C.Sb()}if(2&t){const t=C.fc();C.Cb(1),C.mc("checked",t.isFormula)}}function lt(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.description),C.Cb(1),C.Tc(" ",t.description," ")}}function st(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please select Formula"),C.Sb())}function nt(t,e){if(1&t){const t=C.Ub();C.Tb(0,"mat-form-field",10),C.Tb(1,"mat-label"),C.Rc(2,"Formula Applied On"),C.Sb(),C.Tb(3,"input",56),C.bc("ngModelChange",(function(e){return C.Ec(t),C.fc(2).formulaApplied=e}))("keyup",(function(){return C.Ec(t),C.fc(2).getFilteredFormula()})),C.Sb(),C.Tb(4,"mat-autocomplete",26,57),C.bc("optionSelected",(function(e){return C.Ec(t),C.fc(2).selectBillFormula(e)})),C.Pc(6,lt,2,2,"mat-option",15),C.Sb(),C.Ob(7,"app-show-errors",12),C.Pc(8,st,2,0,"mat-hint",23),C.Sb()}if(2&t){const t=C.Ac(5),e=C.fc(2);C.Cb(3),C.mc("matAutocomplete",t)("ngModel",e.formulaApplied),C.Cb(3),C.mc("ngForOf",e.filteredBillFormulas),C.Cb(1),C.mc("ctrl",e.form.get("formulaField")),C.Cb(1),C.mc("ngIf","Tariff"!=e.calculationType)}}function rt(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.description),C.Cb(1),C.Tc(" ",t.description," ")}}function ct(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please select Operation"),C.Sb())}function ut(t,e){if(1&t){const t=C.Ub();C.Tb(0,"mat-form-field",10),C.Tb(1,"mat-label"),C.Rc(2,"Operation"),C.Sb(),C.Ob(3,"input",58),C.Tb(4,"mat-autocomplete",26,59),C.bc("optionSelected",(function(e){return C.Ec(t),C.fc(2).selectOperator(e)})),C.Pc(6,rt,2,2,"mat-option",15),C.Sb(),C.Ob(7,"app-show-errors",12),C.Pc(8,ct,2,0,"mat-hint",23),C.Sb()}if(2&t){const t=C.Ac(5),e=C.fc(2);C.Cb(3),C.mc("matAutocomplete",t),C.Cb(3),C.mc("ngForOf",e.filteredOperators),C.Cb(1),C.mc("ctrl",e.form.get("operator")),C.Cb(1),C.mc("ngIf","Tariff"!=e.calculationType)}}function dt(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please enter Amount"),C.Sb())}function mt(t,e){if(1&t&&(C.Tb(0,"div",17),C.Tb(1,"div",9),C.Pc(2,nt,9,5,"mat-form-field",16),C.Pc(3,ut,9,4,"mat-form-field",16),C.Tb(4,"mat-form-field",10),C.Tb(5,"mat-label"),C.Rc(6,"Amount / Value"),C.Sb(),C.Ob(7,"input",55),C.gc(8,"number"),C.Ob(9,"app-show-errors",12),C.Pc(10,dt,2,0,"mat-hint",23),C.Sb(),C.Sb(),C.Sb()),2&t){const t=C.fc();C.Cb(2),C.mc("ngIf","Variable"!=t.headType&&""!=t.headType),C.Cb(1),C.mc("ngIf","Variable"!=t.headType&&""!=t.headType),C.Cb(4),C.mc("ngModel",C.ic(8,5,t.fixedAmount,t.roundFormat)),C.Cb(2),C.mc("ctrl",t.form.get("fixedAmount")),C.Cb(1),C.mc("ngIf","Tariff"!=t.calculationType)}}function ft(t,e){1&t&&(C.Tb(0,"div",65),C.Rc(1,"Days from Bill Date"),C.Sb())}function ht(t,e){1&t&&(C.Tb(0,"div",65),C.Rc(1,"Days from Bill Due Date "),C.Sb())}function pt(t,e){if(1&t&&(C.Tb(0,"div",17),C.Tb(1,"mat-label",35),C.Rc(2,"Grace Period"),C.Sb(),C.Tb(3,"div",60),C.Tb(4,"div",61),C.Rc(5,"Applicable after:"),C.Sb(),C.Tb(6,"mat-form-field",62),C.Ob(7,"input",63),C.Sb(),C.Pc(8,ft,2,0,"div",64),C.Pc(9,ht,2,0,"div",64),C.Sb(),C.Sb()),2&t){const t=C.fc();C.Cb(8),C.mc("ngIf","Late Fee"==t.headType&&"Late Payment Fees"==t.accountHead),C.Cb(1),C.mc("ngIf","Late Fee"!=t.headType||"Late Payment Fees"!=t.accountHead)}}function bt(t,e){if(1&t&&(C.Tb(0,"mat-option",14),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.label),C.Cb(1),C.Tc(" ",t.label," ")}}function gt(t,e){1&t&&(C.Tb(0,"mat-hint"),C.Rc(1,"Please Discount type"),C.Sb())}function yt(t,e){if(1&t&&(C.Tb(0,"mat-form-field",10),C.Tb(1,"mat-label"),C.Rc(2,"Discount type"),C.Sb(),C.Tb(3,"mat-select",66),C.Pc(4,bt,2,2,"mat-option",15),C.Sb(),C.Ob(5,"app-show-errors",12),C.Pc(6,gt,2,0,"mat-hint",23),C.Sb()),2&t){const t=C.fc();C.Cb(4),C.mc("ngForOf",t.metadataDiscountTypes),C.Cb(1),C.mc("ctrl",t.form.get("discountType")),C.Cb(1),C.mc("ngIf",t.isDiscount)}}function Ct(t,e){if(1&t&&(C.Tb(0,"mat-form-field",10),C.Tb(1,"mat-label"),C.Rc(2,"Amount / Value"),C.Sb(),C.Ob(3,"input",67),C.gc(4,"noComma"),C.gc(5,"number"),C.Sb()),2&t){const t=C.fc();C.Cb(3),C.mc("ngModel",C.hc(4,1,C.ic(5,3,t.discountAmount,t.roundFormat)))}}function Tt(t,e){1&t&&(C.Tb(0,"mat-hint",68),C.Rc(1,"Tax Settings not mapped in Bill Settings."),C.Sb())}function St(t,e){if(1&t&&(C.Tb(0,"button",69),C.Rc(1,"CREATE BILL LINE"),C.Sb()),2&t){const t=C.fc();C.mc("disabled",!t.form.valid||0==t.selectedAccountNumber||""!=t.duplicatePosition)}}function Ft(t,e){if(1&t&&(C.Tb(0,"button",69),C.Rc(1,"UPDATE BILL LINE"),C.Sb()),2&t){const t=C.fc();C.mc("disabled",!t.form.valid||0==t.selectedAccountNumber||""!=t.duplicatePosition)}}let vt=(()=>{class t{constructor(t,e,i,a,o,l,s){this.defaults=t,this.dialogRef=e,this.fb=i,this.masterService=a,this.billHeadService=o,this.dialog=l,this.cookieService=s,this.accountHead="",this.headType="",this.tariffName="",this.formulaApplied="",this.mode="create",this.VATExist=!1,this.isDiscount=!1,this.isCancel=!1,this.isCustomDays=!1,this.metadataDiscountTypes=[{label:"Fixed",value:1},{label:"Percentage",value:2}],this.isConsumptionCharge=!1,this.isTariff=!1,this.isFormula=!1,this.utilityType="",this.duplicatePosition="",this.isMeasuringUnitTH=!1,this.isBillSettingClientMapped=!1,this.fixedAmount=0,this.discountAmount=0,this.currency=Object(P.e)("Currency"),this.roundFormat=Object(P.e)("RoundOff"),e.disableClose=!0}ngOnInit(){this.defaults?(this.mode="update",this.selectedAccountNumber=this.defaults.accountNumber,this.isMeasuringUnitTH=2==this.defaults.measuringUnitId,this.utilityType=this.defaults.utilityType,this.accountHead=this.defaults.accountNumberName,this.headType=this.defaults.headType,this.fixedAmount=this.defaults.fixedAmount,this.discountAmount=this.defaults.discountAmount):this.defaults=new h({}),this.clientId=parseInt(this.cookieService.get("globalClientId")),this.masterService.getSystemMasterdata(25,0).subscribe(t=>{t=t.filter(t=>"Security Deposit"!=t.description),this.metadataBillHeadTypes=t,this.filteredBillHeadTypes=t}),this.masterService.getSystemMasterdata(16,0).subscribe(t=>{this.metadataUtilityTypes=t,this.filteredUtilityTypes=t}),this.masterService.getSystemMasterdata(53,0).subscribe(t=>{this.metadataBillFormulas=t,this.filteredBillFormulas=t,this.filteredFormula=t,this.getBillFormula()}),this.masterService.getSystemMasterdata(54,0).subscribe(t=>{this.metadataOperators=t,this.filteredOperators=t}),this.getBillingLedgers(),this.masterService.getSystemMasterdata(4,0).subscribe(t=>{this.metadataContractTypes=this.filteredContractTypes=t}),this.form=this.fb.group({id:[this.defaults.id||0],accountHeadName:[this.defaults.accountHeadName||"",o.y.required],accountHeadType:[this.defaults.accountHeadType||"",o.y.required],headType:[this.defaults.headType||"",o.y.required],fixedAmount:[this.defaults.fixedAmount||"",o.y.required],accountNumber:[this.defaults.accountNumber||"",o.y.required],utilityTypeId:[this.defaults.utilityTypeId||""],utilityType:[this.defaults.utilityType||""],contractType:[this.defaults.contractType||"",o.y.required],contractTypeId:[this.defaults.contractTypeId||"0",o.y.required],formulaField:[this.defaults.formulaField||""],formulaFieldName:[this.defaults.formulaFieldName||""],operator:[this.defaults.operator||""],operatorName:[this.defaults.operatorName||""],tariffId:[this.defaults.tariffId||""],tariff:[this.defaults.tariff||""],noOfDays:[this.defaults.noOfDays||0],position:[this.defaults.position||"",o.y.required],MeasuringUnitId:[2==this.defaults.measuringUnitId],isVAT:[this.defaults.isVAT||!1],isDiscount:[this.defaults.isDiscount||!1],isProportional:[this.defaults.isProportional||!1],discountAmount:[this.defaults.discountAmount||""],discountType:[this.defaults.discountType||""],isTariff:[this.defaults.tariffId>0],isFormula:[""!=this.defaults.formulaFieldName],isEnableFormula:[""!=this.defaults.formulaFieldName&&"Consumption Charge"!=this.defaults.headType&&"Variable"!=this.defaults.headType&&""!=this.defaults.headType]}),"create"==this.mode&&this.getNextPosition(),this.billHeadService.getBillSettingClientMapping(this.clientId).subscribe(t=>{this.isBillSettingClientMapped=t,0==this.isBillSettingClientMapped?this.form.controls.isVAT.disable():this.form.controls.isVAT.enable()}),this.defaults&&this.defaults.tariffId>0&&(this.isTariff=!0),this.defaults&&""!=this.defaults.formulaFieldName&&(this.isFormula=!0,this.formulaApplied=this.defaults.formulaFieldName),this.defaults&&this.defaults.isVAT&&(this.VATExist=this.defaults.isVAT),this.defaults&&this.defaults.isDiscount&&(this.isDiscount=this.defaults.isDiscount),this.selectBillFormula(null,this.defaults.formulaFieldName),"update"===this.mode&&"Consumption Charge"===this.defaults.headType&&(this.isConsumptionCharge=!0,this.getTariffs(this.defaults.utilityTypeId,this.clientId),this.form.controls.tariffId.setValue(this.defaults.tariffId),this.tariffName=this.defaults.tariff),this.selectBillHeadType(null,this.defaults.headType),this.utilityType=this.defaults.utilityType,this.form.controls.formulaFieldName.valueChanges.subscribe(t=>{this.filteredBillFormulas=this.filterBillFormula(t)}),this.form.controls.operatorName.valueChanges.subscribe(t=>{this.filteredOperators=this.filterOperator(t)}),this.form.controls.tariff.valueChanges.subscribe(t=>{this.filteredTariffs=this.filterTariff(t)}),this.getEnableFormControls(),this.getBillHeads()}getBillingLedgers(){this.masterService.getUserMasterdata(56,149).subscribe(t=>{this.metadataBillingLedger=t})}getBillFormula(){this.metadataBillFormulas&&(""!=this.headType&&"Late Fee"==this.headType?("Bill Due Days"!=this.formulaApplied&&"Penalty Date"!=this.formulaApplied&&"Custom Days"!=this.formulaApplied&&(this.formulaApplied=""),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas.filter(t=>"Bill Due Days"==t.description||"Penalty Date"==t.description||"Custom Days"==t.description)):"Security Deposit"==this.headType?("Security Deposit"!=this.formulaApplied&&(this.formulaApplied=""),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas.filter(t=>"Security Deposit"==t.description)):"Bill Charge"!=this.headType&&"Late Fee"!=this.headType||("GrandTotal"!=this.formulaApplied&&(this.formulaApplied=""),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas.filter(t=>"GrandTotal"==t.description)))}getFilteredBillHeadType(){}getFilteredUtilityTypes(){this.filteredUtilityTypes=this.filterUtilityTypes(this.form.controls.utilityType.value)}filterBillHeadTypes(t){return""==t?(this.selectBillHeadType(null,""),this.metadataBillHeadTypes):this.metadataBillHeadTypes.filter(e=>0===e.description.toLowerCase().indexOf(t.toLowerCase()))}filterUtilityTypes(t){if(""==t&&this.selectUtilityType(null,""),this.metadataUtilityTypes)return this.metadataUtilityTypes.filter(e=>0===e.description.toLowerCase().indexOf(t.toLowerCase()))}filterBillFormula(t){if(this.filteredFormula)return this.filteredFormula.filter(e=>0===e.description.toLowerCase().indexOf(t.toLowerCase()))}getFilteredFormula(){this.filteredBillFormulas=this.filterBillFormula(this.form.get("formulaFieldName").value)}filterOperator(t){return""==t?this.metadataOperators:this.metadataOperators?this.metadataOperators.filter(e=>0===e.description.toLowerCase().indexOf(t.toLowerCase())):void 0}filterTariff(t){if(""==t&&this.form.controls.tariffId.setValue(0),this.metadatatariffs)return this.metadatatariffs.filter(e=>0===e.tariffName.toLowerCase().indexOf(t.toLowerCase()))}filterContractType(t){return""==t?this.metadataContractTypes:this.metadataContractTypes?this.metadataContractTypes.filter(e=>0===e.description.toLowerCase().indexOf(t.toLowerCase())):void 0}getEnableFormControls(){const t=this.form.get("isEnableFormula").value;this.enableDisableControls(t)}getHeadTypes(){this.filteredBillHeadTypes=this.metadataBillHeadTypes}getBillHeads(){this.clientId=parseInt(this.cookieService.get("globalClientId")),this.billHeadService.getBillHeads(this.clientId).subscribe({next:t=>{this.metedataBillLines=t.map(t=>new h(t))},error:t=>{}})}clear(t){this.form.get(t).setValue(""),setTimeout(()=>{this.autocomplete.openPanel()})}save(){if(this.isCancel){this.isCancel=!1;let t=!1;this.form.touched&&(t=!0),this.dialog.open(v.a,{data:{label:t?"Unsaved data will be lost, Are you sure you want to Cancel?":"Are you sure you want to Cancel?",selected:!1}}).afterClosed().subscribe(t=>{t&&this.dialogRef.close()})}else"create"===this.mode?this.createBillHead():"update"===this.mode&&this.updateBillHead()}createBillHead(){var t;Object.assign(this.defaults,this.form.value),this.defaults.position=parseInt(null!==(t=this.form.controls.position.value)&&void 0!==t?t:0),"All"===this.form.controls.contractType.value&&(this.defaults.contractTypeId=0),""==this.form.controls.utilityType.value&&(this.defaults.utilityTypeId=0),""==this.form.controls.formulaFieldName.value&&(this.defaults.formulaField=0),""==this.form.controls.operatorName.value&&(this.defaults.operator=0),this.isTariff||(this.defaults.tariffId=0),!this.isFormula&&this.isConsumptionCharge&&(this.defaults.formulaField=0,this.defaults.operator=0,this.defaults.fixedAmount=0),"Security Deposit"==this.formulaApplied&&(this.defaults.operator=0,this.defaults.fixedAmount=0),this.defaults.measuringUnitId="Consumption Charge"==this.headType&&"BTU"==this.utilityType?1==this.isMeasuringUnitTH?2:1:0,this.defaults.noOfDays=""==this.form.controls.noOfDays.value?0:this.form.controls.noOfDays.value,this.defaults.discountAmount=parseFloat(this.defaults.discountAmount.toString()),this.defaults.fixedAmount=parseFloat(this.defaults.fixedAmount.toString()),this.defaults.clientId=parseInt(this.cookieService.get("globalClientId")),this.defaults.accountNumber=this.selectedAccountNumber,this.isCancel?this.dialogRef.close():this.dialogRef.close(new h(this.defaults))}updateBillHead(){Object.assign(this.defaults,this.form.value),"All"===this.form.controls.contractType.value&&(this.defaults.contractTypeId=0),""==this.form.controls.utilityType.value?this.defaults.utilityTypeId=0:this.metadataUtilityTypes.find(t=>{this.utilityType==t.description&&(this.defaults.utilityTypeId=t.id)}),""==this.form.controls.formulaFieldName.value&&(this.defaults.formulaField=0),""==this.form.controls.operatorName.value&&(this.defaults.operator=0),this.isTariff||(this.defaults.tariffId=0),"Security Deposit"==this.formulaApplied&&(this.defaults.operator=0,this.defaults.fixedAmount=0),!this.isFormula&&this.isConsumptionCharge&&(this.defaults.formulaField=0,this.defaults.operator=0,this.defaults.fixedAmount=0),this.defaults.noOfDays=""==this.form.controls.noOfDays.value?0:this.form.controls.noOfDays.value,this.defaults.measuringUnitId="Consumption Charge"==this.headType&&"BTU"==this.utilityType?1==this.isMeasuringUnitTH?2:1:0,this.defaults.discountAmount=parseFloat(this.defaults.discountAmount.toString()),this.defaults.fixedAmount=parseFloat(this.defaults.fixedAmount.toString()),this.defaults.clientId=parseInt(this.cookieService.get("globalClientId")),this.defaults.accountNumber=this.selectedAccountNumber,this.isCancel?this.dialogRef.close():this.dialogRef.close(new h(this.defaults))}isCreateMode(){return"create"===this.mode}isUpdateMode(){return"update"===this.mode}selectBillHeadType(t,e=""){var i,a,l,s,n,r;if(""==e&&this.form.controls.accountHeadType.setValue(""),this.isConsumptionCharge=!1,this.headType="",this.headType=t?t.value:e,"Consumption Charge"!=this.headType&&(null===(i=this.form.controls.utilityType)||void 0===i||i.setValue(""),null===(a=this.form.controls.utilityTypeId)||void 0===a||a.setValue(0),null===(l=this.form.controls.utilityType)||void 0===l||l.clearValidators()),this.metadataBillHeadTypes){let t=this.metadataBillHeadTypes.filter(t=>this.headType==t.description);t&&t.length>0&&this.form.controls.accountHeadType.setValue(t[0].id)}"Consumption Charge"==this.headType?(this.isConsumptionCharge=!0,null===(s=this.form.controls.utilityType)||void 0===s||s.setValidators(o.y.required),null===(n=this.form.controls.utilityType)||void 0===n||n.setErrors({required:!0}),0==this.isTariff&&0==this.isFormula&&(this.isTariff=!0,this.isFormula=!1),this.isTariff?this.getConsumptionCalculation("Tariff"):this.isFormula&&this.getConsumptionCalculation("Formula")):"Formula"==this.headType||"Bill Charge"==this.headType||"Final Bill Fee"==this.headType||"Late Fee"==this.headType||"Security Deposit"==this.headType?("Late Fee"==this.headType&&(this.form.get("isEnableFormula").setValue(!0),this.enableFormulaCheckChanged(null)),this.getConsumptionCalculation("Formula")):(this.isConsumptionCharge=!1,this.getConsumptionCalculation("")),"Consumption Charge"!=this.headType&&this.selectUtilityType(null),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas,this.getBillFormula(),1==this.isFormula&&this.selectBillFormula(null,this.form.controls.formulaFieldName.value),this.getLateFeeValidation(),this.getEnableFormControls(),"Variable"==this.headType&&(this.form.controls.fixedAmount.setValidators([o.y.required]),this.form.controls.fixedAmount.updateValueAndValidity()),null===(r=this.form.controls.utilityType)||void 0===r||r.updateValueAndValidity()}getLateFeeValidation(){"Late Fee"==this.headType||"Custom Days"==this.formulaApplied?this.form.controls.noOfDays.setValidators([o.y.required]):(this.form.controls.noOfDays.clearValidators(),this.form.controls.noOfDays.markAsUntouched()),this.form.controls.noOfDays.updateValueAndValidity()}selectUtilityType(t,e=""){var i,a,l;this.metadatatariffs=[],this.filteredTariffs=[],this.form.controls.tariffId.setValue(0),this.form.controls.tariff.setValue(""),this.form.controls.utilityTypeId.setValue(0),this.form.controls.utilityType.setValue(""),this.utilityType=t?0==t.value?"":t.value:e,"Consumption Charge"==this.headType?(null===(i=this.form.controls.utilityType)||void 0===i||i.setValidators(o.y.required),null===(a=this.form.controls.utilityType)||void 0===a||a.setErrors({required:!0})):null===(l=this.form.controls.utilityType)||void 0===l||l.clearValidators(),this.metadataUtilityTypes&&this.metadataUtilityTypes.forEach(t=>{this.utilityType==t.description&&(this.form.controls.utilityTypeId.setValue(t.id),this.form.controls.utilityType.setValue(t.description),this.getTariffs(t.id,this.clientId))})}selectTariff(t,e=""){null!=t&&(e=t.option.value),this.metadatatariffs&&this.metadatatariffs.forEach(t=>{e==t.tariffName&&this.form.controls.tariffId.setValue(t.id)})}selectBillFormula(t,e=""){t&&(e=t.option.value),"Bill Due Days"==e||"Penalty Date"==e?(this.billHeadService.getGracePeriod(this.clientId,e).subscribe(t=>{this.form.controls.noOfDays.setValue(t)}),this.form.controls.noOfDays.disable()):this.form.controls.noOfDays.enable(),this.metadataBillFormulas&&this.metadataBillFormulas.forEach(t=>{e==t.description&&this.form.controls.formulaField.setValue(t.id)}),this.getLateFeeValidation(),this.setValidatorsForFormulaFields();const i=this.form.get("isEnableFormula").value;i&&"Security Deposit"==this.formulaApplied?(this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0)):i&&"Security Deposit"!=this.formulaApplied&&this.isFormula&&(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1),this.changeFormControlProperties("fixedAmount",null,!1))}setValidatorsForFormulaFields(){const t=this.form.get("isEnableFormula").value;t||1==this.isFormula?this.form.controls.formulaFieldName.setValidators([o.y.required]):this.form.controls.formulaFieldName.clearValidators(),1==t&&"Security Deposit"!=this.formulaApplied||1==this.isFormula?(this.form.controls.operatorName.setValidators([o.y.required]),this.form.controls.fixedAmount.setValidators([o.y.required])):(this.form.controls.operatorName.clearValidators(),this.form.controls.fixedAmount.setValidators([o.y.required])),this.form.controls.formulaFieldName.updateValueAndValidity(),this.form.controls.operatorName.updateValueAndValidity(),this.form.controls.fixedAmount.updateValueAndValidity()}selectOperator(t){this.metadataOperators&&this.metadataOperators.forEach(e=>{t.option.value==e.description&&this.form.controls.operator.setValue(e.id)})}getTariffs(t,e){this.billHeadService.getTariffs(t,e).subscribe(t=>{this.metadatatariffs=t,this.filteredTariffs=t})}validateFixedAmount(){return this.isValid=!0,""!=this.form.get("fixedAmount").value&&this.form.get("fixedAmount").value<=0&&(this.isValid=!1),this.isValid}onChangeAccountNumber(t){if(this.selectedAccountNumber=t,this.accountHead="",this.metadataBillingLedger){let e=this.metadataBillingLedger.find(e=>e.id==t);e&&(this.accountHead=e.description)}}toggleVAT(t){"create"==this.mode&&(this.VATExist=!t)}toggleDiscount(t){t.checked?(this.form.controls.discountType.setValidators([o.y.required]),this.form.controls.discountAmount.setValidators([o.y.required])):(this.form.controls.discountType.clearValidators(),this.form.controls.discountAmount.clearValidators(),this.form.controls.discountType.setValue(""),this.form.controls.discountAmount.setValue(0)),"create"==this.mode&&(this.isDiscount=t.checked)}closeDialog(){this.isCancel=!0}getConsumptionCalculation(t){this.calculationType=t,"Tariff"==t?(this.isTariff=!0,this.isFormula=!1,this.changeFormControlProperties("tariff","update"==this.mode&&0!=this.defaults.tariffId?null:"tariffId",!1),this.changeFormControlProperties("formulaFieldName","formulaField",!0),this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0),this.form.controls.tariff.setValidators([o.y.required])):"Formula"==t?(this.isTariff=!1,this.isFormula=!0,this.changeFormControlProperties("tariff","tariffId",!0),"update"==this.mode&&0!=this.defaults.formulaField?(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1)):(this.changeFormControlProperties("formulaFieldName","formulaField",!1),this.changeFormControlProperties("operatorName","operator",!1)),this.changeFormControlProperties("fixedAmount","update"==this.mode&&0!=this.defaults.fixedAmount?null:"fixedAmount",!1),this.form.controls.formulaFieldName.setValidators([o.y.required]),this.setValidatorsForFormulaFields()):""==t&&(this.isTariff=!1,this.isFormula=!1,this.changeFormControlProperties("tariff","tariffId",!1),this.changeFormControlProperties("formulaFieldName","formulaField",!1),this.changeFormControlProperties("operatorName","operator",!1),this.changeFormControlProperties("fixedAmount","fixedAmount",!1)),this.form.controls.tariff.updateValueAndValidity(),this.form.controls.formulaFieldName.updateValueAndValidity(),this.form.controls.operatorName.updateValueAndValidity(),this.form.controls.fixedAmount.updateValueAndValidity()}enableFormulaCheckChanged(t){let e=!0;null!=t&&(e=t.checked),this.enableDisableControls(e),this.setValidatorsForFormulaFields()}changeFormControlProperties(t,e,i){i?this.form.controls[t].disable():this.form.controls[t].enable(),e&&(this.form.controls[t].setValue(""),this.form.controls[e].setValue(""),this.form.controls[t].clearValidators(),this.form.controls[t].markAsUntouched())}enableDisableControls(t){t||"Consumption Charge"==this.headType?"Consumption Charge"==this.headType&&1==this.isTariff?(this.changeFormControlProperties("formulaFieldName","formulaField",!0),this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0)):t&&"Security Deposit"==this.formulaApplied?(this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0)):t&&"Security Deposit"!=this.formulaApplied&&this.isFormula?(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1),this.changeFormControlProperties("fixedAmount",null,!1)):(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1)):(this.changeFormControlProperties("formulaFieldName","formulaField",!0),this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount",null,!1))}checkDuplicatePosition(){this.duplicatePosition="";let t=this.form.controls.position.value;0!=t?""!=t&&null!=t&&this.billHeadService.checkForDuplicatePosition(t,this.defaults.id,this.clientId).subscribe(t=>{t&&t>0&&(this.duplicatePosition="Position already exists.")}):this.duplicatePosition="Position cannot be zero."}getNextPosition(){this.billHeadService.getNextPosition(this.clientId).subscribe(t=>{t&&t>0&&this.form.controls.position.setValue(t)})}enableMeasuringUnitCheckChanged(t){this.isMeasuringUnitTH=t.checked}close(){this.dialogRef.close()}selectContractType(t){this.metadataContractTypes.forEach(e=>{t.option.value==e.description&&this.form.controls.contractTypeId.setValue(e.id)})}createBillingLedger(){this.dialog.open(x.a,{data:[55,56,149]}).afterClosed().subscribe(t=>{t&&"Success"==t&&this.getBillingLedgers()})}}return t.id=100,t.\u0275fac=function(e){return new(e||t)(C.Nb(S.a),C.Nb(S.h),C.Nb(o.f),C.Nb(F.a),C.Nb(T),C.Nb(S.b),C.Nb(A.a))},t.\u0275cmp=C.Hb({type:t,selectors:[["fury-billhead-create-update"]],viewQuery:function(t,e){var i;1&t&&C.Vc(z,!0),2&t&&C.zc(i=C.cc())&&(e.autocomplete=i.first)},decls:92,vars:25,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"mat-dlg-content"],[1,"topPadding"],[1,"person"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","20px"],["fxFlex",""],["type","text","formControlName","accountHeadName","maxlength","80","matInput",""],[3,"ctrl"],["formControlName","headType",3,"selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","",4,"ngIf"],[1,"person","topPadding"],[2,"width","80%"],["formControlName","accountNumber",3,"selectionChange"],["type","button","mat-mini-fab","","color","primary",1,"create",2,"height","30px","width","30px","margin-right","0px","margin-left","5px","padding-top","-5px",3,"click"],[2,"height","10px","width","10px","padding-top","-5px","margin-top","-25px","margin-left","-13px"],["type","number","formControlName","position","matInput","",3,"change","keyup"],[4,"ngIf"],["class","duplicate",4,"ngIf"],["matInput","","formControlName","contractType",3,"matAutocomplete"],[3,"optionSelected"],["contractType","matAutocomplete"],["value","All"],["class","formulaLabel","fxFlex","20%",4,"ngIf"],["class","person topPadding",4,"ngIf"],["fxLayout","row","fxLayout.gt-sm","column","class","topPadding",4,"ngIf"],["fxLayout","row","fxLayout.gt-sm","column",4,"ngIf"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","20px",1,"marginRight","topPadding",2,"padding-bottom","10px"],["color","primary","formControlName","isProportional",1,"isProportional"],[1,"subHeading"],["color","primary","formControlName","isVAT",1,"isVAT",3,"change"],["color","primary","formControlName","isDiscount",1,"isVAT",3,"change"],["class","billSettingMapping",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button","",3,"disabled",4,"ngIf"],["formControlName","utilityType",3,"ngModel","selectionChange","ngModelChange"],[1,"duplicate"],["fxFlex","20%",1,"formulaLabel"],["color","primary","formControlName","MeasuringUnitId",1,"formulaLabel",3,"change"],["class","formulaLabel",4,"ngIf"],[1,"formulaLabel"],["color","primary","formControlName","isEnableFormula",1,"formulaLabel",3,"change"],["fxLayout","row","fxLayout.gt-sm","column",1,"topPadding"],[1,"formulaSubLabel",3,"checked","click"],["fxFlex","",1,"topPadding"],["matInput","","formControlName","tariff",3,"matAutocomplete","ngModel","ngModelChange"],["tariff","matAutocomplete"],["fxLayout","row","fxLayout.gt-sm","column"],["type","textbox","formControlName","fixedAmount","maxlength","7","matInput","","furyValidateDecimalPlacesDirective","",3,"ngModel"],["matInput","","formControlName","formulaFieldName",3,"matAutocomplete","ngModel","ngModelChange","keyup"],["formulaFieldName","matAutocomplete"],["matInput","","formControlName","operatorName",3,"matAutocomplete"],["operatorName","matAutocomplete"],["fxLayout","column","fxLayout.gt-sm","row",1,"topPadding"],[1,"gracePeriodLabelLeft"],["fxFlex","13%"],["type","number","formControlName","noOfDays","maxlength","2","min","0","matInput","","oninput","this.value = \n              !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null;javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);if(this.value < 0) this.value = ''"],["class","gracePeriodLabelRight",4,"ngIf"],[1,"gracePeriodLabelRight"],["formControlName","discountType"],["type","textbox","formControlName","discountAmount","matInput","","furyValidateDecimalPlacesDirective","",3,"ngModel"],[1,"billSettingMapping"],["mat-button","",3,"disabled"]],template:function(t,e){if(1&t&&(C.Tb(0,"div",0),C.Tb(1,"mat-toolbar",1),C.Tb(2,"span"),C.Rc(3,"Bill Line"),C.Sb(),C.Ob(4,"span",2),C.Tb(5,"button",3),C.bc("click",(function(){return e.close()})),C.Tb(6,"mat-icon",4),C.Rc(7,"close"),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Tb(8,"form",5),C.bc("ngSubmit",(function(){return e.save()})),C.Tb(9,"mat-dialog-content",6),C.Tb(10,"fury-card"),C.Tb(11,"fury-card-content",7),C.Tb(12,"div",8),C.Tb(13,"div",9),C.Tb(14,"mat-form-field",10),C.Tb(15,"mat-label"),C.Rc(16,"Bill Line Name"),C.Sb(),C.Ob(17,"input",11),C.Ob(18,"app-show-errors",12),C.Tb(19,"mat-hint"),C.Rc(20,"Please enter Bill Line Name"),C.Sb(),C.Sb(),C.Tb(21,"mat-form-field",10),C.Tb(22,"mat-label"),C.Rc(23,"Bill Line Type"),C.Sb(),C.Tb(24,"mat-select",13),C.bc("selectionChange",(function(t){return e.selectBillHeadType(t)})),C.Tb(25,"mat-option",14),C.Rc(26,"----Select----"),C.Sb(),C.Pc(27,$,2,2,"mat-option",15),C.Sb(),C.Ob(28,"app-show-errors",12),C.Tb(29,"mat-hint"),C.Rc(30,"Please select Bill Line Type"),C.Sb(),C.Sb(),C.Pc(31,K,9,5,"mat-form-field",16),C.Sb(),C.Sb(),C.Tb(32,"div",17),C.Tb(33,"div",9),C.Tb(34,"div",10),C.Tb(35,"mat-form-field",18),C.Tb(36,"mat-label"),C.Rc(37,"Account Ledger"),C.Sb(),C.Tb(38,"mat-select",19),C.bc("selectionChange",(function(t){return e.onChangeAccountNumber(t.value)})),C.Tb(39,"mat-option",14),C.Rc(40,"----Select----"),C.Sb(),C.Pc(41,X,2,2,"mat-option",15),C.Sb(),C.Ob(42,"app-show-errors",12),C.Tb(43,"mat-hint"),C.Rc(44,"Please select Account Ledger"),C.Sb(),C.Sb(),C.Tb(45,"button",20),C.bc("click",(function(){return e.createBillingLedger()})),C.Tb(46,"mat-icon",21),C.Rc(47,"add "),C.Sb(),C.Sb(),C.Sb(),C.Tb(48,"mat-form-field",10),C.Tb(49,"mat-label"),C.Rc(50,"Position"),C.Sb(),C.Tb(51,"input",22),C.bc("change",(function(){return e.checkDuplicatePosition()}))("keyup",(function(){return e.checkDuplicatePosition()})),C.Sb(),C.Pc(52,Q,2,0,"mat-hint",23),C.Pc(53,J,2,1,"mat-hint",24),C.Sb(),C.Tb(54,"mat-form-field",10),C.Tb(55,"mat-label"),C.Rc(56,"Contract Type"),C.Sb(),C.Ob(57,"input",25),C.Tb(58,"mat-autocomplete",26,27),C.bc("optionSelected",(function(t){return e.selectContractType(t)})),C.Tb(60,"mat-option",28),C.Rc(61,"All"),C.Sb(),C.Pc(62,W,2,2,"mat-option",15),C.Sb(),C.Ob(63,"app-show-errors",12),C.Tb(64,"mat-hint"),C.Rc(65,"Please select a Contract Type"),C.Sb(),C.Sb(),C.Pc(66,Y,3,0,"div",29),C.Sb(),C.Sb(),C.Pc(67,tt,4,1,"div",30),C.Pc(68,at,12,6,"div",31),C.Pc(69,ot,3,1,"div",32),C.Pc(70,mt,11,8,"div",30),C.Pc(71,pt,10,2,"div",30),C.Tb(72,"div",17),C.Tb(73,"div",33),C.Tb(74,"mat-checkbox",34),C.Rc(75," Prorata"),C.Sb(),C.Sb(),C.Sb(),C.Tb(76,"div",17),C.Tb(77,"mat-label",35),C.Rc(78,"Taxes and Discounts"),C.Sb(),C.Tb(79,"div",33),C.Tb(80,"mat-checkbox",36),C.bc("change",(function(){return e.toggleVAT(e.VATExist)})),C.Rc(81,"Apply Tax "),C.Sb(),C.Tb(82,"mat-checkbox",37),C.bc("change",(function(t){return e.toggleDiscount(t)})),C.Rc(83," Apply Discount"),C.Sb(),C.Pc(84,yt,7,3,"mat-form-field",16),C.Pc(85,Ct,6,6,"mat-form-field",16),C.Sb(),C.Pc(86,Tt,2,0,"mat-hint",38),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Tb(87,"mat-dialog-actions",39),C.Tb(88,"button",40),C.bc("click",(function(){return e.closeDialog()})),C.Rc(89,"CANCEL"),C.Sb(),C.Pc(90,St,2,1,"button",41),C.Pc(91,Ft,2,1,"button",41),C.Sb(),C.Sb()),2&t){const t=C.Ac(59);C.Cb(8),C.mc("formGroup",e.form),C.Cb(10),C.mc("ctrl",e.form.get("accountHeadName")),C.Cb(7),C.mc("value",0),C.Cb(2),C.mc("ngForOf",e.metadataBillHeadTypes),C.Cb(1),C.mc("ctrl",e.form.get("accountHeadType")),C.Cb(3),C.mc("ngIf",e.isConsumptionCharge),C.Cb(8),C.mc("value",0),C.Cb(2),C.mc("ngForOf",e.metadataBillingLedger),C.Cb(1),C.mc("ctrl",e.form.get("accountNumber")),C.Cb(10),C.mc("ngIf",""==e.duplicatePosition),C.Cb(1),C.mc("ngIf",""!=e.duplicatePosition),C.Cb(4),C.mc("matAutocomplete",t),C.Cb(5),C.mc("ngForOf",e.filteredContractTypes),C.Cb(1),C.mc("ctrl",null==e.form?null:e.form.get("contractTypeId")),C.Cb(3),C.mc("ngIf","Consumption Charge"==e.headType&&"BTU"==e.utilityType),C.Cb(1),C.mc("ngIf","Variable"!=e.headType&&""!=e.headType&&"Unit Charge"!=e.headType),C.Cb(1),C.mc("ngIf","Consumption Charge"==e.headType),C.Cb(1),C.mc("ngIf","Consumption Charge"==e.headType),C.Cb(1),C.mc("ngIf",""!=e.headType&&"Unit Charge"!=e.headType),C.Cb(1),C.mc("ngIf","Late Fee"==e.headType||"Custom Days"==e.formulaApplied||"Bill Due Days"==e.formulaApplied||"Penalty Date"==e.formulaApplied),C.Cb(13),C.mc("ngIf",null==e.form||null==e.form.controls?null:e.form.controls.isDiscount.value),C.Cb(1),C.mc("ngIf",null==e.form||null==e.form.controls?null:e.form.controls.isDiscount.value),C.Cb(1),C.mc("ngIf",0==e.isBillSettingClientMapped),C.Cb(4),C.mc("ngIf",e.isCreateMode()),C.Cb(1),C.mc("ngIf",e.isUpdateMode())}},directives:[S.i,I.a,N.a,O.a,L.c,o.z,o.r,o.k,S.f,B.a,B.c,k.d,k.e,w.d,k.b,w.h,o.c,D.b,o.q,o.i,o.m,R.a,w.g,V.a,M.n,a.n,a.o,o.u,H.c,H.a,U.a,S.c,k.c,E.a,j.a],pipes:[a.g,q.a],styles:[".marginRight[_ngcontent-%COMP%]{margin-right:36%}.isVAT[_ngcontent-%COMP%]{align-self:center;margin-left:0;text-align:center}.gracePeriodLabelLeft[_ngcontent-%COMP%]{padding-top:30px;margin-right:10px}.gracePeriodLabelRight[_ngcontent-%COMP%]{padding-top:30px;margin-left:10px}.formulaLabel[_ngcontent-%COMP%], .formulaSubLabel[_ngcontent-%COMP%]{clear:both;padding-top:10px}.formulaSubLabel[_ngcontent-%COMP%]{font-weight:500}.topPadding[_ngcontent-%COMP%]{padding-top:12px}.heading[_ngcontent-%COMP%]{padding-left:25px}.heading[_ngcontent-%COMP%], .subHeading[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.duplicate[_ngcontent-%COMP%]{color:red}.task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.billSettingMapping[_ngcontent-%COMP%]{font-size:smaller}"]}),t})();var xt=i("nR/4"),Pt=i("dNgK"),At=i("f0Cb");const It=["allClientsSelected"];function Nt(t,e){if(1&t&&(C.Tb(0,"mat-option",22),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.mc("value",t.clientName),C.Cb(1),C.Sc(t.clientName)}}function Ot(t,e){if(1&t){const t=C.Ub();C.Tb(0,"mat-option",16),C.bc("click",(function(){C.Ec(t);const e=C.fc(),i=C.Ac(23);return e.toggleClientPerOne(i.viewValue)})),C.Rc(1),C.Sb()}if(2&t){const t=e.$implicit;C.mc("value",t.clientId),C.Cb(1),C.Tc(" ",t.clientName," ")}}let Lt=(()=>{class t{constructor(t,e,i,a,o,l){this.fb=t,this.billHeadService=e,this.snackbar=i,this.dialogRef=a,this.dialog=o,this.cookieService=l,this.isCancel=!1,this.lstClients=[],this.lstFilterClients=[],this.selectedClients=[],a.disableClose=!0}ngOnInit(){this.clientId=this.cookieService.get("globalClientId"),this.lstClients=this.lstFilterClients=JSON.parse(localStorage.getItem("userClients")),this.clientId&&(this.lstClients=this.lstFilterClients.filter(t=>t.clientId!=Number(this.clientId))),this.form=this.fb.group({fromClient:[""],clients:[""]}),this.lstFilterClients.find(t=>{t.clientId==this.clientId&&(this.fromClientName=t.clientName,this.selectCopyFromClient(this.fromClientName))})}selectCopyFromClient(t){this.selectedClients=[];let e=this.lstFilterClients.find(e=>e.clientName==t);this.clientId=e.clientId,this.fromClientName=e.clientName,this.clientId&&(this.lstClients=this.lstFilterClients.filter(t=>t.clientId!=Number(this.clientId)))}toggleClientsAllSelection(){this.form.controls.clients.patchValue(this.allClientsSelected.selected?[...this.lstClients.map(t=>t.clientId),0]:[])}toggleClientPerOne(t){if(this.allClientsSelected.selected)return this.allClientsSelected.deselect(),!1;this.form.controls.clients.value.length==this.lstClients.length&&this.allClientsSelected.select()}save(){if(this.isCancel)return this.isCancel=!1,void this.dialog.open(v.a,{data:{label:"Are you sure you want to Cancel?",selected:!1}}).afterClosed().subscribe(t=>{t&&this.dialogRef.close()});this.dialog.open(xt.a,{autoFocus:!0,data:[{label:"Remove Existing & Copy whole Configuration from Beginning",value:1},{label:"Keep Existing & Copy Only New Configuration",value:2},{label:"Copy Only New & Modify existing Configuration",value:3}]}).afterClosed().subscribe(t=>{if(t&&this.selectedClients&&this.selectedClients.length){let e=[];this.selectedClients.forEach(i=>{0!=i&&e.push({fromClientId:Number(this.clientId),toClientId:Number(i),type:Number(t.value)})}),this.billHeadService.copyBillHead(e).subscribe({next:t=>{t?this.notificationMessage("Bill Line copied successfully.","green-snackbar"):this.notificationMessage("Bill Line copy failed","red-snackbar"),this.dialogRef.close()},error:t=>{this.notificationMessage("Bill Line copy failed","red-snackbar")}})}})}notificationMessage(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}search(t){let e=this.select(t);this.lstClients=e}select(t){let e=[];if(t)for(let i of this.lstFilterClients)i.clientName.toLowerCase().indexOf(t)>-1&&e.push(i);else e=this.lstFilterClients;return e}close(){this.dialogRef.close()}closeDialog(){this.isCancel=!0}}return t.\u0275fac=function(e){return new(e||t)(C.Nb(o.f),C.Nb(T),C.Nb(Pt.b),C.Nb(S.h),C.Nb(S.b),C.Nb(A.a))},t.\u0275cmp=C.Hb({type:t,selectors:[["fury-copy-bill-lines"]],viewQuery:function(t,e){var i;1&t&&C.Vc(It,!0),2&t&&C.zc(i=C.cc())&&(e.allClientsSelected=i.first)},decls:31,vars:9,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"mat-dlg-content"],[1,"padding-top"],[1,"person"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","48px"],["fxFlex",""],["formControlName","fromClient","placeholder","Copy From Client",3,"ngModel","disabled","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","","placeholder","Copy To Client",1,"multiSelectCustom",3,"ngModel","formControl","ngModelChange"],["matInput","","focused","'true'","type","text","autocomplete","off","placeholder","Search",1,"myInput","mySelect",3,"keyup"],["myInput",""],[3,"value","click"],["allClientsSelected",""],[3,"value","click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button","",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(C.Tb(0,"h4",0),C.Tb(1,"mat-toolbar",1),C.Tb(2,"span"),C.Rc(3,"Copy Bill Line"),C.Sb(),C.Ob(4,"span",2),C.Tb(5,"button",3),C.bc("click",(function(){return e.close()})),C.Tb(6,"mat-icon",4),C.Rc(7,"close"),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Tb(8,"form",5),C.bc("ngSubmit",(function(){return e.save()})),C.Tb(9,"mat-dialog-content",6),C.Tb(10,"fury-card"),C.Tb(11,"fury-card-content",7),C.Tb(12,"div",8),C.Tb(13,"div",9),C.Tb(14,"mat-form-field",10),C.Tb(15,"mat-select",11),C.bc("ngModelChange",(function(t){return e.fromClientName=t}))("selectionChange",(function(t){return e.selectCopyFromClient(t.value)})),C.Pc(16,Nt,2,2,"mat-option",12),C.Sb(),C.Sb(),C.Tb(17,"mat-form-field",10),C.Tb(18,"mat-select",13),C.bc("ngModelChange",(function(t){return e.selectedClients=t})),C.Tb(19,"input",14,15),C.bc("keyup",(function(t){return e.search(t.target.value)})),C.Sb(),C.Ob(21,"mat-divider"),C.Tb(22,"mat-option",16,17),C.bc("click",(function(){return e.toggleClientsAllSelection()})),C.Rc(24,"Select All"),C.Sb(),C.Pc(25,Ot,2,2,"mat-option",18),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Sb(),C.Tb(26,"mat-dialog-actions",19),C.Tb(27,"button",20),C.bc("click",(function(){return e.closeDialog()})),C.Rc(28,"CANCEL"),C.Sb(),C.Tb(29,"button",21),C.Rc(30,"PROCEED"),C.Sb(),C.Sb(),C.Sb()),2&t&&(C.Cb(8),C.mc("formGroup",e.form),C.Cb(7),C.mc("ngModel",e.fromClientName)("disabled",!0),C.Cb(1),C.mc("ngForOf",e.lstFilterClients),C.Cb(2),C.mc("ngModel",e.selectedClients)("formControl",e.form.controls.clients),C.Cb(4),C.mc("value",0),C.Cb(3),C.mc("ngForOf",e.lstClients),C.Cb(4),C.mc("disabled",0==(null==e.selectedClients?null:e.selectedClients.length)))},directives:[S.i,I.a,N.a,O.a,L.c,o.z,o.r,o.k,S.f,B.a,B.c,k.d,k.e,w.d,k.b,V.a,o.q,o.i,a.n,o.h,D.b,At.a,M.n,S.c,k.c],styles:[".myInput[_ngcontent-%COMP%]{padding:10px!important}.task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.buttonStyle[_ngcontent-%COMP%]{background:#3f51b5;color:#fff;padding-right:10px}"]}),t})();var Bt=i("tB66"),kt=i("a8hA"),wt=i("xBcV"),Dt=i("Hbgg"),Rt=i("rnAf"),Vt=i("rvYj"),Mt=i("a+RD"),Ht=i("Qu3c"),Ut=i("znSr"),Et=i("STbY");function jt(t,e){if(1&t&&(C.Tb(0,"th",21),C.Rc(1),C.Sb()),2&t){const t=C.fc(2).$implicit;C.Cb(1),C.Sc(t.name)}}function qt(t,e){if(1&t&&(C.Tb(0,"td",22),C.Rc(1),C.Sb()),2&t){const t=e.$implicit,i=C.fc(2).$implicit;C.mc("ngStyle",i.columnAlign),C.Cb(1),C.Tc(" ",t[i.property]," ")}}function zt(t,e){if(1&t&&(C.Rb(0,18),C.Pc(1,jt,2,1,"th",19),C.Pc(2,qt,2,2,"td",20),C.Qb()),2&t){const t=C.fc().$implicit;C.mc("matColumnDef",t.property)}}function $t(t,e){if(1&t&&(C.Rb(0),C.Pc(1,zt,3,1,"ng-container",17),C.Qb()),2&t){const t=e.$implicit;C.Cb(1),C.mc("ngIf",t.isModelProperty)}}function _t(t,e){1&t&&(C.Tb(0,"th",23),C.Rc(1,"FIXED AMOUNT"),C.Sb())}function Gt(t,e){if(1&t&&(C.Tb(0,"td",24),C.Rc(1),C.Sb()),2&t){const t=e.$implicit;C.Cb(1),C.Tc(" ",t.fixedAmountLocal," ")}}function Kt(t,e){1&t&&C.Ob(0,"th",25)}function Xt(t,e){if(1&t){const t=C.Ub();C.Tb(0,"td",26),C.Tb(1,"button",27),C.bc("click",(function(e){return C.Ec(t),e.stopPropagation()})),C.Tb(2,"mat-icon"),C.Rc(3,"more_horiz"),C.Sb(),C.Sb(),C.Tb(4,"mat-menu",28,29),C.Tb(6,"button",30),C.bc("click",(function(){C.Ec(t);const i=e.$implicit;return C.fc().updateBillHead(i)})),C.Tb(7,"span"),C.Rc(8,"Modify"),C.Sb(),C.Sb(),C.Tb(9,"button",30),C.bc("click",(function(){C.Ec(t);const i=e.$implicit;return C.fc().deleteBillHead(i)})),C.Tb(10,"span"),C.Rc(11,"Delete"),C.Sb(),C.Sb(),C.Sb(),C.Sb()}if(2&t){const t=C.Ac(5);C.Cb(1),C.mc("matMenuTriggerFor",t)}}function Qt(t,e){1&t&&C.Ob(0,"tr",31)}function Jt(t,e){if(1&t){const t=C.Ub();C.Tb(0,"tr",32),C.bc("click",(function(){C.Ec(t);const i=e.$implicit;return C.fc().updateBillHead(i)})),C.Sb()}}const Wt=function(){return[]},Yt=[{path:"",component:(()=>{class t{constructor(t,e,i,a,o,l,s,n){var r,c;this.dialog=t,this.snackbar=e,this.date=i,this.currencyPipe=a,this.billHeadService=o,this.clientSelectionService=l,this.cookieService=s,this.envService=n,this.mode="create",this.dateFormat=Object(P.e)("DateFormat"),this.currency="",this.roundFormat="",this.subject$=new m.a(1),this.data$=this.subject$.asObservable(),this.columns=[{name:"Bill Line Name",property:"accountHeadName",visible:!0,isModelProperty:!0},{name:"Bill Line Type",property:"headType",visible:!0,isModelProperty:!0},{name:"Contract Type",property:"contractType",visible:!0,isModelProperty:!0},{name:"Position",property:"position",visible:!0,isModelProperty:!0},{name:"Fixed Amount",property:"fixedAmountLocal",visible:!0,isModelProperty:!1},{name:"Actions",property:"actions",visible:!0}],this.pageSize=8,this.currency=null!==(r=Object(P.e)("Currency"))&&void 0!==r?r:n.currencyFormat,this.roundFormat=null!==(c=Object(P.e)("RoundOff"))&&void 0!==c?c:n.roundOffFormat}set content(t){this.sort=t,this.sort&&(this.dataSource.sort=this.sort)}get visibleColumns(){return this.columns.filter(t=>t.visible).map(t=>t.property)}ngOnInit(){this.clientSelectionService.setIsClientVisible(!0),this.getBillHeads()}ngAfterViewInit(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}notificationMessage(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}copyBillLines(){this.dialog.open(Lt).afterClosed().subscribe()}createBillHead(){this.dialog.open(vt).afterClosed().subscribe(t=>{t&&this.billHeadService.createBillHead(t).subscribe(t=>{this.snackbar.open("Bill Line created successfully.",null,{duration:5e3,verticalPosition:"top",horizontalPosition:"center",panelClass:["green-snackbar"]}),this.getBillHeads()})}),this.getBillHeads()}updateBillHead(t){this.dialog.open(vt,{data:t}).afterClosed().subscribe(t=>{t&&this.billHeadService.updateBillHeadById(t.id,t).subscribe(t=>{this.snackbar.open("Bill Line updated successfully.",null,{duration:5e3,verticalPosition:"top",horizontalPosition:"center",panelClass:["green-snackbar"]}),this.getBillHeads()})}),this.getBillHeads()}deleteBillHead(t){this.dialog.open(Bt.a).afterClosed().subscribe(e=>{e&&t&&this.billHeadService.deleteBillHeadById(t.id).subscribe({next:t=>{this.snackbar.open("Bill Line deleted successfully.",null,{duration:5e3,verticalPosition:"top",horizontalPosition:"center",panelClass:["green-snackbar"]}),this.getBillHeads()},error:t=>{this.notificationMessage("Bill Line deletion failed.","red-snackbar")}})})}onFilterChange(t){this.dataSource&&(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}getBillHeads(){this.clientId=parseInt(this.cookieService.get("globalClientId")),this.billHeadService.getBillHeads(this.clientId).subscribe(t=>{t=t.map(t=>new h(t)),this.dateFormat=Object(P.e)("DateFormat"),this.roundFormat=Object(P.e)("RoundOff"),this.currency=Object(P.e)("Currency"),t.forEach(t=>{t.fixedAmountLocal=this.currencyPipe.transform(t.fixedAmount,this.currency.toString(),!0,this.roundFormat),t.discountAmountLocal=this.currencyPipe.transform(t.discountAmount,this.currency.toString(),!0,this.roundFormat)}),this.subject$.next(t)}),this.dataSource=new d.k(this.billHeads),this.data$.pipe(Object(f.a)(t=>!!t)).subscribe(t=>{this.billHeads=t,this.dataSource.data=t}),this.ngAfterViewInit()}ngOnDestroy(){}}return t.id=100,t.\u0275fac=function(e){return new(e||t)(C.Nb(S.b),C.Nb(Pt.b),C.Nb(a.f),C.Nb(a.d),C.Nb(T),C.Nb(kt.a),C.Nb(A.a),C.Nb(y.a))},t.\u0275cmp=C.Hb({type:t,selectors:[["create-billHead"]],viewQuery:function(t,e){var i;1&t&&(C.Jc(c.a,!0),C.Vc(u.a,!0)),2&t&&(C.zc(i=C.cc())&&(e.paginator=i.first),C.zc(i=C.cc())&&(e.content=i.first))},inputs:{columns:"columns"},decls:23,vars:10,consts:[["mode","card"],["current","Bill Line",3,"crumbs"],["name","Bill Line",3,"columns","filterChange"],[1,"actions"],["matTooltip","Copy","type","button","mat-mini-fab","","color","primary",1,"right-margin",3,"click"],["type","button","mat-mini-fab","","color","primary",1,"left-margin",3,"click"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","fixedAmountLocal"],["mat-header-cell","","class","header-align-right",4,"matHeaderCellDef"],["mat-cell","","class","header-align-right",4,"matCellDef"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"ngStyle",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"ngStyle"],["mat-header-cell","",1,"header-align-right"],["mat-cell","",1,"header-align-right"],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(t,e){1&t&&(C.Tb(0,"fury-page-layout",0),C.Tb(1,"fury-page-layout-header"),C.Ob(2,"fury-breadcrumbs",1),C.Sb(),C.Tb(3,"fury-page-layout-content"),C.Tb(4,"fury-list",2),C.bc("filterChange",(function(t){return e.onFilterChange(t)})),C.Tb(5,"div",3),C.Tb(6,"button",4),C.bc("click",(function(){return e.copyBillLines()})),C.Tb(7,"mat-icon"),C.Rc(8,"file_copy"),C.Sb(),C.Sb(),C.Tb(9,"button",5),C.bc("click",(function(){return e.createBillHead()})),C.Tb(10,"mat-icon"),C.Rc(11,"add"),C.Sb(),C.Sb(),C.Sb(),C.Tb(12,"table",6),C.Pc(13,$t,2,1,"ng-container",7),C.Rb(14,8),C.Pc(15,_t,2,0,"th",9),C.Pc(16,Gt,2,1,"td",10),C.Qb(),C.Rb(17,11),C.Pc(18,Kt,1,0,"th",12),C.Pc(19,Xt,12,1,"td",13),C.Qb(),C.Pc(20,Qt,1,0,"tr",14),C.Pc(21,Jt,1,0,"tr",15),C.Sb(),C.Ob(22,"mat-paginator",16),C.Sb(),C.Sb(),C.Sb()),2&t&&(C.Cb(2),C.mc("@fadeInRight",void 0)("crumbs",C.qc(9,Wt)),C.Cb(1),C.mc("@fadeInUp",void 0),C.Cb(1),C.mc("columns",e.columns),C.Cb(8),C.mc("dataSource",e.dataSource),C.Cb(1),C.mc("ngForOf",e.columns),C.Cb(7),C.mc("matHeaderRowDef",e.visibleColumns),C.Cb(1),C.mc("matRowDefColumns",e.visibleColumns),C.Cb(1),C.mc("pageSize",e.pageSize))},directives:[wt.a,Dt.a,Rt.a,Vt.a,Mt.a,N.a,Ht.a,O.a,d.j,u.a,a.n,d.c,d.e,d.b,d.g,d.i,c.a,a.o,d.d,u.b,d.a,a.p,Ut.c,Et.d,Et.e,Et.b,d.f,d.h],styles:[".left-margin[_ngcontent-%COMP%]{margin-left:10px}.right-margin[_ngcontent-%COMP%]{margin-right:10px}.header-align-right[_ngcontent-%COMP%]{text-align:right}"],data:{animation:[p.a,b.a]}}),t})()}];let Zt=(()=>{class t{}return t.\u0275mod=C.Lb({type:t}),t.\u0275inj=C.Kb({factory:function(e){return new(e||t)},imports:[[r.j.forChild(Yt)],r.j]}),t})();var te=i("WCGO"),ee=i("YUcS"),ie=i("VE2z"),ae=i("wZkO"),oe=i("GiUZ"),le=i("6NWb"),se=i("Rlsg"),ne=i("wqNl"),re=i("jJIU"),ce=i("zWnM"),ue=i("zeEN");let de=(()=>{class t{}return t.\u0275mod=C.Lb({type:t}),t.\u0275inj=C.Kb({factory:function(e){return new(e||t)},providers:[a.f],imports:[[a.c,Et.c,le.b,se.a,Zt,ne.a,ie.a,o.l,n.a,o.w,ee.a,D.c,N.b,S.g,O.b,te.a,oe.a,s.a,l.a,re.a,ce.a,ue.a]]}),t})();var me=i("RLWM");let fe=(()=>{class t{}return t.\u0275mod=C.Lb({type:t}),t.\u0275inj=C.Kb({factory:function(e){return new(e||t)},imports:[[a.c,Zt,o.l,o.w,n.a,te.a,ee.a,ie.a,de,s.a,N.b,O.b,D.c,E.c,V.b,ae.c,l.a,oe.a,me.a]]}),t})()},zeEN:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var a=i("fXoL");let o=(()=>{class t{}return t.\u0275mod=a.Lb({type:t}),t.\u0275inj=a.Kb({factory:function(e){return new(e||t)},imports:[[]]}),t})()}}]);