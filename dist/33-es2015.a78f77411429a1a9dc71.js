(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"/D9e":function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i("tk/3"),a=i("lJxs"),r=i("sXtk"),n=i("fXoL");let o=(()=>{class t{constructor(t,e){this.handler=t,this.envService=e,this.baseUrl="",this.http=new s.c(t),this.baseUrl=e.backend}upload(t,e="file"){var i=new FormData;return i.append("file",t),this.http.post(this.baseUrl+"/fileupload/"+e,i).pipe(Object(a.a)(t=>t.fileName))}}return t.\u0275fac=function(e){return new(e||t)(n.Xb(s.b),n.Xb(r.a))},t.\u0275prov=n.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},"/ptB":function(t,e,i){"use strict";i.d(e,"a",(function(){return s}));class s{constructor(t){this.id=t.id||0,this.description=t.description||"",this.defaultValue=t.defaultValue||"1",this.parentId=t.parentId||0,this.parentName=t.parentName||"",this.mode=t.mode||0,this.modeName=t.modeName||"",this.sequence=t.sequence||0}}},AJS6:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var s=i("tk/3"),a=i("sXtk"),r=i("fXoL");let n=(()=>{class t{constructor(t,e){this.httpClient=t,this.envService=e,this.baseUrl="",this.baseUrl=e.backend}getTemplateByTemplateTypeId(t,e,i){let a=new s.f;return(t||e)&&(a=a.append("templateTypeId",""+t),a=a.append("clientId",""+e),a=a.append("notificationType",""+i)),this.httpClient.get(this.baseUrl+"/notifications/templates/email/content",{params:a})}CheckForTemplateType(t,e,i){let a=new s.f;return a=a.append("templateTypeId",""+t),a=a.append("notificationType",""+e),a=a.append("clientId",""+i),this.httpClient.get(this.baseUrl+"/notifications/templates/GetNotificationTemplateId",{params:a})}updateTemplateById(t,e){return this.httpClient.put(this.baseUrl+"/notifications/templates/"+t,e)}insertTemplate(t){return this.httpClient.post(this.baseUrl+"/notifications/templates",t)}getTemplateTypes(){return this.httpClient.get(this.baseUrl+"/notifications/templates/GetTemplateTypes")}getSmsTemplates(t){return this.httpClient.get(this.baseUrl+"/notifications/templates/sms/clientId/"+t)}getEmailTemplates(t){return this.httpClient.get(this.baseUrl+"/notifications/templates/email/clientId/"+t)}getNotificationTemplates(t){let e=new s.f;return e=e.append("notificationCategoryId",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/getNotificationTemplates",{params:e})}getKeywords(t=0){let e=new s.f;return e=e.append("id",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/Keywords",{params:e})}getConditions(t=0){let e=new s.f;return e=e.append("id",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/conditions",{params:e})}getNotificationModes(t){let e=new s.f;return e=e.append("clientId",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/notificationModes",{params:e})}createAlertSettings(t,e){return this.httpClient.post(this.baseUrl+"/notifications/alert/settings/"+e,t)}getAlertSettings(t=0,e=0,i=0,a=""){let r=new s.f;return t&&(r=r.append("clientId",""+t),r=r.append("notificationCategorId",""+e),r=r.append("templateTypeId",""+i),r=r.append("notificationModes",""+a)),this.httpClient.get(this.baseUrl+"/notifications/alert/settings",{params:r})}copyNotificationTemplates(t){return this.httpClient.post(this.baseUrl+"/notifications/templates/copy/contents",t)}getNotificationLogs(t){let e=new s.f;return e=e.append("fromDate",""+t.fromDate),e=e.append("toDate",""+t.toDate),e=e.append("status",""+t.statusId),e=e.append("mode",""+t.modeId),e=e.append("clientId",""+t.clientId),this.httpClient.get(this.baseUrl+"/notifications/logs",{params:e})}createSLDMaster(t){return this.httpClient.post(this.baseUrl+"/notifications/sld/master",t)}updateSLDMaster(t){return this.httpClient.put(this.baseUrl+"/notifications/sld/master",t)}getSLDMaster(t,e){let i=new s.f;return i=i.append("masterId",""+t),i=i.append("clientId",""+e),this.httpClient.get(this.baseUrl+"/notifications/sld/master",{params:i})}getClientAlertSettings(t){let e=new s.f;return t&&(e=e.append("clientId",""+t)),this.httpClient.get(this.baseUrl+"/notifications/client/alert/settings",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(r.Xb(s.c),r.Xb(a.a))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},O3qS:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var s=i("sXtk"),a=i("fXoL"),r=i("tk/3");let n=(()=>{class t{constructor(t,e){this.http=t,this.envService=e,this.baseUrl="",this.baseUrl=e.backend}getMasterDetails(){return this.http.get(this.baseUrl+"/masterdetails")}getMasterDetailsById(t){return this.http.get(this.baseUrl+"/masterdetails/"+t)}getModes(){return this.http.get(this.baseUrl+"/masterdetails/getModes")}getParentModes(t){return this.http.get(this.baseUrl+"/masterdetails/getparentmodes/"+t)}createMasterDetails(t){return this.http.post(this.baseUrl+"/masterdetails/",t)}updateMasterDetails(t,e){return this.http.put(this.baseUrl+"/masterdetails/"+t,e)}}return t.\u0275fac=function(e){return new(e||t)(a.Xb(r.c),a.Xb(s.a))},t.\u0275prov=a.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},WFQN:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var s=i("tk/3"),a=i("sXtk"),r=i("fXoL");let n=(()=>{class t{constructor(t,e){this.http=t,this.envService=e,this.baseUrl="",this.baseUrl=e.backend}getReplacedMeters(t){return this.http.get(this.baseUrl+"/devicelistreplacements/clientId/"+t)}createMeterReplacement(t){return this.http.post(this.baseUrl+"/devicelistreplacements/",t)}GetUtilityTypes(t){let e=new s.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/UtilityTypes",{params:e})}getAllUnits(t,e){let i=new s.f;return i=i.append("clientId",""+t),i=i.append("utilityTypeId",""+e),this.http.get(this.baseUrl+"/devicelistreplacements/Units",{params:i})}GetActiveDevices(t,e){let i=new s.f;return i=i.append("clientId",""+t),i=i.append("utilityTypeId",""+e),this.http.get(this.baseUrl+"/devicelistreplacements/ActiveDevices",{params:i})}getMeterErrorDetails(t){return this.http.post(this.baseUrl+"/devicelistreplacements/MeterError",t)}GetParametersList(){return this.http.get(this.baseUrl+"/devicelistreplacements/Parameters")}getDeviceDataDetails(t){return this.http.post(this.baseUrl+"/devicelistreplacements/DeviceData",t)}GetMeterList(t){let e=new s.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/MeterList",{params:e})}getDeviceGroupMeterList(t,e,i="0"){let a=new s.f;return a=a.append("meterTypeId",""+t),a=a.append("groupId",""+e),a=a.append("clientId",""+i),this.http.get(this.baseUrl+"/devicelistreplacements/type/group/meterList",{params:a})}getV1DeviceGroupMeterList(t,e,i="0"){let a=new s.f;return a=a.append("meterTypeId",""+t),a=a.append("groupId",""+e),a=a.append("clientId",""+i),this.http.get(this.baseUrl+"/devicelistreplacements/v1/type/group/meterListFilterByClient",{params:a})}getV1DeviceGroupMeterListWithoutFlowTypeFilter(t,e,i="0"){let a=new s.f;return a=a.append("meterTypeId",""+t),a=a.append("groupId",""+e),a=a.append("clientId",""+i),this.http.get(this.baseUrl+"/devicelistreplacements/V1/type/group/meterListFilterByClientWithoutFlowTypeFilter",{params:a})}getV1MeterList(t=0){let e=new s.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/v1/meterListFilterByClient",{params:e})}getClients(){return this.http.get(this.baseUrl+"/devicelistreplacements/v1/clients")}getV1MeterGroupList(t=0){let e=new s.f;return e=e.append("meterTypeId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/v1/meterGroups",{params:e})}}return t.\u0275fac=function(e){return new(e||t)(r.Xb(s.c),r.Xb(a.a))},t.\u0275prov=r.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})()},YaQ2:function(t,e,i){"use strict";i.d(e,"a",(function(){return o}));var s=i("fXoL"),a=i("ofXK");function r(t,e){if(1&t&&(s.Tb(0,"small"),s.Rc(1),s.Ob(2,"br"),s.Sb()),2&t){const t=e.$implicit;s.Cb(1),s.Tc(" ",t," ")}}function n(t,e){if(1&t&&(s.Tb(0,"div"),s.Pc(1,r,3,1,"small",1),s.Sb()),2&t){const t=s.fc();s.Cb(1),s.mc("ngForOf",t.listOfErrors())}}let o=(()=>{class t{constructor(){this.PATTERN_ERROR_MESSAGE={"/^[a-zA-Z ]*$/":"Accepts only alphabets with spaces","/^[a-zA-Z0-9]*$/":"Accepts only alphanumeric values with no spaces","/^[a-zA-Z0-9 ]*$/":"Accepts only alphanumeric values with spaces","/^[0-9]*$/":"Accepts only numbers","^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{3,4}$":"Enter valid email address of format test@mail.com"},this.ERROR_MESSAGE={required:()=>"This field is required",minlength:t=>`Min ${t.requiredLength} chars is required but got only ${t.actualLength}`,maxlength:t=>`Max chars allowed is ${t.requiredLength} but got ${t.actualLength}`,pattern:t=>""+this.PATTERN_ERROR_MESSAGE[t.requiredPattern],email:()=>"Enter valid email address of format test@mail.com"}}ngOnInit(){}shouldShowErrors(){return this.ctrl&&this.ctrl.errors&&this.ctrl.touched}listOfErrors(){return Object.keys(this.ctrl.errors).map(t=>this.ERROR_MESSAGE[t](this.ctrl.getError(t)))}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Hb({type:t,selectors:[["app-show-errors"]],inputs:{ctrl:"ctrl"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&s.Pc(0,n,2,1,"div",0),2&t&&s.mc("ngIf",e.shouldShowErrors())},directives:[a.o,a.n],styles:["small[_ngcontent-%COMP%]{color:red}"]}),t})()},hfXQ:function(t,e,i){"use strict";i.r(e),i.d(e,"SingleLineDiagramModule",(function(){return z}));var s=i("ofXK"),a=i("tyNb"),r=i("Nr/g"),n=i("dDrv"),o=i("AJS6"),c=i("/D9e"),l=i("zSPf"),h=i("WFQN"),p=i("KHMF"),d=i("zP6O"),m=i("sXtk"),u=i("fXoL"),b=i("dNgK"),f=i("b6Qw"),g=i("0IaG"),v=i("XiUz"),S=i("/t3+"),T=i("znSr"),I=i("bTqV"),y=i("NFeN"),C=i("Wp6s"),M=i("kmnG"),x=i("d3UM"),w=i("3Pt+"),N=i("qFsG"),L=i("f0Cb"),k=i("FKr1");const P=["profilePic"];function U(t,e){if(1&t&&(u.Tb(0,"mat-option",26),u.Rc(1),u.Sb()),2&t){const t=e.$implicit;u.mc("value",t.id),u.Cb(1),u.Sc(t.description)}}function D(t,e){if(1&t&&(u.Tb(0,"mat-option",26),u.Rc(1),u.Sb()),2&t){const t=e.$implicit;u.mc("value",t.id),u.Cb(1),u.Sc(t.description)}}function F(t,e){if(1&t&&(u.Tb(0,"mat-option",26),u.Rc(1),u.Sb()),2&t){const t=e.$implicit;u.mc("value",t.id),u.Cb(1),u.Sc(t.description)}}const R=[{path:"",component:(()=>{class t{constructor(t,e,i,s,a,r,n,o,c,l){var h;this.parameterChartService=t,this.estidamaChartService=e,this.templateService=i,this.snackbar=s,this.fileService=a,this.masterService=r,this.meterReplacementService=n,this.cookieService=o,this.dialog=c,this.envService=l,this.clientId=0,this.meters=[],this.filtermeters=[],this.meterName="",this.parameters=[],this.parameterName="",this.meterTypes=[],this.meterGroupList=[],this.meterGroup=null,this.lstMeterGroup=[],this.dateFormat="",this.pointSize=7,this.floors=[],this.sldMaster={},this.sldTransactions=[],this.attachment="",this.image="",this.baseUrl="",this.client=0,this.clients=[],this.baseUrl=l.backendForFiles,this.dateFormat=null!==(h=Object(p.e)("DateFormat"))&&void 0!==h?h:l.dateFormat}ngOnInit(){this.getClients(),this.onMeterGroupChange(),this.getFloors()}getClients(){this.clients=[],this.meterReplacementService.getClients().subscribe(t=>{t&&(this.clients=t)})}onChangeClient(){this.onMeterGroupChange()}getMeterTypes(){this.meterTypes=[],this.meters=[],this.parameters=[],this.estidamaChartService.getMeterTypes().subscribe(t=>{if(t){const e=t.meterTypeList;e&&e.forEach(t=>{this.meterTypes.push({id:t.meterTypeID,description:t.meterTypeName})}),this.meterTypeId=this.meterTypes[0].id,this.meterGroupList=t.meterGroupList,this.onMeterTypeChange()}})}getFloors(){this.floors=[],this.masterService.getUserMasterdata(9,0).subscribe(t=>{t&&(this.floors=t)})}onMeterTypeChange(t=null){t&&(this.meterTypeId=t.value),this.meterGroupList.forEach(t=>{t.meterTypeID==this.meterTypeId&&(this.lstMeterGroup.some(e=>e.groupID==t.groupID)||this.lstMeterGroup.push({groupID:t.groupID,groupName:t.groupName}))}),this.lstMeterGroup.length>0&&(this.meterGroup=this.lstMeterGroup[0].groupID),this.onMeterGroupChange()}onMeterGroupChange(){this.meters=[],0!=this.clientId&&this.meterReplacementService.getV1MeterList(this.clientId).subscribe(t=>{t&&(this.meters=this.filtermeters=t)}),this.getParameters()}onMeterChange(t){this.meters.filter(e=>{e.id==t.value&&(this.meterName=e.description,this.meterId=e.id)})}onFloorChange(t){this.floors.filter(e=>{e.id==t.value&&(this.floorId=e.id,this.onGetSLDTransactions())})}getParameters(){this.parameterChartService.getParameters(this.meterTypeId).subscribe(t=>{t&&(this.parameters=t)})}search(t){let e=this.select(t);this.meters=e}select(t){let e=[];if(t)for(let i of this.filtermeters)i.description.toLowerCase().indexOf(t)>-1&&e.push(i);else e=this.filtermeters;return e}getPosition(t){if(!this.meterId)return void this.notificationMessage("Please select meter","red-snackbar");if(this.sldTransactions.find(t=>t.meterId===Number(this.meterId)))return void this.notificationMessage("Meter already added","red-snackbar");this.element=this.root,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d");let e=0,i=0;e+=t.offsetX,i+=t.offsetY,this.drawCoordinates(e,i)}drawCoordinates(t,e){const i=this.ctx.createLinearGradient(0,0,170,0);i.addColorStop(1,"red"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(Number(t),Number(e),this.pointSize,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.fillText(this.meterName,t+5,e);const s=this.ctx.getImageData(t,e,1,1).data,a=(("000000"+this.rgbToHex(s[0],s[1],s[2])).slice(-6),{meterId:Number(this.meterId),meterName:this.meterName,x:Number(t),y:Number(e),clientId:Number(this.clientId),isDeleted:!1});this.sldTransactions.push(a)}rgbToHex(t,e,i){if(t>255||e>255||i>255)throw"Invalid color component";return(t<<16|e<<8|i).toString(16)}uploadPhoto(){this.fileService.upload(this.profilePic.nativeElement.files[0]).subscribe(t=>{this.attachment=t,this.image=this.baseUrl+"/uploads/"+this.attachment})}notificationMessage(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}clear(){this.sldTransactions=[],this.canvas=document.getElementById("canvas"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.image=""}onSave(){this.floorId?0!=this.clientId?this.sldMaster&&this.sldMaster.id?(this.sldMaster.sldPath=this.image,this.sldMaster.sldTransactions=this.sldTransactions,this.templateService.updateSLDMaster(this.sldMaster).subscribe({next:t=>{t?this.notificationMessage("SLD Master updated successfully","green-snackbar"):this.notificationMessage("SLD Master update failed","red-snackbar")},error:t=>{this.notificationMessage("SLD Master update failed","red-snackbar")}})):this.templateService.createSLDMaster({masterId:this.floorId,clientId:this.clientId,sldPath:this.image,sldTransactions:this.sldTransactions}).subscribe({next:t=>{t?this.notificationMessage("SLD Master saved successfully","green-snackbar"):this.notificationMessage("SLD Master save failed","red-snackbar")},error:t=>{this.notificationMessage("SLD Master save failed","red-snackbar")}}):this.notificationMessage("Please select Client","red-snackbar"):this.notificationMessage("Please select floor","red-snackbar")}onGetSLDTransactions(){this.sldMaster={},this.sldTransactions=[],this.image="",this.canvas=document.getElementById("canvas"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.templateService.getSLDMaster(this.floorId,this.clientId).subscribe({next:t=>{t&&(this.sldMaster=t,this.image=this.sldMaster.sldPath,this.sldTransactions=this.sldMaster.sldTransactions,this.sldMaster.sldTransactions.forEach(t=>{this.bindCoordinates(t.x,t.y,t.meterName)}))},error:t=>{this.sldMaster={},this.sldTransactions=[],this.image="",this.canvas=document.getElementById("canvas"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.notificationMessage("SLD Master not found","yellow-snackbar")}})}bindCoordinates(t,e,i){this.element=this.root,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d");const s=this.ctx.createLinearGradient(0,0,170,0);s.addColorStop(0,"black"),s.addColorStop(1,"red"),this.ctx.fillStyle=s,this.ctx.beginPath(),this.ctx.arc(Number(t),Number(e),this.pointSize,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.fillText(i,t+5,e);const a=this.ctx.getImageData(t,e,1,1).data;("000000"+this.rgbToHex(a[0],a[1],a[2])).slice(-6)}createFloor(){this.dialog.open(d.a,{data:[0,9]}).afterClosed().subscribe(t=>{t&&"Success"==t&&this.getFloors()})}}return t.\u0275fac=function(e){return new(e||t)(u.Nb(r.a),u.Nb(n.a),u.Nb(o.a),u.Nb(b.b),u.Nb(c.a),u.Nb(l.a),u.Nb(h.a),u.Nb(f.a),u.Nb(g.b),u.Nb(m.a))},t.\u0275cmp=u.Hb({type:t,selectors:[["fury-single-line-diagram"]],viewQuery:function(t,e){var i;1&t&&u.Vc(P,!0),2&t&&u.zc(i=u.cc())&&(e.profilePic=i.first)},decls:43,vars:8,consts:[["fxLayout","column","fxLayoutGap","2%",2,"padding","27px"],["color","primary","fxLayout","row","fxLayout.xs","column",1,"position-fixed"],["src","assets/img/fav-icon.png",1,"img-style",3,"fxHide.xs"],["fxLayout","row","fxLayout.xs","column"],[1,"toolbar-spacer"],[1,"fury-flex-form-field"],["mat-icon-button","","aria-label","Example icon-button with menu icon",1,"example-icon",3,"click"],["matTooltip","Reset",1,"icon-color"],["matTooltip","Print","mat-icon-button","",1,"example-icon",3,"click"],["fxLayout","column","fxLayoutGap","2%"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap","2%",2,"width","90%"],["fxFlex",""],[2,"width","75%","margin-right","0px"],["id","floorId","placeholder","Select a Floor",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["type","button","mat-mini-fab","","color","primary",1,"create",2,"height","30px","width","30px","margin-right","0px","margin-left","5px","padding-top","-5px",3,"click"],[2,"height","10px","width","10px","padding-top","-5px","margin-top","-25px","margin-left","-13px"],["name","clientId","id","clientId","placeholder","Client",3,"ngModel","ngModelChange","selectionChange"],["fxFlex","",2,"padding-top","15px"],["fxFlex","","type","file","id","picture","id","InputFile","name","InputFile","max-file-size","100kb",1,"input-file",3,"change"],["profilePic",""],["id","meterId","placeholder","Select a Meter",3,"selectionChange"],["matInput","","focused","'true'","type","text","autocomplete","off","placeholder","search",1,"myInput",3,"keyup"],["myInput",""],["fxLayout","row","fxLayoutGap","10%"],["id","canvas","width","810","height","720",3,"click"],[3,"value"]],template:function(t,e){1&t&&(u.Tb(0,"div",0),u.Tb(1,"mat-toolbar",1),u.Ob(2,"img",2),u.Tb(3,"span",3),u.Rc(4,"Single line diagram"),u.Sb(),u.Ob(5,"span",4),u.Tb(6,"div",5),u.Tb(7,"button",6),u.bc("click",(function(){return e.clear()})),u.Tb(8,"mat-icon",7),u.Rc(9,"refresh"),u.Sb(),u.Sb(),u.Sb(),u.Tb(10,"div",5),u.Tb(11,"button",8),u.bc("click",(function(){return e.onSave()})),u.Tb(12,"mat-icon"),u.Rc(13,"save"),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Tb(14,"mat-card",9),u.Tb(15,"div",10),u.Tb(16,"div",11),u.Tb(17,"mat-form-field",12),u.Tb(18,"mat-select",13),u.bc("selectionChange",(function(t){return e.onFloorChange(t)})),u.Pc(19,U,2,2,"mat-option",14),u.Sb(),u.Tb(20,"mat-hint"),u.Rc(21,"Please select Floor."),u.Sb(),u.Sb(),u.Tb(22,"button",15),u.bc("click",(function(){return e.createFloor()})),u.Tb(23,"mat-icon",16),u.Rc(24,"add"),u.Sb(),u.Sb(),u.Sb(),u.Tb(25,"mat-form-field",11),u.Tb(26,"mat-label"),u.Rc(27,"Client"),u.Sb(),u.Tb(28,"mat-select",17),u.bc("ngModelChange",(function(t){return e.clientId=t}))("selectionChange",(function(){return e.onChangeClient()})),u.Pc(29,D,2,2,"mat-option",14),u.Sb(),u.Tb(30,"mat-hint"),u.Rc(31,"Please select Client."),u.Sb(),u.Sb(),u.Tb(32,"div",18),u.Tb(33,"input",19,20),u.bc("change",(function(){return e.uploadPhoto()})),u.Sb(),u.Sb(),u.Tb(35,"mat-form-field",11),u.Tb(36,"mat-select",21),u.bc("selectionChange",(function(t){return e.onMeterChange(t)})),u.Tb(37,"input",22,23),u.bc("keyup",(function(t){return e.search(t.target.value)})),u.Sb(),u.Ob(39,"mat-divider"),u.Pc(40,F,2,2,"mat-option",14),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Tb(41,"mat-card",24),u.Tb(42,"canvas",25),u.bc("click",(function(t){return e.getPosition(t)})),u.Sb(),u.Sb(),u.Sb()),2&t&&(u.Cb(2),u.mc("fxHide.xs",!0),u.Cb(17),u.mc("ngForOf",e.floors),u.Cb(9),u.mc("ngModel",e.clientId),u.Cb(1),u.mc("ngForOf",e.clients),u.Cb(11),u.mc("ngForOf",e.meters),u.Cb(2),u.Lc("cursor:crosshair;background:url(",e.image,")"))},directives:[v.d,v.e,S.a,T.b,I.a,y.a,C.a,v.b,M.d,x.a,s.n,M.g,M.h,w.q,w.t,N.b,L.a,k.n],styles:[".common-buttons[_ngcontent-%COMP%]{height:50%;margin-top:10px}.myInput[_ngcontent-%COMP%]{height:50px!important;padding:10px!important}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.img-style[_ngcontent-%COMP%]{width:32px}.position-fixed[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;top:0;z-index:5}"]}),t})()}];let G=(()=>{class t{}return t.\u0275mod=u.Lb({type:t}),t.\u0275inj=u.Kb({factory:function(e){return new(e||t)},imports:[[a.j.forChild(R)],a.j]}),t})();var E=i("YUcS"),O=i("bSwM"),A=i("iadO"),X=i("jJIU");let z=(()=>{class t{}return t.\u0275mod=u.Lb({type:t}),t.\u0275inj=u.Kb({factory:function(e){return new(e||t)},providers:[s.f,s.g],imports:[[s.c,X.a,G,w.l,w.w,E.a,I.b,N.c,M.f,x.b,k.o,S.b,C.g,O.b,A.c,y.b,L.b]]}),t})()},zP6O:function(t,e,i){"use strict";i.d(e,"a",(function(){return M}));var s=i("3Pt+"),a=i("0IaG"),r=i("/ptB"),n=i("O3qS"),o=i("xXXn"),c=i("fXoL"),l=i("dNgK"),h=i("/t3+"),p=i("bTqV"),d=i("NFeN"),m=i("MutI"),u=i("4FRi"),b=i("XiUz"),f=i("ofXK"),g=i("kmnG"),v=i("qFsG"),S=i("YaQ2"),T=i("/1cH"),I=i("FKr1");function y(t,e){if(1&t&&(c.Tb(0,"mat-option",20),c.Rc(1),c.Sb()),2&t){const t=e.$implicit;c.mc("value",t.description),c.Cb(1),c.Tc(" ",t.description," ")}}function C(t,e){if(1&t){const t=c.Ub();c.Tb(0,"mat-form-field",10),c.Tb(1,"mat-label"),c.Rc(2,"Parent Item"),c.Sb(),c.Tb(3,"input",16),c.bc("ngModelChange",(function(e){return c.Ec(t),c.fc().parentName=e})),c.Sb(),c.Tb(4,"mat-autocomplete",17,18),c.bc("optionSelected",(function(e){return c.Ec(t),c.fc().selectParentMode(e)})),c.Pc(6,y,2,2,"mat-option",19),c.Sb(),c.Sb()}if(2&t){const t=c.Ac(5),e=c.fc();c.Cb(3),c.mc("matAutocomplete",t)("ngModel",e.parentName),c.Cb(3),c.mc("ngForOf",e.filteredParentModes)}}let M=(()=>{class t{constructor(t,e,i,s,a,r){this.dialogRef=t,this.masterDetailsService=e,this.snackbar=i,this.dialog=s,this.modes=a,this.fb=r,this.isCancel=!1,this.parentExists=!1,this.modeId=0,this.parentId=0,this.parentName="",this.parentIdFilter=0,t.disableClose=!0}ngOnInit(){this.parentId=this.modes[0],this.modeId=this.modes[1],this.parentIdFilter=null==this.modes[2]?0:this.modes[2],this.defaults=new r.a({}),this.form=this.fb.group({parentId:[this.defaults.parentId||""],parentName:[this.defaults.parentName||""],description:[this.defaults.description||"",s.y.required]}),this.modeId&&(this.parentExists=!1,this.form.controls.parentName.clearValidators(),this.form.controls.parentName.markAsUntouched(),this.masterDetailsService.getParentModes(this.modeId).subscribe(t=>{if(t){this.parentIdFilter>0&&(t=t.filter(t=>t.id==this.parentIdFilter)),this.filteredParentModes=t,this.metadataParentModes=t;let e=t.filter(t=>t.id==this.parentId);e&&e.length>0&&(this.parentName=e[0].description,this.form.controls.parentId.setValue(e[0].id)),t&&t.length>0&&(this.parentExists=!0,this.form.controls.parentName.setValidators([s.y.required]))}}),this.form.controls.parentName.updateValueAndValidity()),this.form.controls.parentName.valueChanges.subscribe(t=>{this.filteredParentModes=this.filterParentMode(t)})}filterParentMode(t){return this.metadataParentModes.filter(e=>0===e.description.toLowerCase().indexOf(t.toLowerCase()))}save(){this.isCancel?(this.isCancel=!1,this.dialog.open(o.a,{data:{label:"Are you sure you want to Cancel?",selected:!1}}).afterClosed().subscribe(t=>{t&&this.dialogRef.close()})):(Object.assign(this.defaults,this.form.value),this.defaults.mode=this.modeId,""==this.form.controls.parentId.value&&(this.defaults.parentId=0),this.masterDetailsService.createMasterDetails(this.defaults).subscribe(t=>{t?(this.notificationMessage("Master Details Created Successfully.","green-snackbar"),this.dialogRef.close("Success")):this.notificationMessage("Master Details Creation Failed.","red-snackbar")}))}notificationMessage(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}selectParentMode(t){this.metadataParentModes.forEach(e=>{t.option.value==e.description&&(this.form.controls.parentName.setValue(e.description),this.form.controls.parentId.setValue(e.id))})}close(){this.dialogRef.close()}closeDialog(){this.isCancel=!0}}return t.\u0275fac=function(e){return new(e||t)(c.Nb(a.h),c.Nb(n.a),c.Nb(l.b),c.Nb(a.b),c.Nb(a.a),c.Nb(s.f))},t.\u0275cmp=c.Hb({type:t,selectors:[["fury-create-user-master"]],decls:27,vars:4,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"mat-dlg-content"],[1,"person","padding-top"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","20px"],["fxFlex","",4,"ngIf"],["fxFlex",""],["type","text","formControlName","description","matInput",""],[3,"ctrl"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button","",3,"disabled"],["matInput","","formControlName","parentName",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["parent","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(c.Tb(0,"div",0),c.Tb(1,"mat-toolbar",1),c.Tb(2,"span"),c.Rc(3,"Create Master Details"),c.Sb(),c.Ob(4,"span",2),c.Tb(5,"button",3),c.bc("click",(function(){return e.close()})),c.Tb(6,"mat-icon",4),c.Rc(7,"close"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(8,"form",5),c.bc("ngSubmit",(function(){return e.save()})),c.Tb(9,"mat-dialog-content",6),c.Tb(10,"fury-card"),c.Tb(11,"fury-card-content"),c.Tb(12,"div",7),c.Tb(13,"div",8),c.Pc(14,C,7,3,"mat-form-field",9),c.Tb(15,"mat-form-field",10),c.Tb(16,"mat-label"),c.Rc(17,"Item Name"),c.Sb(),c.Ob(18,"input",11),c.Ob(19,"app-show-errors",12),c.Tb(20,"mat-hint"),c.Rc(21,"Please enter Item Name"),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Sb(),c.Tb(22,"mat-dialog-actions",13),c.Tb(23,"button",14),c.bc("click",(function(){return e.closeDialog()})),c.Rc(24,"CANCEL"),c.Sb(),c.Tb(25,"button",15),c.Rc(26,"CREATE MASTER DETAILS"),c.Sb(),c.Sb(),c.Sb()),2&t&&(c.Cb(8),c.mc("formGroup",e.form),c.Cb(6),c.mc("ngIf",1==e.parentExists),c.Cb(5),c.mc("ctrl",e.form.get("description")),c.Cb(6),c.mc("disabled",!e.form.valid))},directives:[a.i,h.a,p.a,d.a,m.c,s.z,s.r,s.k,a.f,u.a,u.c,b.d,b.e,f.o,g.d,b.b,g.h,s.c,v.b,s.q,s.i,S.a,g.g,a.c,b.c,T.c,T.a,f.n,I.n],styles:[".task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]}),t})()}}]);