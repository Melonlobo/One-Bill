(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{STtJ:function(t,e,s){"use strict";s.r(e),s.d(e,"EmsEnergyCostModule",(function(){return _}));var n=s("ofXK"),o=s("3Pt+"),i=s("tyNb"),r=s("6n/F"),a=s("sXtk"),c=s("KHMF"),l=s("JX19"),h=s("fXoL"),u=s("b6Qw"),g=s("xBcV"),b=s("rvYj"),d=s("XiUz"),y=s("jaxi"),p=s("Wp6s");let C=(()=>{class t{constructor(t){var e;this.envService=t,this.energyCost=0,this.currency="",this.currency=null!==(e=Object(c.e)("Currency"))&&void 0!==e?e:t.currencyFormat}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(h.Nb(a.a))},t.\u0275cmp=h.Hb({type:t,selectors:[["fury-energy-cost-tile"]],inputs:{costLabel:"costLabel",energyCost:"energyCost"},decls:7,vars:3,consts:[["fxFlex","",1,"mat-elevation-z4"],["fxFlex",""],[1,"topPadding"],[1,"tileHeading"],[1,"energyCost"]],template:function(t,e){1&t&&(h.Tb(0,"mat-card",0),h.Tb(1,"div",1),h.Ob(2,"span",2),h.Tb(3,"span",3),h.Rc(4),h.Sb(),h.Tb(5,"p",4),h.Rc(6),h.Sb(),h.Sb(),h.Sb()),2&t&&(h.Cb(4),h.Sc(e.costLabel),h.Cb(2),h.Uc(" ",e.currency," ",e.energyCost," "))},directives:[p.a,d.b],styles:[".topPadding[_ngcontent-%COMP%]{padding-top:20px}.energyCost[_ngcontent-%COMP%], .tileHeading[_ngcontent-%COMP%]{font-weight:700}.energyCost[_ngcontent-%COMP%]{font-size:x-large;vertical-align:middle;margin:0;padding:25px 0 10px}.gain[_ngcontent-%COMP%]{color:#5cb85c}.gain[_ngcontent-%COMP%], .loss[_ngcontent-%COMP%]{padding:0 10px;font-weight:bolder;font-size:large}.loss[_ngcontent-%COMP%]{color:#d9534f}"]}),t})();function m(t,e){if(1&t&&(h.Tb(0,"mat-button-toggle",14),h.Rc(1),h.Sb()),2&t){const t=e.$implicit,s=e.index;h.nc("id",t),h.nc("value",t),h.mc("checked",0===s),h.Cb(1),h.Sc(t)}}function f(t,e){if(1&t&&(h.Tb(0,"mat-button-toggle",15),h.Rc(1),h.Sb()),2&t){const t=e.$implicit,s=e.index;h.nc("id",t),h.nc("value",t),h.mc("checked",0===s),h.Cb(1),h.Sc(t)}}const v=[{path:"",component:(()=>{class t{constructor(t,e,s){var n;this.cookieService=t,this.emsDashboardService=e,this.envService=s,this.showSpinner=!1,this.frequency=["Daily","Weekly","Monthly","Yearly"],this.buttons=["Today","Yesterday"],this.selectedValue="Daily",this.reportType="Today",this.previousLabel="",this.currentLabel="",this.forecastLabel="",this.estimatedSavingsLabel="Estimated Savings",this.previousEnergyCost=0,this.currentEnergyCost=0,this.forecastEnergyCost=0,this.estimatedSavings=0,this.clientId="0",this.meterTypes=[],this.energyCostComparison=[],this.costComparisonChart=[],this.energyCost=[],this.isCurrent=!0,this.currency="",this.currency=null!==(n=Object(c.e)("Currency"))&&void 0!==n?n:s.currencyFormat}ngOnInit(){const t=this.cookieService.get("filterData");if(t){let e=JSON.parse(t);this.clientId=""==e.strClientId?this.cookieService.get("globalClientId"):e.strClientId}this.setConsumptionLables(),this.getUtilities()}getUtilities(){this.emsDashboardService.getUtilities(this.clientId).subscribe(t=>{t&&(this.meterTypes=[],t.forEach(t=>{this.meterTypes.push(t.description)}),this.getEnergyCost())})}onValChange(t){null!=t&&(this.selectedValue=t.value,this.setConsumptionLables(t.value),this.reportType=this.buttons[0],this.isCurrent=!0),this.getEnergyCost()}ngAfterViewChecked(){let t=document.getElementById(this.reportType);this.buttons.forEach(t=>{document.getElementById(t).className="mat-raised-button"}),t.className="mat-raised-button-checked"}onButtonChange(t){this.reportType=null!=t?t.value:this.buttons[0],this.isCurrent=this.buttons[0]==this.reportType,this.setConsumptionLables(this.selectedValue),this.getEnergyCost()}setButtonColor(){let t=document.getElementById(this.reportType);t&&(this.buttons.forEach(t=>{document.getElementById(t).className="mat-raised-button"}),t&&(t.className="mat-raised-button-checked"))}setConsumptionLables(t="Daily"){this.previousLabel="",this.currentLabel="",this.forecastLabel="";let e=new Date;"Daily"===t?(1==this.isCurrent?(this.currentLabel="So far Today",this.previousLabel="Yesterday",this.forecastLabel="Predicted Today"):(this.currentLabel="Yesterday",this.previousLabel="Day Before Yesterday",this.forecastLabel="Today"),this.buttons=["Today","Yesterday"]):"Weekly"===t?(1==this.isCurrent?(this.currentLabel="So far This Week",this.previousLabel="Last Week",this.forecastLabel="Predicted This Week"):(this.currentLabel="Last Week",this.previousLabel="Second Last Week",this.forecastLabel="This Week"),this.buttons=["This Week","Last Week"]):"Monthly"===t?(1==this.isCurrent?(e.setDate(1),e.setMonth(e.getMonth()-1),this.currentLabel="So far This Month",this.previousLabel="Last Month",this.forecastLabel="Predicted This Month"):(e.setDate(1),e.setMonth(e.getMonth()-2),this.currentLabel="Last Month",this.previousLabel="Secons Last Month",this.forecastLabel="This Month"),this.buttons=["This Month","Last Month"]):(1==this.isCurrent?(this.currentLabel="So far This Year",this.previousLabel="Last Year",this.forecastLabel="Predicted This Year"):(this.currentLabel="Last Year",this.previousLabel="Second Last Year",this.forecastLabel="This Year"),this.buttons=["This Year","Last Year"])}getEnergyCost(){let t;this.showSpinner=!1,this.energyCostComparison=[],this.costComparisonChart=[];let e=[];this.currentEnergyCost=0,this.previousEnergyCost=0,this.forecastEnergyCost=0,this.estimatedSavings=0,this.stackedBarChartOptions=this.setStackedCostComparisonChart(this.energyCostComparison,this.costComparisonChart,e);let s=document.getElementById("eccontainer1");if(s&&r.chart("eccontainer1",this.stackedBarChartOptions),this.meterTypes&&this.meterTypes.length>0){let n=this.meterTypes.join(",");this.emsDashboardService.getOverallEnergyCost(this.clientId,n,this.selectedValue,this.isCurrent).subscribe({next:o=>{o?(this.showSpinner=!1,this.energyCost=o,t=o.energyCostStacks,e=o.categories,this.stackedBarChartOptions=this.setStackedCostComparisonChart(this.energyCostComparison,t,e),s=document.getElementById("eccontainer1"),s&&r.chart("eccontainer1",this.stackedBarChartOptions),this.emsDashboardService.getGroupWiseEnergyCost(this.clientId,n,this.selectedValue).subscribe({next:t=>{t?(this.showSpinner=!1,1==this.isCurrent?(this.currentEnergyCost=t.currentTotalCost,this.previousEnergyCost=t.previousTotalCost,this.forecastEnergyCost=t.forecastTotalCost,this.estimatedSavings=t.currentEstimatedSavings):(this.currentEnergyCost=t.previousTotalCost,this.previousEnergyCost=t.lastPreviousTotalCost,this.forecastEnergyCost=t.currentTotalCost,this.estimatedSavings=t.previousEstimatedSavings),this.showSpinner=!1):this.showSpinner=!1},error:t=>{this.showSpinner=!1}})):this.showSpinner=!1},error:t=>{this.showSpinner=!1}})}else this.showSpinner=!1}setStackedCostComparisonChart(t=null,e,s=[]){let n="",o="",i=new Date,a=new Date,c="Today's Energy Cost",l="";return"Monthly"==this.selectedValue?(l="Day",a.setDate(1),a.setMonth(a.getMonth()-1),n=i.toLocaleString("en-us",{month:"long"}),o=a.toLocaleString("en-us",{month:"long"}),c=1==this.isCurrent?n+" Month Energy Cost":o+" Month Energy Cost"):"Daily"==this.selectedValue?(l="Hour",c=1==this.isCurrent?"Today's Energy Cost":"Yesterday's Energy Cost"):"Weekly"==this.selectedValue?(l="Date",c=1==this.isCurrent?"This Week Energy Cost":"Last Week Energy Cost"):"Yearly"==this.selectedValue&&(l="Month",c=1==this.isCurrent?"This Year Energy Cost":"Last Year Energy Cost"),{chart:{type:"spline",marginLeft:90},title:{text:c,style:{fontWeight:"bolder",fontFamily:"Roboto"}},credits:{enabled:!1},colors:["#1fd286","#1e5eff","#ffda44","#d80027","#808080","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],xAxis:{categories:s,visible:!0,title:{text:l}},yAxis:{title:{text:"Total Cost"}},legend:{align:"center",x:30,verticalAlign:"bottom",y:20,floating:!1,backgroundColor:r.defaultOptions.legend.backgroundColor||"white",shadow:!1},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: "+this.currency+" {point.y}"},plotOptions:{series:{pointWidth:50},column:{pointWidth:20,stacking:"normal",dataLabels:{enabled:!1}}},series:e}}}return t.\u0275fac=function(e){return new(e||t)(h.Nb(u.a),h.Nb(l.a),h.Nb(a.a))},t.\u0275cmp=h.Hb({type:t,selectors:[["fury-ems-energy-cost"]],decls:19,vars:12,consts:[["mode","card"],["fxLayout","column",1,"content"],[1,"toolBar"],[1,"example-spacer"],["name","fontStyle","aria-label","Font Style",1,"buttons",2,"font-size","small","float","right",3,"value","change"],["mat-raised-button","","style","padding: 0px;",3,"id","checked","value",4,"ngFor","ngForOf"],["id","buttonGroup"],["name","fontStyle","aria-label","Font Style",1,"buttons",2,"font-size","small","border","0px",3,"value","change"],["style","padding: 0px;margin-right: 8px;",3,"id","checked","value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutGap","10px","fxFlex","100%",1,"content",2,"padding","0% 0% 1% 0%"],["fxFlex","",3,"costLabel","energyCost"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column",1,"content",2,"padding","0% 0% 0.25% 0.20%"],["fxFlex","100%",1,"mat-elevation-z4"],["id","eccontainer1"],["mat-raised-button","",2,"padding","0px",3,"id","checked","value"],[2,"padding","0px","margin-right","8px",3,"id","checked","value"]],template:function(t,e){1&t&&(h.Tb(0,"fury-page-layout",0),h.Tb(1,"fury-page-layout-content",1),h.Tb(2,"div"),h.Tb(3,"span",2),h.Rc(4,"Energy Cost"),h.Sb(),h.Ob(5,"span",3),h.Tb(6,"mat-button-toggle-group",4),h.bc("change",(function(t){return e.onValChange(t)})),h.Pc(7,m,2,4,"mat-button-toggle",5),h.Sb(),h.Sb(),h.Tb(8,"div",6),h.Tb(9,"mat-button-toggle-group",7),h.bc("change",(function(t){return e.onButtonChange(t)})),h.Pc(10,f,2,4,"mat-button-toggle",8),h.Sb(),h.Sb(),h.Tb(11,"div",9),h.Ob(12,"fury-energy-cost-tile",10),h.Ob(13,"fury-energy-cost-tile",10),h.Ob(14,"fury-energy-cost-tile",10),h.Ob(15,"fury-energy-cost-tile",10),h.Sb(),h.Tb(16,"div",11),h.Tb(17,"mat-card",12),h.Ob(18,"div",13),h.Sb(),h.Sb(),h.Sb(),h.Sb()),2&t&&(h.Cb(6),h.mc("value",e.selectedValue),h.Cb(1),h.mc("ngForOf",e.frequency),h.Cb(2),h.mc("value",e.reportType),h.Cb(1),h.mc("ngForOf",e.buttons),h.Cb(2),h.mc("costLabel",e.previousLabel)("energyCost",e.previousEnergyCost),h.Cb(1),h.mc("costLabel",e.currentLabel)("energyCost",e.currentEnergyCost),h.Cb(1),h.mc("costLabel",e.forecastLabel)("energyCost",e.forecastEnergyCost),h.Cb(1),h.mc("costLabel",e.estimatedSavingsLabel)("energyCost",e.estimatedSavings))},directives:[g.a,b.a,d.d,y.b,n.n,d.e,d.b,C,p.a,y.a],styles:['.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#0051b4;color:#fff!important}.content[_ngcontent-%COMP%]{margin-top:1%}.toolBar[_ngcontent-%COMP%]{font-size:x-large;font-weight:700;line-height:50px}.common-buttons[_ngcontent-%COMP%]{height:50%}.mat-button-toggle-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:checked{background-color:#1fd286;color:#fff!important}.mat-raised-button[_ngcontent-%COMP%]{color:#000}.mat-raised-button-checked[_ngcontent-%COMP%]{background-color:#1fd286!important;color:#fff!important}.loading-indicator[_ngcontent-%COMP%]{position:fixed;z-index:999;height:2em;width:2em;overflow:show;margin:auto;top:0;left:0;bottom:0;right:0}.loading-indicator[_ngcontent-%COMP%]:before{content:"";display:block;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.3)}']}),t})()}];let L=(()=>{class t{}return t.\u0275mod=h.Lb({type:t}),t.\u0275inj=h.Kb({factory:function(e){return new(e||t)},imports:[[i.j.forChild(v)],i.j]}),t})();var S=s("qFsG"),T=s("NFeN"),x=s("/t3+"),k=s("kmnG"),E=s("VE2z"),O=s("KthW"),M=s("WCGO"),w=s("QMK6"),P=s("q8Jb"),F=s("0jmt"),W=s("0IaG"),Y=s("Qu3c"),D=s("STbY");let _=(()=>{class t{}return t.\u0275mod=h.Lb({type:t}),t.\u0275inj=h.Kb({factory:function(e){return new(e||t)},providers:[n.f,n.g],imports:[[n.c,L,o.l,O.a,M.a,o.w,w.a,E.a,F.a,P.a,k.f,S.c,y.c,T.b,D.c,x.b,Y.b,W.g]]}),t})()}}]);