!function(){function t(t){return function(t){if(Array.isArray(t))return i(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||e(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){if(t){if("string"==typeof t)return i(t,e);var a=Object.prototype.toString.call(t).slice(8,-1);return"Object"===a&&t.constructor&&(a=t.constructor.name),"Map"===a||"Set"===a?Array.from(t):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?i(t,e):void 0}}function i(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,a=new Array(e);i<e;i++)a[i]=t[i];return a}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function n(t,e,i){return e&&o(t.prototype,e),i&&o(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[42],{"6GKC":function(t,e,i){"use strict";i.d(e,"a",(function(){return r}));var o=i("KHMF"),l=i("fXoL"),r=function(){var t=function(){function t(e){a(this,t),this.el=e,this.roundOffFormat="",this.decimalPlaces=0,this.keyString="Decimal",this.regex=new RegExp(/^\d*\.?\d{0,2}$/g),this.specialKeys=["Backspace","Tab","End","Home","-","ArrowLeft","ArrowRight","Del","Delete"],this.roundOffFormat=Object(o.e)("RoundOff"),this.decimalPlaces=parseInt(this.roundOffFormat.substring(this.roundOffFormat.indexOf("-")+1,this.roundOffFormat.length))}return n(t,[{key:"onKeyDown",value:function(t){if(this.regex=new RegExp("^\\d*\\.?\\d{0,"+this.decimalPlaces+"}$"),-1===this.specialKeys.indexOf(t.key)){var e=this.el.nativeElement.value,i=this.el.nativeElement.selectionStart,a=[e.slice(0,i),t.key===this.keyString||t.key===this.keyString.toLowerCase()?".":t.key,e.slice(i)].join("");a&&!String(a).match(this.regex)&&t.preventDefault()}}}]),t}();return t.\u0275fac=function(e){return new(e||t)(l.Nb(l.l))},t.\u0275dir=l.Ib({type:t,selectors:[["","furyValidateDecimalPlacesDirective",""]],hostBindings:function(t,e){1&t&&l.bc("keydown",(function(t){return e.onKeyDown(t)}))}}),t}()},"a+RD":function(t,e,i){"use strict";i.d(e,"a",(function(){return S}));var o=i("fXoL"),l=i("xgIS"),r=i("/uUt"),s=i("Kj3r"),c=i("ofXK"),u=i("STbY"),f=i("XiUz"),d=i("NFeN"),m=i("bTqV"),h=i("bSwM"),p=i("3Pt+"),b=["filter"];function g(t,e){if(1&t&&(o.Tb(0,"button",12),o.Tb(1,"mat-icon"),o.Rc(2,"filter_list"),o.Sb(),o.Sb()),2&t){o.fc(2);var i=o.Ac(3);o.mc("matMenuTriggerFor",i)}}function y(t,e){if(1&t&&(o.Tb(0,"div",5),o.Tb(1,"div",6),o.Rc(2),o.Sb(),o.Tb(3,"div",7),o.Tb(4,"mat-icon",8),o.Rc(5,"search"),o.Sb(),o.Ob(6,"input",9,10),o.Sb(),o.Pc(8,g,3,1,"button",11),o.kc(9,1),o.Sb()),2&t){var i=o.fc();o.Cb(2),o.Sc(i.name),o.Cb(6),o.mc("ngIf",!i.hideFilter)}}function C(t,e){if(1&t){var i=o.Ub();o.Tb(0,"button",13),o.bc("click",(function(t){o.Ec(i);var a=e.$implicit;return o.fc().toggleColumnVisibility(a,t)})),o.Tb(1,"mat-checkbox",14,15),o.bc("ngModelChange",(function(t){return o.Ec(i),e.$implicit.visible=t}))("click",(function(t){return o.Ec(i),t.stopPropagation()})),o.Rc(3),o.Sb(),o.Sb()}if(2&t){var a=e.$implicit;o.Cb(1),o.mc("ngModel",a.visible),o.Cb(2),o.Tc(" ",a.name," ")}}var T=["*",[["",8,"actions"]]],v=["*",".actions"],S=function(){var t=function(){function t(){a(this,t),this.filterChange=new o.o}return n(t,[{key:"ngAfterViewInit",value:function(){var t=this;this.hideHeader||Object(l.a)(this.filter.nativeElement,"keyup").pipe(Object(r.a)(),Object(s.a)(150)).subscribe((function(){t.filterChange.emit(t.filter.nativeElement.value)}))}},{key:"toggleColumnVisibility",value:function(t,e){e.stopPropagation(),e.stopImmediatePropagation(),t.visible=!t.visible}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=o.Hb({type:t,selectors:[["fury-list"]],viewQuery:function(t,e){var i;1&t&&o.Vc(b,!0),2&t&&o.zc(i=o.cc())&&(e.filter=i.first)},inputs:{name:"name",columns:"columns",hideHeader:"hideHeader",hideFilter:"hideFilter"},outputs:{filterChange:"filterChange"},ngContentSelectors:v,decls:6,vars:2,consts:[[1,"fury-list-table"],["class","fury-list-header","fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",4,"ngIf"],["yPosition","below","xPosition","before"],["columnFilter","matMenu"],["class","checkbox-item mat-menu-item",3,"click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","start center","fxLayoutGap","8px","fxLayoutGap.gt-xs","24px",1,"fury-list-header"],[1,"fury-list-name"],["fxLayout","row","fxLayoutAlign","start center","fxFlex",""],[1,"fury-filter-input-icon"],["fxFlex","","placeholder","Search\u2026",1,"fury-filter-input"],["filter",""],["class","fury-column-filter","type","button","mat-icon-button","",3,"matMenuTriggerFor",4,"ngIf"],["type","button","mat-icon-button","",1,"fury-column-filter",3,"matMenuTriggerFor"],[1,"checkbox-item","mat-menu-item",3,"click"],[1,"checkbox",3,"ngModel","ngModelChange","click"],["checkbox",""]],template:function(t,e){1&t&&(o.lc(T),o.Tb(0,"div",0),o.Pc(1,y,10,2,"div",1),o.Tb(2,"mat-menu",2,3),o.Pc(4,C,4,2,"button",4),o.Sb(),o.kc(5),o.Sb()),2&t&&(o.Cb(1),o.mc("ngIf",!e.hideHeader),o.Cb(3),o.mc("ngForOf",e.columns))},directives:[c.o,u.e,c.n,f.d,f.c,f.e,f.b,d.a,m.a,u.d,h.a,p.q,p.t],styles:[".fury-list-table{display:flex;flex-direction:column}.fury-list-table .fury-list-header{padding-left:24px;padding-right:24px;height:64px;border-top-left-radius:8px;border-top-right-radius:8px}@media screen and (max-width:599px){.fury-list-table .fury-list-header{height:auto;padding-top:24px;padding-bottom:24px}}.fury-list-table .fury-list-header .fury-list-name{font-size:20px;line-height:32px;font-weight:500;padding-right:24px}@media screen and (max-width:599px){.fury-list-table .fury-list-header .fury-list-name{border-right:none}}.fury-list-table .fury-list-header .fury-filter-input{font-size:16px;line-height:1.125;border:none;height:32px}.fury-list-table .fury-list-header .fury-filter-input:focus{outline:none}.fury-list-table .fury-list-header .fury-filter-input-icon{width:1.2em;vertical-align:bottom;height:22px;font-size:22px;margin-right:8px}.fury-list-table table{width:100%}.fury-list-table .mat-header-row .mat-header-cell .mat-sort-header-button{text-transform:uppercase}.fury-list-table .mat-cell.image-cell,.fury-list-table .mat-header-cell.image-cell{flex:0;width:59px}.fury-list-table .mat-cell.image-cell img,.fury-list-table .mat-header-cell.image-cell img{border-radius:50%;height:35px;width:35px;margin-right:24px;vertical-align:middle}.fury-list-table .mat-cell,.fury-list-table .mat-header-cell{white-space:nowrap;padding-left:12px;padding-right:12px}.fury-list-table .mat-cell.actions-cell,.fury-list-table .mat-header-cell.actions-cell{flex:0;width:40px;overflow:visible}.fury-list-table .paginator{display:block}"],encapsulation:2}),t}()},dUAH:function(t,e,i){"use strict";i.d(e,"a",(function(){return l}));var o=i("fXoL"),l=function(){var t=function(){function t(){a(this,t)}return n(t,[{key:"transform",value:function(t){return null!=t?t.toString().replace(/,/g,""):""}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275pipe=o.Mb({name:"noComma",type:t,pure:!0}),t}()},xoEb:function(i,o,l){"use strict";l.r(o),l.d(o,"CreateBillheadModule",(function(){return xe}));var r,s=l("ofXK"),c=l("3Pt+"),u=l("q8Jb"),f=l("0jmt"),d=l("KthW"),m=l("tyNb"),h=l("M9IT"),p=l("Dh3D"),b=l("+0xr"),g=l("jtHE"),y=l("pLZG"),C=function t(e){a(this,t),this.id=e.id||0,this.clientId=e.clientId||0,this.accountHeadName=e.accountHeadName||"",this.accountHeadType=e.accountHeadType||"",this.headType=e.headType||"",this.utilityTypeId=e.utilityTypeId||0,this.utilityType=e.utilityType||"",this.formulaField=e.formulaField||0,this.formulaFieldName=e.formulaFieldName||"",this.operator=e.operator||0,this.operatorName=e.operatorName||"",this.tariffId=e.tariffId||0,this.tariff=e.tariff||"",this.fixedAmount=e.fixedAmount||0,this.accountNumber=e.accountNumber||"",this.accountNumberName=e.accountNumberName||"",this.noOfDays=e.noOfDays||0,this.position=e.position||0,this.isVAT=e.isVAT||!1,this.isDiscount=e.isDiscount||!1,this.measuringUnitId=e.measuringUnitId||0,this.discountAmount=e.discountAmount||0,this.discountType=e.discountType||"",this.contractType=e.contractType||"",this.contractTypeId=e.contractTypeId||0,this.isProportional=e.isProportional||!1},T=l("Ku73"),v=l("nStZ"),S=l("tk/3"),F=l("sXtk"),x=l("fXoL"),P=((r=function(){function t(e,i){a(this,t),this.http=e,this.envService=i,this.baseUrl="",this.baseUrl=i.backend}return n(t,[{key:"getBillHeads",value:function(t){return this.http.get(this.baseUrl+"/accountheads/clientId/"+t)}},{key:"createBillHead",value:function(t){return this.http.post(this.baseUrl+"/accountheads",t)}},{key:"updateBillHeadById",value:function(t,e){return this.http.put(this.baseUrl+"/accountheads/"+t,e)}},{key:"deleteBillHeadById",value:function(t){return this.http.delete(this.baseUrl+"/accountheads/"+t)}},{key:"getTariffs",value:function(t,e){return this.http.get(this.baseUrl+"/accountheads/getTariffs/"+t+"/"+e)}},{key:"copyBillHead",value:function(t){return this.http.post(this.baseUrl+"/accountheads/copy/contents",t)}},{key:"checkForDuplicatePosition",value:function(t,e,i){var a=new S.f;return a=(a=(a=a.append("position",""+t)).append("id",""+e)).append("clientId",""+i),this.http.get(this.baseUrl+"/accountheads/position",{params:a})}},{key:"getNextPosition",value:function(t){var e=new S.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/accountheads/nextposition",{params:e})}},{key:"getGracePeriod",value:function(t,e){var i=new S.f;return i=(i=i.append("clientId",""+t)).append("formula",""+e),this.http.get(this.baseUrl+"/accountheads/gracePeriod",{params:i})}},{key:"getBillSettingClientMapping",value:function(t){var e=new S.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/accountheads/billSettingClientMapping",{params:e})}}]),t}()).\u0275fac=function(t){return new(t||r)(x.Xb(S.c),x.Xb(F.a))},r.\u0275prov=x.Jb({token:r,factory:r.\u0275fac,providedIn:"root"}),r),k=l("0IaG"),A=l("zSPf"),I=l("xXXn"),N=l("zP6O"),O=l("KHMF"),L=l("b6Qw"),B=l("/t3+"),w=l("bTqV"),D=l("NFeN"),R=l("MutI"),V=l("4FRi"),M=l("XiUz"),H=l("kmnG"),U=l("qFsG"),E=l("YaQ2"),j=l("d3UM"),q=l("FKr1"),z=l("/1cH"),$=l("bSwM"),_=l("QibW"),G=l("6GKC"),K=l("dUAH"),X=["automcomplete"];function Q(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.description),x.Cb(1),x.Tc(" ",i.description," ")}}function J(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.description),x.Cb(1),x.Tc(" ",i.description," ")}}function W(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please select Utility Type"),x.Sb())}function Y(t,e){if(1&t){var i=x.Ub();x.Tb(0,"mat-form-field",10),x.Tb(1,"mat-label"),x.Rc(2,"Utility Type"),x.Sb(),x.Tb(3,"mat-select",42),x.bc("selectionChange",(function(t){return x.Ec(i),x.fc().selectUtilityType(t)}))("ngModelChange",(function(t){return x.Ec(i),x.fc().utilityType=t})),x.Tb(4,"mat-option",14),x.Rc(5,"----Select----"),x.Sb(),x.Pc(6,J,2,2,"mat-option",15),x.Sb(),x.Ob(7,"app-show-errors",12),x.Pc(8,W,2,0,"mat-hint",23),x.Sb()}if(2&t){var a=x.fc();x.Cb(3),x.mc("ngModel",a.utilityType),x.Cb(1),x.mc("value",0),x.Cb(2),x.mc("ngForOf",a.metadataUtilityTypes),x.Cb(1),x.mc("ctrl",a.form.get("utilityTypeId")),x.Cb(1),x.mc("ngIf","Tariff"==a.calculationType)}}function Z(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.id),x.Cb(1),x.Tc(" ",i.description," ")}}function tt(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please enter Position"),x.Sb())}function et(t,e){if(1&t&&(x.Tb(0,"mat-hint",43),x.Rc(1),x.Sb()),2&t){var i=x.fc();x.Cb(1),x.Sc(i.duplicatePosition)}}function it(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.description),x.Cb(1),x.Tc(" ",i.description," ")}}function at(t,e){if(1&t){var i=x.Ub();x.Tb(0,"div",44),x.Tb(1,"mat-checkbox",45),x.bc("change",(function(t){return x.Ec(i),x.fc().enableMeasuringUnitCheckChanged(t)})),x.Rc(2," Measurement Unit in TH "),x.Sb(),x.Sb()}}function ot(t,e){if(1&t){var i=x.Ub();x.Tb(0,"div",47),x.Tb(1,"mat-checkbox",48),x.bc("change",(function(t){return x.Ec(i),x.fc(2).enableFormulaCheckChanged(t)})),x.Rc(2," * Configure the Formula Based on the Requirement "),x.Sb(),x.Sb()}}function nt(t,e){if(1&t&&(x.Tb(0,"div",17),x.Tb(1,"mat-label",35),x.Rc(2,"Bill Line Formula"),x.Sb(),x.Pc(3,ot,3,0,"div",46),x.Sb()),2&t){var i=x.fc();x.Cb(3),x.mc("ngIf","Consumption Charge"!=i.headType&&""!=i.headType)}}function lt(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.tariffName),x.Cb(1),x.Tc(" ",i.tariffName," ")}}function rt(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please select Tariff"),x.Sb())}function st(t,e){if(1&t){var i=x.Ub();x.Tb(0,"div",49),x.Tb(1,"mat-radio-button",50),x.bc("click",(function(){return x.Ec(i),x.fc().getConsumptionCalculation("Tariff")})),x.Rc(2," Calculation Based on Tariff"),x.Sb(),x.Tb(3,"mat-form-field",51),x.Tb(4,"mat-label"),x.Rc(5,"Tariff"),x.Sb(),x.Tb(6,"input",52),x.bc("ngModelChange",(function(t){return x.Ec(i),x.fc().tariffName=t})),x.Sb(),x.Tb(7,"mat-autocomplete",26,53),x.bc("optionSelected",(function(t){return x.Ec(i),x.fc().selectTariff(t)})),x.Pc(9,lt,2,2,"mat-option",15),x.Sb(),x.Ob(10,"app-show-errors",12),x.Pc(11,rt,2,0,"mat-hint",23),x.Sb(),x.Sb()}if(2&t){var a=x.Ac(8),o=x.fc();x.Cb(1),x.mc("checked",o.isTariff),x.Cb(5),x.mc("matAutocomplete",a)("ngModel",o.tariffName),x.Cb(3),x.mc("ngForOf",o.filteredTariffs),x.Cb(1),x.mc("ctrl",o.form.get("tariffId")),x.Cb(1),x.mc("ngIf","Tariff"==o.calculationType)}}function ct(t,e){if(1&t){var i=x.Ub();x.Tb(0,"div",54),x.Tb(1,"mat-radio-button",50),x.bc("click",(function(){return x.Ec(i),x.fc().getConsumptionCalculation("Formula")})),x.Rc(2,"Calculation Based on Formula"),x.Sb(),x.Sb()}if(2&t){var a=x.fc();x.Cb(1),x.mc("checked",a.isFormula)}}function ut(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.description),x.Cb(1),x.Tc(" ",i.description," ")}}function ft(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please select Formula"),x.Sb())}function dt(t,e){if(1&t){var i=x.Ub();x.Tb(0,"mat-form-field",10),x.Tb(1,"mat-label"),x.Rc(2,"Formula Applied On"),x.Sb(),x.Tb(3,"input",56),x.bc("ngModelChange",(function(t){return x.Ec(i),x.fc(2).formulaApplied=t}))("keyup",(function(){return x.Ec(i),x.fc(2).getFilteredFormula()})),x.Sb(),x.Tb(4,"mat-autocomplete",26,57),x.bc("optionSelected",(function(t){return x.Ec(i),x.fc(2).selectBillFormula(t)})),x.Pc(6,ut,2,2,"mat-option",15),x.Sb(),x.Ob(7,"app-show-errors",12),x.Pc(8,ft,2,0,"mat-hint",23),x.Sb()}if(2&t){var a=x.Ac(5),o=x.fc(2);x.Cb(3),x.mc("matAutocomplete",a)("ngModel",o.formulaApplied),x.Cb(3),x.mc("ngForOf",o.filteredBillFormulas),x.Cb(1),x.mc("ctrl",o.form.get("formulaField")),x.Cb(1),x.mc("ngIf","Tariff"!=o.calculationType)}}function mt(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.description),x.Cb(1),x.Tc(" ",i.description," ")}}function ht(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please select Operation"),x.Sb())}function pt(t,e){if(1&t){var i=x.Ub();x.Tb(0,"mat-form-field",10),x.Tb(1,"mat-label"),x.Rc(2,"Operation"),x.Sb(),x.Ob(3,"input",58),x.Tb(4,"mat-autocomplete",26,59),x.bc("optionSelected",(function(t){return x.Ec(i),x.fc(2).selectOperator(t)})),x.Pc(6,mt,2,2,"mat-option",15),x.Sb(),x.Ob(7,"app-show-errors",12),x.Pc(8,ht,2,0,"mat-hint",23),x.Sb()}if(2&t){var a=x.Ac(5),o=x.fc(2);x.Cb(3),x.mc("matAutocomplete",a),x.Cb(3),x.mc("ngForOf",o.filteredOperators),x.Cb(1),x.mc("ctrl",o.form.get("operator")),x.Cb(1),x.mc("ngIf","Tariff"!=o.calculationType)}}function bt(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please enter Amount"),x.Sb())}function gt(t,e){if(1&t&&(x.Tb(0,"div",17),x.Tb(1,"div",9),x.Pc(2,dt,9,5,"mat-form-field",16),x.Pc(3,pt,9,4,"mat-form-field",16),x.Tb(4,"mat-form-field",10),x.Tb(5,"mat-label"),x.Rc(6,"Amount / Value"),x.Sb(),x.Ob(7,"input",55),x.gc(8,"number"),x.Ob(9,"app-show-errors",12),x.Pc(10,bt,2,0,"mat-hint",23),x.Sb(),x.Sb(),x.Sb()),2&t){var i=x.fc();x.Cb(2),x.mc("ngIf","Variable"!=i.headType&&""!=i.headType),x.Cb(1),x.mc("ngIf","Variable"!=i.headType&&""!=i.headType),x.Cb(4),x.mc("ngModel",x.ic(8,5,i.fixedAmount,i.roundFormat)),x.Cb(2),x.mc("ctrl",i.form.get("fixedAmount")),x.Cb(1),x.mc("ngIf","Tariff"!=i.calculationType)}}function yt(t,e){1&t&&(x.Tb(0,"div",65),x.Rc(1,"Days from Bill Date"),x.Sb())}function Ct(t,e){1&t&&(x.Tb(0,"div",65),x.Rc(1,"Days from Bill Due Date "),x.Sb())}function Tt(t,e){if(1&t&&(x.Tb(0,"div",17),x.Tb(1,"mat-label",35),x.Rc(2,"Grace Period"),x.Sb(),x.Tb(3,"div",60),x.Tb(4,"div",61),x.Rc(5,"Applicable after:"),x.Sb(),x.Tb(6,"mat-form-field",62),x.Ob(7,"input",63),x.Sb(),x.Pc(8,yt,2,0,"div",64),x.Pc(9,Ct,2,0,"div",64),x.Sb(),x.Sb()),2&t){var i=x.fc();x.Cb(8),x.mc("ngIf","Late Fee"==i.headType&&"Late Payment Fees"==i.accountHead),x.Cb(1),x.mc("ngIf","Late Fee"!=i.headType||"Late Payment Fees"!=i.accountHead)}}function vt(t,e){if(1&t&&(x.Tb(0,"mat-option",14),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.label),x.Cb(1),x.Tc(" ",i.label," ")}}function St(t,e){1&t&&(x.Tb(0,"mat-hint"),x.Rc(1,"Please Discount type"),x.Sb())}function Ft(t,e){if(1&t&&(x.Tb(0,"mat-form-field",10),x.Tb(1,"mat-label"),x.Rc(2,"Discount type"),x.Sb(),x.Tb(3,"mat-select",66),x.Pc(4,vt,2,2,"mat-option",15),x.Sb(),x.Ob(5,"app-show-errors",12),x.Pc(6,St,2,0,"mat-hint",23),x.Sb()),2&t){var i=x.fc();x.Cb(4),x.mc("ngForOf",i.metadataDiscountTypes),x.Cb(1),x.mc("ctrl",i.form.get("discountType")),x.Cb(1),x.mc("ngIf",i.isDiscount)}}function xt(t,e){if(1&t&&(x.Tb(0,"mat-form-field",10),x.Tb(1,"mat-label"),x.Rc(2,"Amount / Value"),x.Sb(),x.Ob(3,"input",67),x.gc(4,"noComma"),x.gc(5,"number"),x.Sb()),2&t){var i=x.fc();x.Cb(3),x.mc("ngModel",x.hc(4,1,x.ic(5,3,i.discountAmount,i.roundFormat)))}}function Pt(t,e){1&t&&(x.Tb(0,"mat-hint",68),x.Rc(1,"Tax Settings not mapped in Bill Settings."),x.Sb())}function kt(t,e){if(1&t&&(x.Tb(0,"button",69),x.Rc(1,"CREATE BILL LINE"),x.Sb()),2&t){var i=x.fc();x.mc("disabled",!i.form.valid||0==i.selectedAccountNumber||""!=i.duplicatePosition)}}function At(t,e){if(1&t&&(x.Tb(0,"button",69),x.Rc(1,"UPDATE BILL LINE"),x.Sb()),2&t){var i=x.fc();x.mc("disabled",!i.form.valid||0==i.selectedAccountNumber||""!=i.duplicatePosition)}}var It,Nt=((It=function(){function t(e,i,o,n,l,r,s){a(this,t),this.defaults=e,this.dialogRef=i,this.fb=o,this.masterService=n,this.billHeadService=l,this.dialog=r,this.cookieService=s,this.accountHead="",this.headType="",this.tariffName="",this.formulaApplied="",this.mode="create",this.VATExist=!1,this.isDiscount=!1,this.isCancel=!1,this.isCustomDays=!1,this.metadataDiscountTypes=[{label:"Fixed",value:1},{label:"Percentage",value:2}],this.isConsumptionCharge=!1,this.isTariff=!1,this.isFormula=!1,this.utilityType="",this.duplicatePosition="",this.isMeasuringUnitTH=!1,this.isBillSettingClientMapped=!1,this.fixedAmount=0,this.discountAmount=0,this.currency=Object(O.e)("Currency"),this.roundFormat=Object(O.e)("RoundOff"),i.disableClose=!0}return n(t,[{key:"ngOnInit",value:function(){var t=this;this.defaults?(this.mode="update",this.selectedAccountNumber=this.defaults.accountNumber,this.isMeasuringUnitTH=2==this.defaults.measuringUnitId,this.utilityType=this.defaults.utilityType,this.accountHead=this.defaults.accountNumberName,this.headType=this.defaults.headType,this.fixedAmount=this.defaults.fixedAmount,this.discountAmount=this.defaults.discountAmount):this.defaults=new C({}),this.clientId=parseInt(this.cookieService.get("globalClientId")),this.masterService.getSystemMasterdata(25,0).subscribe((function(e){e=e.filter((function(t){return"Security Deposit"!=t.description})),t.metadataBillHeadTypes=e,t.filteredBillHeadTypes=e})),this.masterService.getSystemMasterdata(16,0).subscribe((function(e){t.metadataUtilityTypes=e,t.filteredUtilityTypes=e})),this.masterService.getSystemMasterdata(53,0).subscribe((function(e){t.metadataBillFormulas=e,t.filteredBillFormulas=e,t.filteredFormula=e,t.getBillFormula()})),this.masterService.getSystemMasterdata(54,0).subscribe((function(e){t.metadataOperators=e,t.filteredOperators=e})),this.getBillingLedgers(),this.masterService.getSystemMasterdata(4,0).subscribe((function(e){t.metadataContractTypes=t.filteredContractTypes=e})),this.form=this.fb.group({id:[this.defaults.id||0],accountHeadName:[this.defaults.accountHeadName||"",c.y.required],accountHeadType:[this.defaults.accountHeadType||"",c.y.required],headType:[this.defaults.headType||"",c.y.required],fixedAmount:[this.defaults.fixedAmount||"",c.y.required],accountNumber:[this.defaults.accountNumber||"",c.y.required],utilityTypeId:[this.defaults.utilityTypeId||""],utilityType:[this.defaults.utilityType||""],contractType:[this.defaults.contractType||"",c.y.required],contractTypeId:[this.defaults.contractTypeId||"0",c.y.required],formulaField:[this.defaults.formulaField||""],formulaFieldName:[this.defaults.formulaFieldName||""],operator:[this.defaults.operator||""],operatorName:[this.defaults.operatorName||""],tariffId:[this.defaults.tariffId||""],tariff:[this.defaults.tariff||""],noOfDays:[this.defaults.noOfDays||0],position:[this.defaults.position||"",c.y.required],MeasuringUnitId:[2==this.defaults.measuringUnitId],isVAT:[this.defaults.isVAT||!1],isDiscount:[this.defaults.isDiscount||!1],isProportional:[this.defaults.isProportional||!1],discountAmount:[this.defaults.discountAmount||""],discountType:[this.defaults.discountType||""],isTariff:[this.defaults.tariffId>0],isFormula:[""!=this.defaults.formulaFieldName],isEnableFormula:[""!=this.defaults.formulaFieldName&&"Consumption Charge"!=this.defaults.headType&&"Variable"!=this.defaults.headType&&""!=this.defaults.headType]}),"create"==this.mode&&this.getNextPosition(),this.billHeadService.getBillSettingClientMapping(this.clientId).subscribe((function(e){t.isBillSettingClientMapped=e,0==t.isBillSettingClientMapped?t.form.controls.isVAT.disable():t.form.controls.isVAT.enable()})),this.defaults&&this.defaults.tariffId>0&&(this.isTariff=!0),this.defaults&&""!=this.defaults.formulaFieldName&&(this.isFormula=!0,this.formulaApplied=this.defaults.formulaFieldName),this.defaults&&this.defaults.isVAT&&(this.VATExist=this.defaults.isVAT),this.defaults&&this.defaults.isDiscount&&(this.isDiscount=this.defaults.isDiscount),this.selectBillFormula(null,this.defaults.formulaFieldName),"update"===this.mode&&"Consumption Charge"===this.defaults.headType&&(this.isConsumptionCharge=!0,this.getTariffs(this.defaults.utilityTypeId,this.clientId),this.form.controls.tariffId.setValue(this.defaults.tariffId),this.tariffName=this.defaults.tariff),this.selectBillHeadType(null,this.defaults.headType),this.utilityType=this.defaults.utilityType,this.form.controls.formulaFieldName.valueChanges.subscribe((function(e){t.filteredBillFormulas=t.filterBillFormula(e)})),this.form.controls.operatorName.valueChanges.subscribe((function(e){t.filteredOperators=t.filterOperator(e)})),this.form.controls.tariff.valueChanges.subscribe((function(e){t.filteredTariffs=t.filterTariff(e)})),this.getEnableFormControls(),this.getBillHeads()}},{key:"getBillingLedgers",value:function(){var t=this;this.masterService.getUserMasterdata(56,149).subscribe((function(e){t.metadataBillingLedger=e}))}},{key:"getBillFormula",value:function(){this.metadataBillFormulas&&(""!=this.headType&&"Late Fee"==this.headType?("Bill Due Days"!=this.formulaApplied&&"Penalty Date"!=this.formulaApplied&&"Custom Days"!=this.formulaApplied&&(this.formulaApplied=""),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas.filter((function(t){return"Bill Due Days"==t.description||"Penalty Date"==t.description||"Custom Days"==t.description}))):"Security Deposit"==this.headType?("Security Deposit"!=this.formulaApplied&&(this.formulaApplied=""),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas.filter((function(t){return"Security Deposit"==t.description}))):"Bill Charge"!=this.headType&&"Late Fee"!=this.headType||("GrandTotal"!=this.formulaApplied&&(this.formulaApplied=""),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas.filter((function(t){return"GrandTotal"==t.description}))))}},{key:"getFilteredBillHeadType",value:function(){}},{key:"getFilteredUtilityTypes",value:function(){this.filteredUtilityTypes=this.filterUtilityTypes(this.form.controls.utilityType.value)}},{key:"filterBillHeadTypes",value:function(t){return""==t?(this.selectBillHeadType(null,""),this.metadataBillHeadTypes):this.metadataBillHeadTypes.filter((function(e){return 0===e.description.toLowerCase().indexOf(t.toLowerCase())}))}},{key:"filterUtilityTypes",value:function(t){if(""==t&&this.selectUtilityType(null,""),this.metadataUtilityTypes)return this.metadataUtilityTypes.filter((function(e){return 0===e.description.toLowerCase().indexOf(t.toLowerCase())}))}},{key:"filterBillFormula",value:function(t){if(this.filteredFormula)return this.filteredFormula.filter((function(e){return 0===e.description.toLowerCase().indexOf(t.toLowerCase())}))}},{key:"getFilteredFormula",value:function(){this.filteredBillFormulas=this.filterBillFormula(this.form.get("formulaFieldName").value)}},{key:"filterOperator",value:function(t){return""==t?this.metadataOperators:this.metadataOperators?this.metadataOperators.filter((function(e){return 0===e.description.toLowerCase().indexOf(t.toLowerCase())})):void 0}},{key:"filterTariff",value:function(t){if(""==t&&this.form.controls.tariffId.setValue(0),this.metadatatariffs)return this.metadatatariffs.filter((function(e){return 0===e.tariffName.toLowerCase().indexOf(t.toLowerCase())}))}},{key:"filterContractType",value:function(t){return""==t?this.metadataContractTypes:this.metadataContractTypes?this.metadataContractTypes.filter((function(e){return 0===e.description.toLowerCase().indexOf(t.toLowerCase())})):void 0}},{key:"getEnableFormControls",value:function(){var t=this.form.get("isEnableFormula").value;this.enableDisableControls(t)}},{key:"getHeadTypes",value:function(){this.filteredBillHeadTypes=this.metadataBillHeadTypes}},{key:"getBillHeads",value:function(){var t=this;this.clientId=parseInt(this.cookieService.get("globalClientId")),this.billHeadService.getBillHeads(this.clientId).subscribe({next:function(e){t.metedataBillLines=e.map((function(t){return new C(t)}))},error:function(t){}})}},{key:"clear",value:function(t){var e=this;this.form.get(t).setValue(""),setTimeout((function(){e.autocomplete.openPanel()}))}},{key:"save",value:function(){var t=this;if(this.isCancel){this.isCancel=!1;var e=!1;this.form.touched&&(e=!0),this.dialog.open(I.a,{data:{label:e?"Unsaved data will be lost, Are you sure you want to Cancel?":"Are you sure you want to Cancel?",selected:!1}}).afterClosed().subscribe((function(e){e&&t.dialogRef.close()}))}else"create"===this.mode?this.createBillHead():"update"===this.mode&&this.updateBillHead()}},{key:"createBillHead",value:function(){var t;Object.assign(this.defaults,this.form.value),this.defaults.position=parseInt(null!==(t=this.form.controls.position.value)&&void 0!==t?t:0),"All"===this.form.controls.contractType.value&&(this.defaults.contractTypeId=0),""==this.form.controls.utilityType.value&&(this.defaults.utilityTypeId=0),""==this.form.controls.formulaFieldName.value&&(this.defaults.formulaField=0),""==this.form.controls.operatorName.value&&(this.defaults.operator=0),this.isTariff||(this.defaults.tariffId=0),!this.isFormula&&this.isConsumptionCharge&&(this.defaults.formulaField=0,this.defaults.operator=0,this.defaults.fixedAmount=0),"Security Deposit"==this.formulaApplied&&(this.defaults.operator=0,this.defaults.fixedAmount=0),this.defaults.measuringUnitId="Consumption Charge"==this.headType&&"BTU"==this.utilityType?1==this.isMeasuringUnitTH?2:1:0,this.defaults.noOfDays=""==this.form.controls.noOfDays.value?0:this.form.controls.noOfDays.value,this.defaults.discountAmount=parseFloat(this.defaults.discountAmount.toString()),this.defaults.fixedAmount=parseFloat(this.defaults.fixedAmount.toString()),this.defaults.clientId=parseInt(this.cookieService.get("globalClientId")),this.defaults.accountNumber=this.selectedAccountNumber,this.isCancel?this.dialogRef.close():this.dialogRef.close(new C(this.defaults))}},{key:"updateBillHead",value:function(){var t=this;Object.assign(this.defaults,this.form.value),"All"===this.form.controls.contractType.value&&(this.defaults.contractTypeId=0),""==this.form.controls.utilityType.value?this.defaults.utilityTypeId=0:this.metadataUtilityTypes.find((function(e){t.utilityType==e.description&&(t.defaults.utilityTypeId=e.id)})),""==this.form.controls.formulaFieldName.value&&(this.defaults.formulaField=0),""==this.form.controls.operatorName.value&&(this.defaults.operator=0),this.isTariff||(this.defaults.tariffId=0),"Security Deposit"==this.formulaApplied&&(this.defaults.operator=0,this.defaults.fixedAmount=0),!this.isFormula&&this.isConsumptionCharge&&(this.defaults.formulaField=0,this.defaults.operator=0,this.defaults.fixedAmount=0),this.defaults.noOfDays=""==this.form.controls.noOfDays.value?0:this.form.controls.noOfDays.value,this.defaults.measuringUnitId="Consumption Charge"==this.headType&&"BTU"==this.utilityType?1==this.isMeasuringUnitTH?2:1:0,this.defaults.discountAmount=parseFloat(this.defaults.discountAmount.toString()),this.defaults.fixedAmount=parseFloat(this.defaults.fixedAmount.toString()),this.defaults.clientId=parseInt(this.cookieService.get("globalClientId")),this.defaults.accountNumber=this.selectedAccountNumber,this.isCancel?this.dialogRef.close():this.dialogRef.close(new C(this.defaults))}},{key:"isCreateMode",value:function(){return"create"===this.mode}},{key:"isUpdateMode",value:function(){return"update"===this.mode}},{key:"selectBillHeadType",value:function(t){var e,i,a,o,n,l,r=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";if(""==s&&this.form.controls.accountHeadType.setValue(""),this.isConsumptionCharge=!1,this.headType="",this.headType=t?t.value:s,"Consumption Charge"!=this.headType&&(null===(e=this.form.controls.utilityType)||void 0===e||e.setValue(""),null===(i=this.form.controls.utilityTypeId)||void 0===i||i.setValue(0),null===(a=this.form.controls.utilityType)||void 0===a||a.clearValidators()),this.metadataBillHeadTypes){var u=this.metadataBillHeadTypes.filter((function(t){return r.headType==t.description}));u&&u.length>0&&this.form.controls.accountHeadType.setValue(u[0].id)}"Consumption Charge"==this.headType?(this.isConsumptionCharge=!0,null===(o=this.form.controls.utilityType)||void 0===o||o.setValidators(c.y.required),null===(n=this.form.controls.utilityType)||void 0===n||n.setErrors({required:!0}),0==this.isTariff&&0==this.isFormula&&(this.isTariff=!0,this.isFormula=!1),this.isTariff?this.getConsumptionCalculation("Tariff"):this.isFormula&&this.getConsumptionCalculation("Formula")):"Formula"==this.headType||"Bill Charge"==this.headType||"Final Bill Fee"==this.headType||"Late Fee"==this.headType||"Security Deposit"==this.headType?("Late Fee"==this.headType&&(this.form.get("isEnableFormula").setValue(!0),this.enableFormulaCheckChanged(null)),this.getConsumptionCalculation("Formula")):(this.isConsumptionCharge=!1,this.getConsumptionCalculation("")),"Consumption Charge"!=this.headType&&this.selectUtilityType(null),this.filteredBillFormulas=this.filteredFormula=this.metadataBillFormulas,this.getBillFormula(),1==this.isFormula&&this.selectBillFormula(null,this.form.controls.formulaFieldName.value),this.getLateFeeValidation(),this.getEnableFormControls(),"Variable"==this.headType&&(this.form.controls.fixedAmount.setValidators([c.y.required]),this.form.controls.fixedAmount.updateValueAndValidity()),null===(l=this.form.controls.utilityType)||void 0===l||l.updateValueAndValidity()}},{key:"getLateFeeValidation",value:function(){"Late Fee"==this.headType||"Custom Days"==this.formulaApplied?this.form.controls.noOfDays.setValidators([c.y.required]):(this.form.controls.noOfDays.clearValidators(),this.form.controls.noOfDays.markAsUntouched()),this.form.controls.noOfDays.updateValueAndValidity()}},{key:"selectUtilityType",value:function(t){var e,i,a,o=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";this.metadatatariffs=[],this.filteredTariffs=[],this.form.controls.tariffId.setValue(0),this.form.controls.tariff.setValue(""),this.form.controls.utilityTypeId.setValue(0),this.form.controls.utilityType.setValue(""),this.utilityType=t?0==t.value?"":t.value:n,"Consumption Charge"==this.headType?(null===(e=this.form.controls.utilityType)||void 0===e||e.setValidators(c.y.required),null===(i=this.form.controls.utilityType)||void 0===i||i.setErrors({required:!0})):null===(a=this.form.controls.utilityType)||void 0===a||a.clearValidators(),this.metadataUtilityTypes&&this.metadataUtilityTypes.forEach((function(t){o.utilityType==t.description&&(o.form.controls.utilityTypeId.setValue(t.id),o.form.controls.utilityType.setValue(t.description),o.getTariffs(t.id,o.clientId))}))}},{key:"selectTariff",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";null!=t&&(i=t.option.value),this.metadatatariffs&&this.metadatatariffs.forEach((function(t){i==t.tariffName&&e.form.controls.tariffId.setValue(t.id)}))}},{key:"selectBillFormula",value:function(t){var e=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";t&&(i=t.option.value),"Bill Due Days"==i||"Penalty Date"==i?(this.billHeadService.getGracePeriod(this.clientId,i).subscribe((function(t){e.form.controls.noOfDays.setValue(t)})),this.form.controls.noOfDays.disable()):this.form.controls.noOfDays.enable(),this.metadataBillFormulas&&this.metadataBillFormulas.forEach((function(t){i==t.description&&e.form.controls.formulaField.setValue(t.id)})),this.getLateFeeValidation(),this.setValidatorsForFormulaFields();var a=this.form.get("isEnableFormula").value;a&&"Security Deposit"==this.formulaApplied?(this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0)):a&&"Security Deposit"!=this.formulaApplied&&this.isFormula&&(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1),this.changeFormControlProperties("fixedAmount",null,!1))}},{key:"setValidatorsForFormulaFields",value:function(){var t=this.form.get("isEnableFormula").value;t||1==this.isFormula?this.form.controls.formulaFieldName.setValidators([c.y.required]):this.form.controls.formulaFieldName.clearValidators(),1==t&&"Security Deposit"!=this.formulaApplied||1==this.isFormula?(this.form.controls.operatorName.setValidators([c.y.required]),this.form.controls.fixedAmount.setValidators([c.y.required])):(this.form.controls.operatorName.clearValidators(),this.form.controls.fixedAmount.setValidators([c.y.required])),this.form.controls.formulaFieldName.updateValueAndValidity(),this.form.controls.operatorName.updateValueAndValidity(),this.form.controls.fixedAmount.updateValueAndValidity()}},{key:"selectOperator",value:function(t){var e=this;this.metadataOperators&&this.metadataOperators.forEach((function(i){t.option.value==i.description&&e.form.controls.operator.setValue(i.id)}))}},{key:"getTariffs",value:function(t,e){var i=this;this.billHeadService.getTariffs(t,e).subscribe((function(t){i.metadatatariffs=t,i.filteredTariffs=t}))}},{key:"validateFixedAmount",value:function(){return this.isValid=!0,""!=this.form.get("fixedAmount").value&&this.form.get("fixedAmount").value<=0&&(this.isValid=!1),this.isValid}},{key:"onChangeAccountNumber",value:function(t){if(this.selectedAccountNumber=t,this.accountHead="",this.metadataBillingLedger){var e=this.metadataBillingLedger.find((function(e){return e.id==t}));e&&(this.accountHead=e.description)}}},{key:"toggleVAT",value:function(t){"create"==this.mode&&(this.VATExist=!t)}},{key:"toggleDiscount",value:function(t){t.checked?(this.form.controls.discountType.setValidators([c.y.required]),this.form.controls.discountAmount.setValidators([c.y.required])):(this.form.controls.discountType.clearValidators(),this.form.controls.discountAmount.clearValidators(),this.form.controls.discountType.setValue(""),this.form.controls.discountAmount.setValue(0)),"create"==this.mode&&(this.isDiscount=t.checked)}},{key:"closeDialog",value:function(){this.isCancel=!0}},{key:"getConsumptionCalculation",value:function(t){this.calculationType=t,"Tariff"==t?(this.isTariff=!0,this.isFormula=!1,this.changeFormControlProperties("tariff","update"==this.mode&&0!=this.defaults.tariffId?null:"tariffId",!1),this.changeFormControlProperties("formulaFieldName","formulaField",!0),this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0),this.form.controls.tariff.setValidators([c.y.required])):"Formula"==t?(this.isTariff=!1,this.isFormula=!0,this.changeFormControlProperties("tariff","tariffId",!0),"update"==this.mode&&0!=this.defaults.formulaField?(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1)):(this.changeFormControlProperties("formulaFieldName","formulaField",!1),this.changeFormControlProperties("operatorName","operator",!1)),this.changeFormControlProperties("fixedAmount","update"==this.mode&&0!=this.defaults.fixedAmount?null:"fixedAmount",!1),this.form.controls.formulaFieldName.setValidators([c.y.required]),this.setValidatorsForFormulaFields()):""==t&&(this.isTariff=!1,this.isFormula=!1,this.changeFormControlProperties("tariff","tariffId",!1),this.changeFormControlProperties("formulaFieldName","formulaField",!1),this.changeFormControlProperties("operatorName","operator",!1),this.changeFormControlProperties("fixedAmount","fixedAmount",!1)),this.form.controls.tariff.updateValueAndValidity(),this.form.controls.formulaFieldName.updateValueAndValidity(),this.form.controls.operatorName.updateValueAndValidity(),this.form.controls.fixedAmount.updateValueAndValidity()}},{key:"enableFormulaCheckChanged",value:function(t){var e=!0;null!=t&&(e=t.checked),this.enableDisableControls(e),this.setValidatorsForFormulaFields()}},{key:"changeFormControlProperties",value:function(t,e,i){i?this.form.controls[t].disable():this.form.controls[t].enable(),e&&(this.form.controls[t].setValue(""),this.form.controls[e].setValue(""),this.form.controls[t].clearValidators(),this.form.controls[t].markAsUntouched())}},{key:"enableDisableControls",value:function(t){t||"Consumption Charge"==this.headType?"Consumption Charge"==this.headType&&1==this.isTariff?(this.changeFormControlProperties("formulaFieldName","formulaField",!0),this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0)):t&&"Security Deposit"==this.formulaApplied?(this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount","fixedAmount",!0)):t&&"Security Deposit"!=this.formulaApplied&&this.isFormula?(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1),this.changeFormControlProperties("fixedAmount",null,!1)):(this.changeFormControlProperties("formulaFieldName",null,!1),this.changeFormControlProperties("operatorName",null,!1)):(this.changeFormControlProperties("formulaFieldName","formulaField",!0),this.changeFormControlProperties("operatorName","operator",!0),this.changeFormControlProperties("fixedAmount",null,!1))}},{key:"checkDuplicatePosition",value:function(){var t=this;this.duplicatePosition="";var e=this.form.controls.position.value;0!=e?""!=e&&null!=e&&this.billHeadService.checkForDuplicatePosition(e,this.defaults.id,this.clientId).subscribe((function(e){e&&e>0&&(t.duplicatePosition="Position already exists.")})):this.duplicatePosition="Position cannot be zero."}},{key:"getNextPosition",value:function(){var t=this;this.billHeadService.getNextPosition(this.clientId).subscribe((function(e){e&&e>0&&t.form.controls.position.setValue(e)}))}},{key:"enableMeasuringUnitCheckChanged",value:function(t){this.isMeasuringUnitTH=t.checked}},{key:"close",value:function(){this.dialogRef.close()}},{key:"selectContractType",value:function(t){var e=this;this.metadataContractTypes.forEach((function(i){t.option.value==i.description&&e.form.controls.contractTypeId.setValue(i.id)}))}},{key:"createBillingLedger",value:function(){var t=this;this.dialog.open(N.a,{data:[55,56,149]}).afterClosed().subscribe((function(e){e&&"Success"==e&&t.getBillingLedgers()}))}}]),t}()).id=100,It.\u0275fac=function(t){return new(t||It)(x.Nb(k.a),x.Nb(k.h),x.Nb(c.f),x.Nb(A.a),x.Nb(P),x.Nb(k.b),x.Nb(L.a))},It.\u0275cmp=x.Hb({type:It,selectors:[["fury-billhead-create-update"]],viewQuery:function(t,e){var i;1&t&&x.Vc(X,!0),2&t&&x.zc(i=x.cc())&&(e.autocomplete=i.first)},decls:92,vars:25,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"mat-dlg-content"],[1,"topPadding"],[1,"person"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","20px"],["fxFlex",""],["type","text","formControlName","accountHeadName","maxlength","80","matInput",""],[3,"ctrl"],["formControlName","headType",3,"selectionChange"],[3,"value"],[3,"value",4,"ngFor","ngForOf"],["fxFlex","",4,"ngIf"],[1,"person","topPadding"],[2,"width","80%"],["formControlName","accountNumber",3,"selectionChange"],["type","button","mat-mini-fab","","color","primary",1,"create",2,"height","30px","width","30px","margin-right","0px","margin-left","5px","padding-top","-5px",3,"click"],[2,"height","10px","width","10px","padding-top","-5px","margin-top","-25px","margin-left","-13px"],["type","number","formControlName","position","matInput","",3,"change","keyup"],[4,"ngIf"],["class","duplicate",4,"ngIf"],["matInput","","formControlName","contractType",3,"matAutocomplete"],[3,"optionSelected"],["contractType","matAutocomplete"],["value","All"],["class","formulaLabel","fxFlex","20%",4,"ngIf"],["class","person topPadding",4,"ngIf"],["fxLayout","row","fxLayout.gt-sm","column","class","topPadding",4,"ngIf"],["fxLayout","row","fxLayout.gt-sm","column",4,"ngIf"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","20px",1,"marginRight","topPadding",2,"padding-bottom","10px"],["color","primary","formControlName","isProportional",1,"isProportional"],[1,"subHeading"],["color","primary","formControlName","isVAT",1,"isVAT",3,"change"],["color","primary","formControlName","isDiscount",1,"isVAT",3,"change"],["class","billSettingMapping",4,"ngIf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button","",3,"disabled",4,"ngIf"],["formControlName","utilityType",3,"ngModel","selectionChange","ngModelChange"],[1,"duplicate"],["fxFlex","20%",1,"formulaLabel"],["color","primary","formControlName","MeasuringUnitId",1,"formulaLabel",3,"change"],["class","formulaLabel",4,"ngIf"],[1,"formulaLabel"],["color","primary","formControlName","isEnableFormula",1,"formulaLabel",3,"change"],["fxLayout","row","fxLayout.gt-sm","column",1,"topPadding"],[1,"formulaSubLabel",3,"checked","click"],["fxFlex","",1,"topPadding"],["matInput","","formControlName","tariff",3,"matAutocomplete","ngModel","ngModelChange"],["tariff","matAutocomplete"],["fxLayout","row","fxLayout.gt-sm","column"],["type","textbox","formControlName","fixedAmount","maxlength","7","matInput","","furyValidateDecimalPlacesDirective","",3,"ngModel"],["matInput","","formControlName","formulaFieldName",3,"matAutocomplete","ngModel","ngModelChange","keyup"],["formulaFieldName","matAutocomplete"],["matInput","","formControlName","operatorName",3,"matAutocomplete"],["operatorName","matAutocomplete"],["fxLayout","column","fxLayout.gt-sm","row",1,"topPadding"],[1,"gracePeriodLabelLeft"],["fxFlex","13%"],["type","number","formControlName","noOfDays","maxlength","2","min","0","matInput","","oninput","this.value = \n              !!this.value && Math.abs(this.value) >= 0 ? Math.abs(this.value) : null;javascript: if (this.value.length > this.maxLength) this.value = this.value.slice(0, this.maxLength);if(this.value < 0) this.value = ''"],["class","gracePeriodLabelRight",4,"ngIf"],[1,"gracePeriodLabelRight"],["formControlName","discountType"],["type","textbox","formControlName","discountAmount","matInput","","furyValidateDecimalPlacesDirective","",3,"ngModel"],[1,"billSettingMapping"],["mat-button","",3,"disabled"]],template:function(t,e){if(1&t&&(x.Tb(0,"div",0),x.Tb(1,"mat-toolbar",1),x.Tb(2,"span"),x.Rc(3,"Bill Line"),x.Sb(),x.Ob(4,"span",2),x.Tb(5,"button",3),x.bc("click",(function(){return e.close()})),x.Tb(6,"mat-icon",4),x.Rc(7,"close"),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Tb(8,"form",5),x.bc("ngSubmit",(function(){return e.save()})),x.Tb(9,"mat-dialog-content",6),x.Tb(10,"fury-card"),x.Tb(11,"fury-card-content",7),x.Tb(12,"div",8),x.Tb(13,"div",9),x.Tb(14,"mat-form-field",10),x.Tb(15,"mat-label"),x.Rc(16,"Bill Line Name"),x.Sb(),x.Ob(17,"input",11),x.Ob(18,"app-show-errors",12),x.Tb(19,"mat-hint"),x.Rc(20,"Please enter Bill Line Name"),x.Sb(),x.Sb(),x.Tb(21,"mat-form-field",10),x.Tb(22,"mat-label"),x.Rc(23,"Bill Line Type"),x.Sb(),x.Tb(24,"mat-select",13),x.bc("selectionChange",(function(t){return e.selectBillHeadType(t)})),x.Tb(25,"mat-option",14),x.Rc(26,"----Select----"),x.Sb(),x.Pc(27,Q,2,2,"mat-option",15),x.Sb(),x.Ob(28,"app-show-errors",12),x.Tb(29,"mat-hint"),x.Rc(30,"Please select Bill Line Type"),x.Sb(),x.Sb(),x.Pc(31,Y,9,5,"mat-form-field",16),x.Sb(),x.Sb(),x.Tb(32,"div",17),x.Tb(33,"div",9),x.Tb(34,"div",10),x.Tb(35,"mat-form-field",18),x.Tb(36,"mat-label"),x.Rc(37,"Account Ledger"),x.Sb(),x.Tb(38,"mat-select",19),x.bc("selectionChange",(function(t){return e.onChangeAccountNumber(t.value)})),x.Tb(39,"mat-option",14),x.Rc(40,"----Select----"),x.Sb(),x.Pc(41,Z,2,2,"mat-option",15),x.Sb(),x.Ob(42,"app-show-errors",12),x.Tb(43,"mat-hint"),x.Rc(44,"Please select Account Ledger"),x.Sb(),x.Sb(),x.Tb(45,"button",20),x.bc("click",(function(){return e.createBillingLedger()})),x.Tb(46,"mat-icon",21),x.Rc(47,"add "),x.Sb(),x.Sb(),x.Sb(),x.Tb(48,"mat-form-field",10),x.Tb(49,"mat-label"),x.Rc(50,"Position"),x.Sb(),x.Tb(51,"input",22),x.bc("change",(function(){return e.checkDuplicatePosition()}))("keyup",(function(){return e.checkDuplicatePosition()})),x.Sb(),x.Pc(52,tt,2,0,"mat-hint",23),x.Pc(53,et,2,1,"mat-hint",24),x.Sb(),x.Tb(54,"mat-form-field",10),x.Tb(55,"mat-label"),x.Rc(56,"Contract Type"),x.Sb(),x.Ob(57,"input",25),x.Tb(58,"mat-autocomplete",26,27),x.bc("optionSelected",(function(t){return e.selectContractType(t)})),x.Tb(60,"mat-option",28),x.Rc(61,"All"),x.Sb(),x.Pc(62,it,2,2,"mat-option",15),x.Sb(),x.Ob(63,"app-show-errors",12),x.Tb(64,"mat-hint"),x.Rc(65,"Please select a Contract Type"),x.Sb(),x.Sb(),x.Pc(66,at,3,0,"div",29),x.Sb(),x.Sb(),x.Pc(67,nt,4,1,"div",30),x.Pc(68,st,12,6,"div",31),x.Pc(69,ct,3,1,"div",32),x.Pc(70,gt,11,8,"div",30),x.Pc(71,Tt,10,2,"div",30),x.Tb(72,"div",17),x.Tb(73,"div",33),x.Tb(74,"mat-checkbox",34),x.Rc(75," Prorata"),x.Sb(),x.Sb(),x.Sb(),x.Tb(76,"div",17),x.Tb(77,"mat-label",35),x.Rc(78,"Taxes and Discounts"),x.Sb(),x.Tb(79,"div",33),x.Tb(80,"mat-checkbox",36),x.bc("change",(function(){return e.toggleVAT(e.VATExist)})),x.Rc(81,"Apply Tax "),x.Sb(),x.Tb(82,"mat-checkbox",37),x.bc("change",(function(t){return e.toggleDiscount(t)})),x.Rc(83," Apply Discount"),x.Sb(),x.Pc(84,Ft,7,3,"mat-form-field",16),x.Pc(85,xt,6,6,"mat-form-field",16),x.Sb(),x.Pc(86,Pt,2,0,"mat-hint",38),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Tb(87,"mat-dialog-actions",39),x.Tb(88,"button",40),x.bc("click",(function(){return e.closeDialog()})),x.Rc(89,"CANCEL"),x.Sb(),x.Pc(90,kt,2,1,"button",41),x.Pc(91,At,2,1,"button",41),x.Sb(),x.Sb()),2&t){var i=x.Ac(59);x.Cb(8),x.mc("formGroup",e.form),x.Cb(10),x.mc("ctrl",e.form.get("accountHeadName")),x.Cb(7),x.mc("value",0),x.Cb(2),x.mc("ngForOf",e.metadataBillHeadTypes),x.Cb(1),x.mc("ctrl",e.form.get("accountHeadType")),x.Cb(3),x.mc("ngIf",e.isConsumptionCharge),x.Cb(8),x.mc("value",0),x.Cb(2),x.mc("ngForOf",e.metadataBillingLedger),x.Cb(1),x.mc("ctrl",e.form.get("accountNumber")),x.Cb(10),x.mc("ngIf",""==e.duplicatePosition),x.Cb(1),x.mc("ngIf",""!=e.duplicatePosition),x.Cb(4),x.mc("matAutocomplete",i),x.Cb(5),x.mc("ngForOf",e.filteredContractTypes),x.Cb(1),x.mc("ctrl",null==e.form?null:e.form.get("contractTypeId")),x.Cb(3),x.mc("ngIf","Consumption Charge"==e.headType&&"BTU"==e.utilityType),x.Cb(1),x.mc("ngIf","Variable"!=e.headType&&""!=e.headType&&"Unit Charge"!=e.headType),x.Cb(1),x.mc("ngIf","Consumption Charge"==e.headType),x.Cb(1),x.mc("ngIf","Consumption Charge"==e.headType),x.Cb(1),x.mc("ngIf",""!=e.headType&&"Unit Charge"!=e.headType),x.Cb(1),x.mc("ngIf","Late Fee"==e.headType||"Custom Days"==e.formulaApplied||"Bill Due Days"==e.formulaApplied||"Penalty Date"==e.formulaApplied),x.Cb(13),x.mc("ngIf",null==e.form||null==e.form.controls?null:e.form.controls.isDiscount.value),x.Cb(1),x.mc("ngIf",null==e.form||null==e.form.controls?null:e.form.controls.isDiscount.value),x.Cb(1),x.mc("ngIf",0==e.isBillSettingClientMapped),x.Cb(4),x.mc("ngIf",e.isCreateMode()),x.Cb(1),x.mc("ngIf",e.isUpdateMode())}},directives:[k.i,B.a,w.a,D.a,R.c,c.z,c.r,c.k,k.f,V.a,V.c,M.d,M.e,H.d,M.b,H.h,c.c,U.b,c.q,c.i,c.m,E.a,H.g,j.a,q.n,s.n,s.o,c.u,z.c,z.a,$.a,k.c,M.c,_.a,G.a],pipes:[s.g,K.a],styles:[".marginRight[_ngcontent-%COMP%]{margin-right:36%}.isVAT[_ngcontent-%COMP%]{align-self:center;margin-left:0;text-align:center}.gracePeriodLabelLeft[_ngcontent-%COMP%]{padding-top:30px;margin-right:10px}.gracePeriodLabelRight[_ngcontent-%COMP%]{padding-top:30px;margin-left:10px}.formulaLabel[_ngcontent-%COMP%], .formulaSubLabel[_ngcontent-%COMP%]{clear:both;padding-top:10px}.formulaSubLabel[_ngcontent-%COMP%]{font-weight:500}.topPadding[_ngcontent-%COMP%]{padding-top:12px}.heading[_ngcontent-%COMP%]{padding-left:25px}.heading[_ngcontent-%COMP%], .subHeading[_ngcontent-%COMP%]{font-size:18px;font-weight:700}.duplicate[_ngcontent-%COMP%]{color:red}.task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.billSettingMapping[_ngcontent-%COMP%]{font-size:smaller}"]}),It),Ot=l("nR/4"),Lt=l("dNgK"),Bt=l("f0Cb"),wt=["allClientsSelected"];function Dt(t,e){if(1&t&&(x.Tb(0,"mat-option",22),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.mc("value",i.clientName),x.Cb(1),x.Sc(i.clientName)}}function Rt(t,e){if(1&t){var i=x.Ub();x.Tb(0,"mat-option",16),x.bc("click",(function(){x.Ec(i);var t=x.fc(),e=x.Ac(23);return t.toggleClientPerOne(e.viewValue)})),x.Rc(1),x.Sb()}if(2&t){var a=e.$implicit;x.mc("value",a.clientId),x.Cb(1),x.Tc(" ",a.clientName," ")}}var Vt,Mt=((Vt=function(){function i(t,e,o,n,l,r){a(this,i),this.fb=t,this.billHeadService=e,this.snackbar=o,this.dialogRef=n,this.dialog=l,this.cookieService=r,this.isCancel=!1,this.lstClients=[],this.lstFilterClients=[],this.selectedClients=[],n.disableClose=!0}return n(i,[{key:"ngOnInit",value:function(){var t=this;this.clientId=this.cookieService.get("globalClientId"),this.lstClients=this.lstFilterClients=JSON.parse(localStorage.getItem("userClients")),this.clientId&&(this.lstClients=this.lstFilterClients.filter((function(e){return e.clientId!=Number(t.clientId)}))),this.form=this.fb.group({fromClient:[""],clients:[""]}),this.lstFilterClients.find((function(e){e.clientId==t.clientId&&(t.fromClientName=e.clientName,t.selectCopyFromClient(t.fromClientName))}))}},{key:"selectCopyFromClient",value:function(t){var e=this;this.selectedClients=[];var i=this.lstFilterClients.find((function(e){return e.clientName==t}));this.clientId=i.clientId,this.fromClientName=i.clientName,this.clientId&&(this.lstClients=this.lstFilterClients.filter((function(t){return t.clientId!=Number(e.clientId)})))}},{key:"toggleClientsAllSelection",value:function(){this.form.controls.clients.patchValue(this.allClientsSelected.selected?[].concat(t(this.lstClients.map((function(t){return t.clientId}))),[0]):[])}},{key:"toggleClientPerOne",value:function(t){if(this.allClientsSelected.selected)return this.allClientsSelected.deselect(),!1;this.form.controls.clients.value.length==this.lstClients.length&&this.allClientsSelected.select()}},{key:"save",value:function(){var t=this;if(this.isCancel)return this.isCancel=!1,void this.dialog.open(I.a,{data:{label:"Are you sure you want to Cancel?",selected:!1}}).afterClosed().subscribe((function(e){e&&t.dialogRef.close()}));this.dialog.open(Ot.a,{autoFocus:!0,data:[{label:"Remove Existing & Copy whole Configuration from Beginning",value:1},{label:"Keep Existing & Copy Only New Configuration",value:2},{label:"Copy Only New & Modify existing Configuration",value:3}]}).afterClosed().subscribe((function(e){if(e&&t.selectedClients&&t.selectedClients.length){var i=[];t.selectedClients.forEach((function(a){0!=a&&i.push({fromClientId:Number(t.clientId),toClientId:Number(a),type:Number(e.value)})})),t.billHeadService.copyBillHead(i).subscribe({next:function(e){e?t.notificationMessage("Bill Line copied successfully.","green-snackbar"):t.notificationMessage("Bill Line copy failed","red-snackbar"),t.dialogRef.close()},error:function(e){t.notificationMessage("Bill Line copy failed","red-snackbar")}})}}))}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"search",value:function(t){var e=this.select(t);this.lstClients=e}},{key:"select",value:function(t){var i=[];if(t){var a,o=function(t,i){var a;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(a=e(t))||i&&t&&"number"==typeof t.length){a&&(t=a);var o=0,n=function(){};return{s:n,n:function(){return o>=t.length?{done:!0}:{done:!1,value:t[o++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,r=!0,s=!1;return{s:function(){a=t[Symbol.iterator]()},n:function(){var t=a.next();return r=t.done,t},e:function(t){s=!0,l=t},f:function(){try{r||null==a.return||a.return()}finally{if(s)throw l}}}}(this.lstFilterClients);try{for(o.s();!(a=o.n()).done;){var n=a.value;n.clientName.toLowerCase().indexOf(t)>-1&&i.push(n)}}catch(l){o.e(l)}finally{o.f()}}else i=this.lstFilterClients;return i}},{key:"close",value:function(){this.dialogRef.close()}},{key:"closeDialog",value:function(){this.isCancel=!0}}]),i}()).\u0275fac=function(t){return new(t||Vt)(x.Nb(c.f),x.Nb(P),x.Nb(Lt.b),x.Nb(k.h),x.Nb(k.b),x.Nb(L.a))},Vt.\u0275cmp=x.Hb({type:Vt,selectors:[["fury-copy-bill-lines"]],viewQuery:function(t,e){var i;1&t&&x.Vc(wt,!0),2&t&&x.zc(i=x.cc())&&(e.allClientsSelected=i.first)},decls:31,vars:9,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"mat-dlg-content"],[1,"padding-top"],[1,"person"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","48px"],["fxFlex",""],["formControlName","fromClient","placeholder","Copy From Client",3,"ngModel","disabled","ngModelChange","selectionChange"],[3,"value",4,"ngFor","ngForOf"],["multiple","","placeholder","Copy To Client",1,"multiSelectCustom",3,"ngModel","formControl","ngModelChange"],["matInput","","focused","'true'","type","text","autocomplete","off","placeholder","Search",1,"myInput","mySelect",3,"keyup"],["myInput",""],[3,"value","click"],["allClientsSelected",""],[3,"value","click",4,"ngFor","ngForOf"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button","",3,"disabled"],[3,"value"]],template:function(t,e){1&t&&(x.Tb(0,"h4",0),x.Tb(1,"mat-toolbar",1),x.Tb(2,"span"),x.Rc(3,"Copy Bill Line"),x.Sb(),x.Ob(4,"span",2),x.Tb(5,"button",3),x.bc("click",(function(){return e.close()})),x.Tb(6,"mat-icon",4),x.Rc(7,"close"),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Tb(8,"form",5),x.bc("ngSubmit",(function(){return e.save()})),x.Tb(9,"mat-dialog-content",6),x.Tb(10,"fury-card"),x.Tb(11,"fury-card-content",7),x.Tb(12,"div",8),x.Tb(13,"div",9),x.Tb(14,"mat-form-field",10),x.Tb(15,"mat-select",11),x.bc("ngModelChange",(function(t){return e.fromClientName=t}))("selectionChange",(function(t){return e.selectCopyFromClient(t.value)})),x.Pc(16,Dt,2,2,"mat-option",12),x.Sb(),x.Sb(),x.Tb(17,"mat-form-field",10),x.Tb(18,"mat-select",13),x.bc("ngModelChange",(function(t){return e.selectedClients=t})),x.Tb(19,"input",14,15),x.bc("keyup",(function(t){return e.search(t.target.value)})),x.Sb(),x.Ob(21,"mat-divider"),x.Tb(22,"mat-option",16,17),x.bc("click",(function(){return e.toggleClientsAllSelection()})),x.Rc(24,"Select All"),x.Sb(),x.Pc(25,Rt,2,2,"mat-option",18),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Sb(),x.Tb(26,"mat-dialog-actions",19),x.Tb(27,"button",20),x.bc("click",(function(){return e.closeDialog()})),x.Rc(28,"CANCEL"),x.Sb(),x.Tb(29,"button",21),x.Rc(30,"PROCEED"),x.Sb(),x.Sb(),x.Sb()),2&t&&(x.Cb(8),x.mc("formGroup",e.form),x.Cb(7),x.mc("ngModel",e.fromClientName)("disabled",!0),x.Cb(1),x.mc("ngForOf",e.lstFilterClients),x.Cb(2),x.mc("ngModel",e.selectedClients)("formControl",e.form.controls.clients),x.Cb(4),x.mc("value",0),x.Cb(3),x.mc("ngForOf",e.lstClients),x.Cb(4),x.mc("disabled",0==(null==e.selectedClients?null:e.selectedClients.length)))},directives:[k.i,B.a,w.a,D.a,R.c,c.z,c.r,c.k,k.f,V.a,V.c,M.d,M.e,H.d,M.b,j.a,c.q,c.i,s.n,c.h,U.b,Bt.a,q.n,k.c,M.c],styles:[".myInput[_ngcontent-%COMP%]{padding:10px!important}.task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.buttonStyle[_ngcontent-%COMP%]{background:#3f51b5;color:#fff;padding-right:10px}"]}),Vt),Ht=l("tB66"),Ut=l("a8hA"),Et=l("xBcV"),jt=l("Hbgg"),qt=l("rnAf"),zt=l("rvYj"),$t=l("a+RD"),_t=l("Qu3c"),Gt=l("znSr"),Kt=l("STbY");function Xt(t,e){if(1&t&&(x.Tb(0,"th",21),x.Rc(1),x.Sb()),2&t){var i=x.fc(2).$implicit;x.Cb(1),x.Sc(i.name)}}function Qt(t,e){if(1&t&&(x.Tb(0,"td",22),x.Rc(1),x.Sb()),2&t){var i=e.$implicit,a=x.fc(2).$implicit;x.mc("ngStyle",a.columnAlign),x.Cb(1),x.Tc(" ",i[a.property]," ")}}function Jt(t,e){if(1&t&&(x.Rb(0,18),x.Pc(1,Xt,2,1,"th",19),x.Pc(2,Qt,2,2,"td",20),x.Qb()),2&t){var i=x.fc().$implicit;x.mc("matColumnDef",i.property)}}function Wt(t,e){if(1&t&&(x.Rb(0),x.Pc(1,Jt,3,1,"ng-container",17),x.Qb()),2&t){var i=e.$implicit;x.Cb(1),x.mc("ngIf",i.isModelProperty)}}function Yt(t,e){1&t&&(x.Tb(0,"th",23),x.Rc(1,"FIXED AMOUNT"),x.Sb())}function Zt(t,e){if(1&t&&(x.Tb(0,"td",24),x.Rc(1),x.Sb()),2&t){var i=e.$implicit;x.Cb(1),x.Tc(" ",i.fixedAmountLocal," ")}}function te(t,e){1&t&&x.Ob(0,"th",25)}function ee(t,e){if(1&t){var i=x.Ub();x.Tb(0,"td",26),x.Tb(1,"button",27),x.bc("click",(function(t){return x.Ec(i),t.stopPropagation()})),x.Tb(2,"mat-icon"),x.Rc(3,"more_horiz"),x.Sb(),x.Sb(),x.Tb(4,"mat-menu",28,29),x.Tb(6,"button",30),x.bc("click",(function(){x.Ec(i);var t=e.$implicit;return x.fc().updateBillHead(t)})),x.Tb(7,"span"),x.Rc(8,"Modify"),x.Sb(),x.Sb(),x.Tb(9,"button",30),x.bc("click",(function(){x.Ec(i);var t=e.$implicit;return x.fc().deleteBillHead(t)})),x.Tb(10,"span"),x.Rc(11,"Delete"),x.Sb(),x.Sb(),x.Sb(),x.Sb()}if(2&t){var a=x.Ac(5);x.Cb(1),x.mc("matMenuTriggerFor",a)}}function ie(t,e){1&t&&x.Ob(0,"tr",31)}function ae(t,e){if(1&t){var i=x.Ub();x.Tb(0,"tr",32),x.bc("click",(function(){x.Ec(i);var t=e.$implicit;return x.fc().updateBillHead(t)})),x.Sb()}}var oe,ne,le,re,se=function(){return[]},ce=[{path:"",component:(oe=function(){function t(e,i,o,n,l,r,s,c){var u,f;a(this,t),this.dialog=e,this.snackbar=i,this.date=o,this.currencyPipe=n,this.billHeadService=l,this.clientSelectionService=r,this.cookieService=s,this.envService=c,this.mode="create",this.dateFormat=Object(O.e)("DateFormat"),this.currency="",this.roundFormat="",this.subject$=new g.a(1),this.data$=this.subject$.asObservable(),this.columns=[{name:"Bill Line Name",property:"accountHeadName",visible:!0,isModelProperty:!0},{name:"Bill Line Type",property:"headType",visible:!0,isModelProperty:!0},{name:"Contract Type",property:"contractType",visible:!0,isModelProperty:!0},{name:"Position",property:"position",visible:!0,isModelProperty:!0},{name:"Fixed Amount",property:"fixedAmountLocal",visible:!0,isModelProperty:!1},{name:"Actions",property:"actions",visible:!0}],this.pageSize=8,this.currency=null!==(u=Object(O.e)("Currency"))&&void 0!==u?u:c.currencyFormat,this.roundFormat=null!==(f=Object(O.e)("RoundOff"))&&void 0!==f?f:c.roundOffFormat}return n(t,[{key:"ngOnInit",value:function(){this.clientSelectionService.setIsClientVisible(!0),this.getBillHeads()}},{key:"ngAfterViewInit",value:function(){this.dataSource.paginator=this.paginator,this.dataSource.sort=this.sort}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"copyBillLines",value:function(){this.dialog.open(Mt).afterClosed().subscribe()}},{key:"createBillHead",value:function(){var t=this;this.dialog.open(Nt).afterClosed().subscribe((function(e){e&&t.billHeadService.createBillHead(e).subscribe((function(e){t.snackbar.open("Bill Line created successfully.",null,{duration:5e3,verticalPosition:"top",horizontalPosition:"center",panelClass:["green-snackbar"]}),t.getBillHeads()}))})),this.getBillHeads()}},{key:"updateBillHead",value:function(t){var e=this;this.dialog.open(Nt,{data:t}).afterClosed().subscribe((function(t){t&&e.billHeadService.updateBillHeadById(t.id,t).subscribe((function(t){e.snackbar.open("Bill Line updated successfully.",null,{duration:5e3,verticalPosition:"top",horizontalPosition:"center",panelClass:["green-snackbar"]}),e.getBillHeads()}))})),this.getBillHeads()}},{key:"deleteBillHead",value:function(t){var e=this;this.dialog.open(Ht.a).afterClosed().subscribe((function(i){i&&t&&e.billHeadService.deleteBillHeadById(t.id).subscribe({next:function(t){e.snackbar.open("Bill Line deleted successfully.",null,{duration:5e3,verticalPosition:"top",horizontalPosition:"center",panelClass:["green-snackbar"]}),e.getBillHeads()},error:function(t){e.notificationMessage("Bill Line deletion failed.","red-snackbar")}})}))}},{key:"onFilterChange",value:function(t){this.dataSource&&(t=(t=t.trim()).toLowerCase(),this.dataSource.filter=t)}},{key:"getBillHeads",value:function(){var t=this;this.clientId=parseInt(this.cookieService.get("globalClientId")),this.billHeadService.getBillHeads(this.clientId).subscribe((function(e){e=e.map((function(t){return new C(t)})),t.dateFormat=Object(O.e)("DateFormat"),t.roundFormat=Object(O.e)("RoundOff"),t.currency=Object(O.e)("Currency"),e.forEach((function(e){e.fixedAmountLocal=t.currencyPipe.transform(e.fixedAmount,t.currency.toString(),!0,t.roundFormat),e.discountAmountLocal=t.currencyPipe.transform(e.discountAmount,t.currency.toString(),!0,t.roundFormat)})),t.subject$.next(e)})),this.dataSource=new b.k(this.billHeads),this.data$.pipe(Object(y.a)((function(t){return!!t}))).subscribe((function(e){t.billHeads=e,t.dataSource.data=e})),this.ngAfterViewInit()}},{key:"ngOnDestroy",value:function(){}},{key:"content",set:function(t){this.sort=t,this.sort&&(this.dataSource.sort=this.sort)}},{key:"visibleColumns",get:function(){return this.columns.filter((function(t){return t.visible})).map((function(t){return t.property}))}}]),t}(),oe.id=100,oe.\u0275fac=function(t){return new(t||oe)(x.Nb(k.b),x.Nb(Lt.b),x.Nb(s.f),x.Nb(s.d),x.Nb(P),x.Nb(Ut.a),x.Nb(L.a),x.Nb(F.a))},oe.\u0275cmp=x.Hb({type:oe,selectors:[["create-billHead"]],viewQuery:function(t,e){var i;1&t&&(x.Jc(h.a,!0),x.Vc(p.a,!0)),2&t&&(x.zc(i=x.cc())&&(e.paginator=i.first),x.zc(i=x.cc())&&(e.content=i.first))},inputs:{columns:"columns"},decls:23,vars:10,consts:[["mode","card"],["current","Bill Line",3,"crumbs"],["name","Bill Line",3,"columns","filterChange"],[1,"actions"],["matTooltip","Copy","type","button","mat-mini-fab","","color","primary",1,"right-margin",3,"click"],["type","button","mat-mini-fab","","color","primary",1,"left-margin",3,"click"],["mat-table","","matSort","",3,"dataSource"],[4,"ngFor","ngForOf"],["matColumnDef","fixedAmountLocal"],["mat-header-cell","","class","header-align-right",4,"matHeaderCellDef"],["mat-cell","","class","header-align-right",4,"matCellDef"],["matColumnDef","actions"],["class","actions-cell","mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["class","actions-cell","mat-cell","",4,"matCellDef"],["mat-header-row","",4,"matHeaderRowDef"],["class","clickable route-animations-elements","mat-row","",3,"click",4,"matRowDef","matRowDefColumns"],[1,"paginator",3,"pageSize"],[3,"matColumnDef",4,"ngIf"],[3,"matColumnDef"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",3,"ngStyle",4,"matCellDef"],["mat-header-cell","","mat-sort-header",""],["mat-cell","",3,"ngStyle"],["mat-header-cell","",1,"header-align-right"],["mat-cell","",1,"header-align-right"],["mat-header-cell","","mat-sort-header","",1,"actions-cell"],["mat-cell","",1,"actions-cell"],["type","button","mat-icon-button","",3,"matMenuTriggerFor","click"],["yPosition","below","xPosition","before"],["actionsMenu","matMenu"],["mat-menu-item","",3,"click"],["mat-header-row",""],["mat-row","",1,"clickable","route-animations-elements",3,"click"]],template:function(t,e){1&t&&(x.Tb(0,"fury-page-layout",0),x.Tb(1,"fury-page-layout-header"),x.Ob(2,"fury-breadcrumbs",1),x.Sb(),x.Tb(3,"fury-page-layout-content"),x.Tb(4,"fury-list",2),x.bc("filterChange",(function(t){return e.onFilterChange(t)})),x.Tb(5,"div",3),x.Tb(6,"button",4),x.bc("click",(function(){return e.copyBillLines()})),x.Tb(7,"mat-icon"),x.Rc(8,"file_copy"),x.Sb(),x.Sb(),x.Tb(9,"button",5),x.bc("click",(function(){return e.createBillHead()})),x.Tb(10,"mat-icon"),x.Rc(11,"add"),x.Sb(),x.Sb(),x.Sb(),x.Tb(12,"table",6),x.Pc(13,Wt,2,1,"ng-container",7),x.Rb(14,8),x.Pc(15,Yt,2,0,"th",9),x.Pc(16,Zt,2,1,"td",10),x.Qb(),x.Rb(17,11),x.Pc(18,te,1,0,"th",12),x.Pc(19,ee,12,1,"td",13),x.Qb(),x.Pc(20,ie,1,0,"tr",14),x.Pc(21,ae,1,0,"tr",15),x.Sb(),x.Ob(22,"mat-paginator",16),x.Sb(),x.Sb(),x.Sb()),2&t&&(x.Cb(2),x.mc("@fadeInRight",void 0)("crumbs",x.qc(9,se)),x.Cb(1),x.mc("@fadeInUp",void 0),x.Cb(1),x.mc("columns",e.columns),x.Cb(8),x.mc("dataSource",e.dataSource),x.Cb(1),x.mc("ngForOf",e.columns),x.Cb(7),x.mc("matHeaderRowDef",e.visibleColumns),x.Cb(1),x.mc("matRowDefColumns",e.visibleColumns),x.Cb(1),x.mc("pageSize",e.pageSize))},directives:[Et.a,jt.a,qt.a,zt.a,$t.a,w.a,_t.a,D.a,b.j,p.a,s.n,b.c,b.e,b.b,b.g,b.i,h.a,s.o,b.d,p.b,b.a,s.p,Gt.c,Kt.d,Kt.e,Kt.b,b.f,b.h],styles:[".left-margin[_ngcontent-%COMP%]{margin-left:10px}.right-margin[_ngcontent-%COMP%]{margin-right:10px}.header-align-right[_ngcontent-%COMP%]{text-align:right}"],data:{animation:[T.a,v.a]}}),oe)}],ue=((ne=function t(){a(this,t)}).\u0275mod=x.Lb({type:ne}),ne.\u0275inj=x.Kb({factory:function(t){return new(t||ne)},imports:[[m.j.forChild(ce)],m.j]}),ne),fe=l("WCGO"),de=l("YUcS"),me=l("VE2z"),he=l("wZkO"),pe=l("GiUZ"),be=l("6NWb"),ge=l("Rlsg"),ye=l("wqNl"),Ce=l("jJIU"),Te=l("zWnM"),ve=l("zeEN"),Se=((le=function t(){a(this,t)}).\u0275mod=x.Lb({type:le}),le.\u0275inj=x.Kb({factory:function(t){return new(t||le)},providers:[s.f],imports:[[s.c,Kt.c,be.b,ge.a,ue,ye.a,me.a,c.l,d.a,c.w,de.a,U.c,w.b,k.g,D.b,fe.a,pe.a,f.a,u.a,Ce.a,Te.a,ve.a]]}),le),Fe=l("RLWM"),xe=((re=function t(){a(this,t)}).\u0275mod=x.Lb({type:re}),re.\u0275inj=x.Kb({factory:function(t){return new(t||re)},imports:[[s.c,ue,c.l,c.w,d.a,fe.a,de.a,me.a,Se,f.a,w.b,D.b,U.c,_.c,j.b,he.c,u.a,pe.a,Fe.a]]}),re)},zeEN:function(t,e,i){"use strict";i.d(e,"a",(function(){return n}));var o=i("fXoL"),n=function(){var t=function t(){a(this,t)};return t.\u0275mod=o.Lb({type:t}),t.\u0275inj=o.Kb({factory:function(e){return new(e||t)},imports:[[]]}),t}()}}])}();