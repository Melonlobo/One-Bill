!function(){function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function n(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[102],{STtJ:function(e,o,s){"use strict";s.r(o),s.d(o,"EmsEnergyCostModule",(function(){return z}));var i,r=s("ofXK"),a=s("3Pt+"),c=s("tyNb"),l=s("6n/F"),u=s("sXtk"),h=s("KHMF"),g=s("JX19"),b=s("fXoL"),d=s("b6Qw"),y=s("xBcV"),p=s("rvYj"),f=s("XiUz"),C=s("jaxi"),m=s("Wp6s"),v=((i=function(){function e(n){var o;t(this,e),this.envService=n,this.energyCost=0,this.currency="",this.currency=null!==(o=Object(h.e)("Currency"))&&void 0!==o?o:n.currencyFormat}return n(e,[{key:"ngOnInit",value:function(){}}]),e}()).\u0275fac=function(t){return new(t||i)(b.Nb(u.a))},i.\u0275cmp=b.Hb({type:i,selectors:[["fury-energy-cost-tile"]],inputs:{costLabel:"costLabel",energyCost:"energyCost"},decls:7,vars:3,consts:[["fxFlex","",1,"mat-elevation-z4"],["fxFlex",""],[1,"topPadding"],[1,"tileHeading"],[1,"energyCost"]],template:function(t,e){1&t&&(b.Tb(0,"mat-card",0),b.Tb(1,"div",1),b.Ob(2,"span",2),b.Tb(3,"span",3),b.Rc(4),b.Sb(),b.Tb(5,"p",4),b.Rc(6),b.Sb(),b.Sb(),b.Sb()),2&t&&(b.Cb(4),b.Sc(e.costLabel),b.Cb(2),b.Uc(" ",e.currency," ",e.energyCost," "))},directives:[m.a,f.b],styles:[".topPadding[_ngcontent-%COMP%]{padding-top:20px}.energyCost[_ngcontent-%COMP%], .tileHeading[_ngcontent-%COMP%]{font-weight:700}.energyCost[_ngcontent-%COMP%]{font-size:x-large;vertical-align:middle;margin:0;padding:25px 0 10px}.gain[_ngcontent-%COMP%]{color:#5cb85c}.gain[_ngcontent-%COMP%], .loss[_ngcontent-%COMP%]{padding:0 10px;font-weight:bolder;font-size:large}.loss[_ngcontent-%COMP%]{color:#d9534f}"]}),i);function L(t,e){if(1&t&&(b.Tb(0,"mat-button-toggle",14),b.Rc(1),b.Sb()),2&t){var n=e.$implicit,o=e.index;b.nc("id",n),b.nc("value",n),b.mc("checked",0===o),b.Cb(1),b.Sc(n)}}function S(t,e){if(1&t&&(b.Tb(0,"mat-button-toggle",15),b.Rc(1),b.Sb()),2&t){var n=e.$implicit,o=e.index;b.nc("id",n),b.nc("value",n),b.mc("checked",0===o),b.Cb(1),b.Sc(n)}}var T,k,x,E=[{path:"",component:(T=function(){function e(n,o,s){var i;t(this,e),this.cookieService=n,this.emsDashboardService=o,this.envService=s,this.showSpinner=!1,this.frequency=["Daily","Weekly","Monthly","Yearly"],this.buttons=["Today","Yesterday"],this.selectedValue="Daily",this.reportType="Today",this.previousLabel="",this.currentLabel="",this.forecastLabel="",this.estimatedSavingsLabel="Estimated Savings",this.previousEnergyCost=0,this.currentEnergyCost=0,this.forecastEnergyCost=0,this.estimatedSavings=0,this.clientId="0",this.meterTypes=[],this.energyCostComparison=[],this.costComparisonChart=[],this.energyCost=[],this.isCurrent=!0,this.currency="",this.currency=null!==(i=Object(h.e)("Currency"))&&void 0!==i?i:s.currencyFormat}return n(e,[{key:"ngOnInit",value:function(){var t=this.cookieService.get("filterData");if(t){var e=JSON.parse(t);this.clientId=""==e.strClientId?this.cookieService.get("globalClientId"):e.strClientId}this.setConsumptionLables(),this.getUtilities()}},{key:"getUtilities",value:function(){var t=this;this.emsDashboardService.getUtilities(this.clientId).subscribe((function(e){e&&(t.meterTypes=[],e.forEach((function(e){t.meterTypes.push(e.description)})),t.getEnergyCost())}))}},{key:"onValChange",value:function(t){null!=t&&(this.selectedValue=t.value,this.setConsumptionLables(t.value),this.reportType=this.buttons[0],this.isCurrent=!0),this.getEnergyCost()}},{key:"ngAfterViewChecked",value:function(){var t=document.getElementById(this.reportType);this.buttons.forEach((function(t){document.getElementById(t).className="mat-raised-button"})),t.className="mat-raised-button-checked"}},{key:"onButtonChange",value:function(t){this.reportType=null!=t?t.value:this.buttons[0],this.isCurrent=this.buttons[0]==this.reportType,this.setConsumptionLables(this.selectedValue),this.getEnergyCost()}},{key:"setButtonColor",value:function(){var t=document.getElementById(this.reportType);t&&(this.buttons.forEach((function(t){document.getElementById(t).className="mat-raised-button"})),t&&(t.className="mat-raised-button-checked"))}},{key:"setConsumptionLables",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Daily";this.previousLabel="",this.currentLabel="",this.forecastLabel="";var e=new Date;"Daily"===t?(1==this.isCurrent?(this.currentLabel="So far Today",this.previousLabel="Yesterday",this.forecastLabel="Predicted Today"):(this.currentLabel="Yesterday",this.previousLabel="Day Before Yesterday",this.forecastLabel="Today"),this.buttons=["Today","Yesterday"]):"Weekly"===t?(1==this.isCurrent?(this.currentLabel="So far This Week",this.previousLabel="Last Week",this.forecastLabel="Predicted This Week"):(this.currentLabel="Last Week",this.previousLabel="Second Last Week",this.forecastLabel="This Week"),this.buttons=["This Week","Last Week"]):"Monthly"===t?(1==this.isCurrent?(e.setDate(1),e.setMonth(e.getMonth()-1),this.currentLabel="So far This Month",this.previousLabel="Last Month",this.forecastLabel="Predicted This Month"):(e.setDate(1),e.setMonth(e.getMonth()-2),this.currentLabel="Last Month",this.previousLabel="Secons Last Month",this.forecastLabel="This Month"),this.buttons=["This Month","Last Month"]):(1==this.isCurrent?(this.currentLabel="So far This Year",this.previousLabel="Last Year",this.forecastLabel="Predicted This Year"):(this.currentLabel="Last Year",this.previousLabel="Second Last Year",this.forecastLabel="This Year"),this.buttons=["This Year","Last Year"])}},{key:"getEnergyCost",value:function(){var t,e=this;this.showSpinner=!1,this.energyCostComparison=[],this.costComparisonChart=[];var n=[];this.currentEnergyCost=0,this.previousEnergyCost=0,this.forecastEnergyCost=0,this.estimatedSavings=0,this.stackedBarChartOptions=this.setStackedCostComparisonChart(this.energyCostComparison,this.costComparisonChart,n);var o=document.getElementById("eccontainer1");if(o&&l.chart("eccontainer1",this.stackedBarChartOptions),this.meterTypes&&this.meterTypes.length>0){var s=this.meterTypes.join(",");this.emsDashboardService.getOverallEnergyCost(this.clientId,s,this.selectedValue,this.isCurrent).subscribe({next:function(i){i?(e.showSpinner=!1,e.energyCost=i,t=i.energyCostStacks,n=i.categories,e.stackedBarChartOptions=e.setStackedCostComparisonChart(e.energyCostComparison,t,n),(o=document.getElementById("eccontainer1"))&&l.chart("eccontainer1",e.stackedBarChartOptions),e.emsDashboardService.getGroupWiseEnergyCost(e.clientId,s,e.selectedValue).subscribe({next:function(t){t?(e.showSpinner=!1,1==e.isCurrent?(e.currentEnergyCost=t.currentTotalCost,e.previousEnergyCost=t.previousTotalCost,e.forecastEnergyCost=t.forecastTotalCost,e.estimatedSavings=t.currentEstimatedSavings):(e.currentEnergyCost=t.previousTotalCost,e.previousEnergyCost=t.lastPreviousTotalCost,e.forecastEnergyCost=t.currentTotalCost,e.estimatedSavings=t.previousEstimatedSavings),e.showSpinner=!1):e.showSpinner=!1},error:function(t){e.showSpinner=!1}})):e.showSpinner=!1},error:function(t){e.showSpinner=!1}})}else this.showSpinner=!1}},{key:"setStackedCostComparisonChart",value:function(){var t=arguments.length>1?arguments[1]:void 0,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n="",o="",s=new Date,i=new Date,r="Today's Energy Cost",a="";return"Monthly"==this.selectedValue?(a="Day",i.setDate(1),i.setMonth(i.getMonth()-1),n=s.toLocaleString("en-us",{month:"long"}),o=i.toLocaleString("en-us",{month:"long"}),r=1==this.isCurrent?n+" Month Energy Cost":o+" Month Energy Cost"):"Daily"==this.selectedValue?(a="Hour",r=1==this.isCurrent?"Today's Energy Cost":"Yesterday's Energy Cost"):"Weekly"==this.selectedValue?(a="Date",r=1==this.isCurrent?"This Week Energy Cost":"Last Week Energy Cost"):"Yearly"==this.selectedValue&&(a="Month",r=1==this.isCurrent?"This Year Energy Cost":"Last Year Energy Cost"),{chart:{type:"spline",marginLeft:90},title:{text:r,style:{fontWeight:"bolder",fontFamily:"Roboto"}},credits:{enabled:!1},colors:["#1fd286","#1e5eff","#ffda44","#d80027","#808080","#0d233a","#8bbc21","#910000","#1aadce","#492970","#f28f43","#77a1e5","#c42525","#a6c96a"],xAxis:{categories:e,visible:!0,title:{text:a}},yAxis:{title:{text:"Total Cost"}},legend:{align:"center",x:30,verticalAlign:"bottom",y:20,floating:!1,backgroundColor:l.defaultOptions.legend.backgroundColor||"white",shadow:!1},tooltip:{headerFormat:"<b>{point.x}</b><br/>",pointFormat:"{series.name}: "+this.currency+" {point.y}"},plotOptions:{series:{pointWidth:50},column:{pointWidth:20,stacking:"normal",dataLabels:{enabled:!1}}},series:t}}}]),e}(),T.\u0275fac=function(t){return new(t||T)(b.Nb(d.a),b.Nb(g.a),b.Nb(u.a))},T.\u0275cmp=b.Hb({type:T,selectors:[["fury-ems-energy-cost"]],decls:19,vars:12,consts:[["mode","card"],["fxLayout","column",1,"content"],[1,"toolBar"],[1,"example-spacer"],["name","fontStyle","aria-label","Font Style",1,"buttons",2,"font-size","small","float","right",3,"value","change"],["mat-raised-button","","style","padding: 0px;",3,"id","checked","value",4,"ngFor","ngForOf"],["id","buttonGroup"],["name","fontStyle","aria-label","Font Style",1,"buttons",2,"font-size","small","border","0px",3,"value","change"],["style","padding: 0px;margin-right: 8px;",3,"id","checked","value",4,"ngFor","ngForOf"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column","fxLayoutGap","10px","fxFlex","100%",1,"content",2,"padding","0% 0% 1% 0%"],["fxFlex","",3,"costLabel","energyCost"],["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column",1,"content",2,"padding","0% 0% 0.25% 0.20%"],["fxFlex","100%",1,"mat-elevation-z4"],["id","eccontainer1"],["mat-raised-button","",2,"padding","0px",3,"id","checked","value"],[2,"padding","0px","margin-right","8px",3,"id","checked","value"]],template:function(t,e){1&t&&(b.Tb(0,"fury-page-layout",0),b.Tb(1,"fury-page-layout-content",1),b.Tb(2,"div"),b.Tb(3,"span",2),b.Rc(4,"Energy Cost"),b.Sb(),b.Ob(5,"span",3),b.Tb(6,"mat-button-toggle-group",4),b.bc("change",(function(t){return e.onValChange(t)})),b.Pc(7,L,2,4,"mat-button-toggle",5),b.Sb(),b.Sb(),b.Tb(8,"div",6),b.Tb(9,"mat-button-toggle-group",7),b.bc("change",(function(t){return e.onButtonChange(t)})),b.Pc(10,S,2,4,"mat-button-toggle",8),b.Sb(),b.Sb(),b.Tb(11,"div",9),b.Ob(12,"fury-energy-cost-tile",10),b.Ob(13,"fury-energy-cost-tile",10),b.Ob(14,"fury-energy-cost-tile",10),b.Ob(15,"fury-energy-cost-tile",10),b.Sb(),b.Tb(16,"div",11),b.Tb(17,"mat-card",12),b.Ob(18,"div",13),b.Sb(),b.Sb(),b.Sb(),b.Sb()),2&t&&(b.Cb(6),b.mc("value",e.selectedValue),b.Cb(1),b.mc("ngForOf",e.frequency),b.Cb(2),b.mc("value",e.reportType),b.Cb(1),b.mc("ngForOf",e.buttons),b.Cb(2),b.mc("costLabel",e.previousLabel)("energyCost",e.previousEnergyCost),b.Cb(1),b.mc("costLabel",e.currentLabel)("energyCost",e.currentEnergyCost),b.Cb(1),b.mc("costLabel",e.forecastLabel)("energyCost",e.forecastEnergyCost),b.Cb(1),b.mc("costLabel",e.estimatedSavingsLabel)("energyCost",e.estimatedSavings))},directives:[y.a,p.a,f.d,C.b,r.n,f.e,f.b,v,m.a,C.a],styles:['.mat-button-toggle-checked[_ngcontent-%COMP%]{background-color:#0051b4;color:#fff!important}.content[_ngcontent-%COMP%]{margin-top:1%}.toolBar[_ngcontent-%COMP%]{font-size:x-large;font-weight:700;line-height:50px}.common-buttons[_ngcontent-%COMP%]{height:50%}.mat-button-toggle-group[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   [_ngcontent-%COMP%]:checked{background-color:#1fd286;color:#fff!important}.mat-raised-button[_ngcontent-%COMP%]{color:#000}.mat-raised-button-checked[_ngcontent-%COMP%]{background-color:#1fd286!important;color:#fff!important}.loading-indicator[_ngcontent-%COMP%]{position:fixed;z-index:999;height:2em;width:2em;overflow:show;margin:auto;top:0;left:0;bottom:0;right:0}.loading-indicator[_ngcontent-%COMP%]:before{content:"";display:block;position:fixed;top:0;left:0;width:100%;height:100%;background-color:rgba(0,0,0,.3)}']}),T)}],O=((k=function e(){t(this,e)}).\u0275mod=b.Lb({type:k}),k.\u0275inj=b.Kb({factory:function(t){return new(t||k)},imports:[[c.j.forChild(E)],c.j]}),k),M=s("qFsG"),w=s("NFeN"),P=s("/t3+"),F=s("kmnG"),W=s("VE2z"),Y=s("KthW"),D=s("WCGO"),_=s("QMK6"),B=s("q8Jb"),I=s("0jmt"),V=s("0IaG"),N=s("Qu3c"),j=s("STbY"),z=((x=function e(){t(this,e)}).\u0275mod=b.Lb({type:x}),x.\u0275inj=b.Kb({factory:function(t){return new(t||x)},providers:[r.f,r.g],imports:[[r.c,O,a.l,Y.a,D.a,a.w,_.a,W.a,I.a,B.a,F.f,M.c,C.c,w.b,j.c,P.b,N.b,V.g]]}),x)}}])}();