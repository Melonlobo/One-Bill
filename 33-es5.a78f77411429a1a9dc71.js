!function(){function t(t,i){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=function(t,i){if(!t)return;if("string"==typeof t)return e(t,i);var n=Object.prototype.toString.call(t).slice(8,-1);"Object"===n&&t.constructor&&(n=t.constructor.name);if("Map"===n||"Set"===n)return Array.from(t);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(t,i)}(t))||i&&t&&"number"==typeof t.length){n&&(t=n);var a=0,r=function(){};return{s:r,n:function(){return a>=t.length?{done:!0}:{done:!1,value:t[a++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,o=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return o=t.done,t},e:function(t){c=!0,s=t},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw s}}}}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var i=0,n=new Array(e);i<e;i++)n[i]=t[i];return n}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function a(t,e,i){return e&&n(t.prototype,e),i&&n(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{"/D9e":function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("tk/3"),s=n("lJxs"),o=n("sXtk"),c=n("fXoL"),l=function(){var t=function(){function t(e,n){i(this,t),this.handler=e,this.envService=n,this.baseUrl="",this.http=new r.c(e),this.baseUrl=n.backend}return a(t,[{key:"upload",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"file",i=new FormData;return i.append("file",t),this.http.post(this.baseUrl+"/fileupload/"+e,i).pipe(Object(s.a)((function(t){return t.fileName})))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(c.Xb(r.b),c.Xb(o.a))},t.\u0275prov=c.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},"/ptB":function(t,e,n){"use strict";n.d(e,"a",(function(){return a}));var a=function t(e){i(this,t),this.id=e.id||0,this.description=e.description||"",this.defaultValue=e.defaultValue||"1",this.parentId=e.parentId||0,this.parentName=e.parentName||"",this.mode=e.mode||0,this.modeName=e.modeName||"",this.sequence=e.sequence||0}},AJS6:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("tk/3"),s=n("sXtk"),o=n("fXoL"),c=function(){var t=function(){function t(e,n){i(this,t),this.httpClient=e,this.envService=n,this.baseUrl="",this.baseUrl=n.backend}return a(t,[{key:"getTemplateByTemplateTypeId",value:function(t,e,i){var n=new r.f;return(t||e)&&(n=(n=(n=n.append("templateTypeId",""+t)).append("clientId",""+e)).append("notificationType",""+i)),this.httpClient.get(this.baseUrl+"/notifications/templates/email/content",{params:n})}},{key:"CheckForTemplateType",value:function(t,e,i){var n=new r.f;return n=(n=(n=n.append("templateTypeId",""+t)).append("notificationType",""+e)).append("clientId",""+i),this.httpClient.get(this.baseUrl+"/notifications/templates/GetNotificationTemplateId",{params:n})}},{key:"updateTemplateById",value:function(t,e){return this.httpClient.put(this.baseUrl+"/notifications/templates/"+t,e)}},{key:"insertTemplate",value:function(t){return this.httpClient.post(this.baseUrl+"/notifications/templates",t)}},{key:"getTemplateTypes",value:function(){return this.httpClient.get(this.baseUrl+"/notifications/templates/GetTemplateTypes")}},{key:"getSmsTemplates",value:function(t){return this.httpClient.get(this.baseUrl+"/notifications/templates/sms/clientId/"+t)}},{key:"getEmailTemplates",value:function(t){return this.httpClient.get(this.baseUrl+"/notifications/templates/email/clientId/"+t)}},{key:"getNotificationTemplates",value:function(t){var e=new r.f;return e=e.append("notificationCategoryId",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/getNotificationTemplates",{params:e})}},{key:"getKeywords",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new r.f;return e=e.append("id",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/Keywords",{params:e})}},{key:"getConditions",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new r.f;return e=e.append("id",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/conditions",{params:e})}},{key:"getNotificationModes",value:function(t){var e=new r.f;return e=e.append("clientId",""+t),this.httpClient.get(this.baseUrl+"/notifications/templates/notificationModes",{params:e})}},{key:"createAlertSettings",value:function(t,e){return this.httpClient.post(this.baseUrl+"/notifications/alert/settings/"+e,t)}},{key:"getAlertSettings",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=new r.f;return t&&(a=(a=(a=(a=a.append("clientId",""+t)).append("notificationCategorId",""+e)).append("templateTypeId",""+i)).append("notificationModes",""+n)),this.httpClient.get(this.baseUrl+"/notifications/alert/settings",{params:a})}},{key:"copyNotificationTemplates",value:function(t){return this.httpClient.post(this.baseUrl+"/notifications/templates/copy/contents",t)}},{key:"getNotificationLogs",value:function(t){var e=new r.f;return e=(e=(e=(e=(e=e.append("fromDate",""+t.fromDate)).append("toDate",""+t.toDate)).append("status",""+t.statusId)).append("mode",""+t.modeId)).append("clientId",""+t.clientId),this.httpClient.get(this.baseUrl+"/notifications/logs",{params:e})}},{key:"createSLDMaster",value:function(t){return this.httpClient.post(this.baseUrl+"/notifications/sld/master",t)}},{key:"updateSLDMaster",value:function(t){return this.httpClient.put(this.baseUrl+"/notifications/sld/master",t)}},{key:"getSLDMaster",value:function(t,e){var i=new r.f;return i=(i=i.append("masterId",""+t)).append("clientId",""+e),this.httpClient.get(this.baseUrl+"/notifications/sld/master",{params:i})}},{key:"getClientAlertSettings",value:function(t){var e=new r.f;return t&&(e=e.append("clientId",""+t)),this.httpClient.get(this.baseUrl+"/notifications/client/alert/settings",{params:e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Xb(r.c),o.Xb(s.a))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},O3qS:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("sXtk"),s=n("fXoL"),o=n("tk/3"),c=function(){var t=function(){function t(e,n){i(this,t),this.http=e,this.envService=n,this.baseUrl="",this.baseUrl=n.backend}return a(t,[{key:"getMasterDetails",value:function(){return this.http.get(this.baseUrl+"/masterdetails")}},{key:"getMasterDetailsById",value:function(t){return this.http.get(this.baseUrl+"/masterdetails/"+t)}},{key:"getModes",value:function(){return this.http.get(this.baseUrl+"/masterdetails/getModes")}},{key:"getParentModes",value:function(t){return this.http.get(this.baseUrl+"/masterdetails/getparentmodes/"+t)}},{key:"createMasterDetails",value:function(t){return this.http.post(this.baseUrl+"/masterdetails/",t)}},{key:"updateMasterDetails",value:function(t,e){return this.http.put(this.baseUrl+"/masterdetails/"+t,e)}}]),t}();return t.\u0275fac=function(e){return new(e||t)(s.Xb(o.c),s.Xb(r.a))},t.\u0275prov=s.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},WFQN:function(t,e,n){"use strict";n.d(e,"a",(function(){return c}));var r=n("tk/3"),s=n("sXtk"),o=n("fXoL"),c=function(){var t=function(){function t(e,n){i(this,t),this.http=e,this.envService=n,this.baseUrl="",this.baseUrl=n.backend}return a(t,[{key:"getReplacedMeters",value:function(t){return this.http.get(this.baseUrl+"/devicelistreplacements/clientId/"+t)}},{key:"createMeterReplacement",value:function(t){return this.http.post(this.baseUrl+"/devicelistreplacements/",t)}},{key:"GetUtilityTypes",value:function(t){var e=new r.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/UtilityTypes",{params:e})}},{key:"getAllUnits",value:function(t,e){var i=new r.f;return i=(i=i.append("clientId",""+t)).append("utilityTypeId",""+e),this.http.get(this.baseUrl+"/devicelistreplacements/Units",{params:i})}},{key:"GetActiveDevices",value:function(t,e){var i=new r.f;return i=(i=i.append("clientId",""+t)).append("utilityTypeId",""+e),this.http.get(this.baseUrl+"/devicelistreplacements/ActiveDevices",{params:i})}},{key:"getMeterErrorDetails",value:function(t){return this.http.post(this.baseUrl+"/devicelistreplacements/MeterError",t)}},{key:"GetParametersList",value:function(){return this.http.get(this.baseUrl+"/devicelistreplacements/Parameters")}},{key:"getDeviceDataDetails",value:function(t){return this.http.post(this.baseUrl+"/devicelistreplacements/DeviceData",t)}},{key:"GetMeterList",value:function(t){var e=new r.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/MeterList",{params:e})}},{key:"getDeviceGroupMeterList",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",n=new r.f;return n=(n=(n=n.append("meterTypeId",""+t)).append("groupId",""+e)).append("clientId",""+i),this.http.get(this.baseUrl+"/devicelistreplacements/type/group/meterList",{params:n})}},{key:"getV1DeviceGroupMeterList",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",n=new r.f;return n=(n=(n=n.append("meterTypeId",""+t)).append("groupId",""+e)).append("clientId",""+i),this.http.get(this.baseUrl+"/devicelistreplacements/v1/type/group/meterListFilterByClient",{params:n})}},{key:"getV1DeviceGroupMeterListWithoutFlowTypeFilter",value:function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"0",n=new r.f;return n=(n=(n=n.append("meterTypeId",""+t)).append("groupId",""+e)).append("clientId",""+i),this.http.get(this.baseUrl+"/devicelistreplacements/V1/type/group/meterListFilterByClientWithoutFlowTypeFilter",{params:n})}},{key:"getV1MeterList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new r.f;return e=e.append("clientId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/v1/meterListFilterByClient",{params:e})}},{key:"getClients",value:function(){return this.http.get(this.baseUrl+"/devicelistreplacements/v1/clients")}},{key:"getV1MeterGroupList",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=new r.f;return e=e.append("meterTypeId",""+t),this.http.get(this.baseUrl+"/devicelistreplacements/v1/meterGroups",{params:e})}}]),t}();return t.\u0275fac=function(e){return new(e||t)(o.Xb(r.c),o.Xb(s.a))},t.\u0275prov=o.Jb({token:t,factory:t.\u0275fac,providedIn:"root"}),t}()},YaQ2:function(t,e,n){"use strict";n.d(e,"a",(function(){return l}));var r=n("fXoL"),s=n("ofXK");function o(t,e){if(1&t&&(r.Tb(0,"small"),r.Rc(1),r.Ob(2,"br"),r.Sb()),2&t){var i=e.$implicit;r.Cb(1),r.Tc(" ",i," ")}}function c(t,e){if(1&t&&(r.Tb(0,"div"),r.Pc(1,o,3,1,"small",1),r.Sb()),2&t){var i=r.fc();r.Cb(1),r.mc("ngForOf",i.listOfErrors())}}var l=function(){var t=function(){function t(){var e=this;i(this,t),this.PATTERN_ERROR_MESSAGE={"/^[a-zA-Z ]*$/":"Accepts only alphabets with spaces","/^[a-zA-Z0-9]*$/":"Accepts only alphanumeric values with no spaces","/^[a-zA-Z0-9 ]*$/":"Accepts only alphanumeric values with spaces","/^[0-9]*$/":"Accepts only numbers","^[a-z0-9._%+-]+@[a-z0-9.-]+\\.[a-z]{3,4}$":"Enter valid email address of format test@mail.com"},this.ERROR_MESSAGE={required:function(){return"This field is required"},minlength:function(t){return"Min ".concat(t.requiredLength," chars is required but got only ").concat(t.actualLength)},maxlength:function(t){return"Max chars allowed is ".concat(t.requiredLength," but got ").concat(t.actualLength)},pattern:function(t){return""+e.PATTERN_ERROR_MESSAGE[t.requiredPattern]},email:function(){return"Enter valid email address of format test@mail.com"}}}return a(t,[{key:"ngOnInit",value:function(){}},{key:"shouldShowErrors",value:function(){return this.ctrl&&this.ctrl.errors&&this.ctrl.touched}},{key:"listOfErrors",value:function(){var t=this;return Object.keys(this.ctrl.errors).map((function(e){return t.ERROR_MESSAGE[e](t.ctrl.getError(e))}))}}]),t}();return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=r.Hb({type:t,selectors:[["app-show-errors"]],inputs:{ctrl:"ctrl"},decls:1,vars:1,consts:[[4,"ngIf"],[4,"ngFor","ngForOf"]],template:function(t,e){1&t&&r.Pc(0,c,2,1,"div",0),2&t&&r.mc("ngIf",e.shouldShowErrors())},directives:[s.o,s.n],styles:["small[_ngcontent-%COMP%]{color:red}"]}),t}()},hfXQ:function(e,n,r){"use strict";r.r(n),r.d(n,"SingleLineDiagramModule",(function(){return K}));var s=r("ofXK"),o=r("tyNb"),c=r("Nr/g"),l=r("dDrv"),u=r("AJS6"),d=r("/D9e"),p=r("zSPf"),h=r("WFQN"),f=r("KHMF"),m=r("zP6O"),b=r("sXtk"),v=r("fXoL"),g=r("dNgK"),y=r("b6Qw"),S=r("0IaG"),k=r("XiUz"),T=r("/t3+"),I=r("znSr"),C=r("bTqV"),M=r("NFeN"),x=r("Wp6s"),w=r("kmnG"),N=r("d3UM"),L=r("3Pt+"),P=r("qFsG"),U=r("f0Cb"),D=r("FKr1"),F=["profilePic"];function R(t,e){if(1&t&&(v.Tb(0,"mat-option",26),v.Rc(1),v.Sb()),2&t){var i=e.$implicit;v.mc("value",i.id),v.Cb(1),v.Sc(i.description)}}function E(t,e){if(1&t&&(v.Tb(0,"mat-option",26),v.Rc(1),v.Sb()),2&t){var i=e.$implicit;v.mc("value",i.id),v.Cb(1),v.Sc(i.description)}}function G(t,e){if(1&t&&(v.Tb(0,"mat-option",26),v.Rc(1),v.Sb()),2&t){var i=e.$implicit;v.mc("value",i.id),v.Cb(1),v.Sc(i.description)}}var O,A,X,z=[{path:"",component:(O=function(){function e(t,n,a,r,s,o,c,l,u,d){var p;i(this,e),this.parameterChartService=t,this.estidamaChartService=n,this.templateService=a,this.snackbar=r,this.fileService=s,this.masterService=o,this.meterReplacementService=c,this.cookieService=l,this.dialog=u,this.envService=d,this.clientId=0,this.meters=[],this.filtermeters=[],this.meterName="",this.parameters=[],this.parameterName="",this.meterTypes=[],this.meterGroupList=[],this.meterGroup=null,this.lstMeterGroup=[],this.dateFormat="",this.pointSize=7,this.floors=[],this.sldMaster={},this.sldTransactions=[],this.attachment="",this.image="",this.baseUrl="",this.client=0,this.clients=[],this.baseUrl=d.backendForFiles,this.dateFormat=null!==(p=Object(f.e)("DateFormat"))&&void 0!==p?p:d.dateFormat}return a(e,[{key:"ngOnInit",value:function(){this.getClients(),this.onMeterGroupChange(),this.getFloors()}},{key:"getClients",value:function(){var t=this;this.clients=[],this.meterReplacementService.getClients().subscribe((function(e){e&&(t.clients=e)}))}},{key:"onChangeClient",value:function(){this.onMeterGroupChange()}},{key:"getMeterTypes",value:function(){var t=this;this.meterTypes=[],this.meters=[],this.parameters=[],this.estidamaChartService.getMeterTypes().subscribe((function(e){if(e){var i=e.meterTypeList;i&&i.forEach((function(e){t.meterTypes.push({id:e.meterTypeID,description:e.meterTypeName})})),t.meterTypeId=t.meterTypes[0].id,t.meterGroupList=e.meterGroupList,t.onMeterTypeChange()}}))}},{key:"getFloors",value:function(){var t=this;this.floors=[],this.masterService.getUserMasterdata(9,0).subscribe((function(e){e&&(t.floors=e)}))}},{key:"onMeterTypeChange",value:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;e&&(this.meterTypeId=e.value),this.meterGroupList.forEach((function(e){e.meterTypeID==t.meterTypeId&&(t.lstMeterGroup.some((function(t){return t.groupID==e.groupID}))||t.lstMeterGroup.push({groupID:e.groupID,groupName:e.groupName}))})),this.lstMeterGroup.length>0&&(this.meterGroup=this.lstMeterGroup[0].groupID),this.onMeterGroupChange()}},{key:"onMeterGroupChange",value:function(){var t=this;this.meters=[],0!=this.clientId&&this.meterReplacementService.getV1MeterList(this.clientId).subscribe((function(e){e&&(t.meters=t.filtermeters=e)})),this.getParameters()}},{key:"onMeterChange",value:function(t){var e=this;this.meters.filter((function(i){i.id==t.value&&(e.meterName=i.description,e.meterId=i.id)}))}},{key:"onFloorChange",value:function(t){var e=this;this.floors.filter((function(i){i.id==t.value&&(e.floorId=i.id,e.onGetSLDTransactions())}))}},{key:"getParameters",value:function(){var t=this;this.parameterChartService.getParameters(this.meterTypeId).subscribe((function(e){e&&(t.parameters=e)}))}},{key:"search",value:function(t){var e=this.select(t);this.meters=e}},{key:"select",value:function(e){var i=[];if(e){var n,a=t(this.filtermeters);try{for(a.s();!(n=a.n()).done;){var r=n.value;r.description.toLowerCase().indexOf(e)>-1&&i.push(r)}}catch(s){a.e(s)}finally{a.f()}}else i=this.filtermeters;return i}},{key:"getPosition",value:function(t){var e=this;if(this.meterId)if(this.sldTransactions.find((function(t){return t.meterId===Number(e.meterId)})))this.notificationMessage("Meter already added","red-snackbar");else{this.element=this.root,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d");var i=0,n=0;i+=t.offsetX,n+=t.offsetY,this.drawCoordinates(i,n)}else this.notificationMessage("Please select meter","red-snackbar")}},{key:"drawCoordinates",value:function(t,e){var i=this.ctx.createLinearGradient(0,0,170,0);i.addColorStop(1,"red"),this.ctx.fillStyle=i,this.ctx.beginPath(),this.ctx.arc(Number(t),Number(e),this.pointSize,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.fillText(this.meterName,t+5,e);var n=this.ctx.getImageData(t,e,1,1).data,a=(("000000"+this.rgbToHex(n[0],n[1],n[2])).slice(-6),{meterId:Number(this.meterId),meterName:this.meterName,x:Number(t),y:Number(e),clientId:Number(this.clientId),isDeleted:!1});this.sldTransactions.push(a)}},{key:"rgbToHex",value:function(t,e,i){if(t>255||e>255||i>255)throw"Invalid color component";return(t<<16|e<<8|i).toString(16)}},{key:"uploadPhoto",value:function(){var t=this;this.fileService.upload(this.profilePic.nativeElement.files[0]).subscribe((function(e){t.attachment=e,t.image=t.baseUrl+"/uploads/"+t.attachment}))}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"clear",value:function(){this.sldTransactions=[],this.canvas=document.getElementById("canvas"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.image=""}},{key:"onSave",value:function(){var t=this;this.floorId?0!=this.clientId?this.sldMaster&&this.sldMaster.id?(this.sldMaster.sldPath=this.image,this.sldMaster.sldTransactions=this.sldTransactions,this.templateService.updateSLDMaster(this.sldMaster).subscribe({next:function(e){e?t.notificationMessage("SLD Master updated successfully","green-snackbar"):t.notificationMessage("SLD Master update failed","red-snackbar")},error:function(e){t.notificationMessage("SLD Master update failed","red-snackbar")}})):this.templateService.createSLDMaster({masterId:this.floorId,clientId:this.clientId,sldPath:this.image,sldTransactions:this.sldTransactions}).subscribe({next:function(e){e?t.notificationMessage("SLD Master saved successfully","green-snackbar"):t.notificationMessage("SLD Master save failed","red-snackbar")},error:function(e){t.notificationMessage("SLD Master save failed","red-snackbar")}}):this.notificationMessage("Please select Client","red-snackbar"):this.notificationMessage("Please select floor","red-snackbar")}},{key:"onGetSLDTransactions",value:function(){var t=this;this.sldMaster={},this.sldTransactions=[],this.image="",this.canvas=document.getElementById("canvas"),this.canvas.getContext("2d").clearRect(0,0,this.canvas.width,this.canvas.height),this.templateService.getSLDMaster(this.floorId,this.clientId).subscribe({next:function(e){e&&(t.sldMaster=e,t.image=t.sldMaster.sldPath,t.sldTransactions=t.sldMaster.sldTransactions,t.sldMaster.sldTransactions.forEach((function(e){t.bindCoordinates(e.x,e.y,e.meterName)})))},error:function(e){t.sldMaster={},t.sldTransactions=[],t.image="",t.canvas=document.getElementById("canvas"),t.canvas.getContext("2d").clearRect(0,0,t.canvas.width,t.canvas.height),t.notificationMessage("SLD Master not found","yellow-snackbar")}})}},{key:"bindCoordinates",value:function(t,e,i){this.element=this.root,this.canvas=document.getElementById("canvas"),this.ctx=this.canvas.getContext("2d");var n=this.ctx.createLinearGradient(0,0,170,0);n.addColorStop(0,"black"),n.addColorStop(1,"red"),this.ctx.fillStyle=n,this.ctx.beginPath(),this.ctx.arc(Number(t),Number(e),this.pointSize,0,2*Math.PI,!0),this.ctx.fill(),this.ctx.fillText(i,t+5,e);var a=this.ctx.getImageData(t,e,1,1).data;("000000"+this.rgbToHex(a[0],a[1],a[2])).slice(-6)}},{key:"createFloor",value:function(){var t=this;this.dialog.open(m.a,{data:[0,9]}).afterClosed().subscribe((function(e){e&&"Success"==e&&t.getFloors()}))}}]),e}(),O.\u0275fac=function(t){return new(t||O)(v.Nb(c.a),v.Nb(l.a),v.Nb(u.a),v.Nb(g.b),v.Nb(d.a),v.Nb(p.a),v.Nb(h.a),v.Nb(y.a),v.Nb(S.b),v.Nb(b.a))},O.\u0275cmp=v.Hb({type:O,selectors:[["fury-single-line-diagram"]],viewQuery:function(t,e){var i;1&t&&v.Vc(F,!0),2&t&&v.zc(i=v.cc())&&(e.profilePic=i.first)},decls:43,vars:8,consts:[["fxLayout","column","fxLayoutGap","2%",2,"padding","27px"],["color","primary","fxLayout","row","fxLayout.xs","column",1,"position-fixed"],["src","assets/img/fav-icon.png",1,"img-style",3,"fxHide.xs"],["fxLayout","row","fxLayout.xs","column"],[1,"toolbar-spacer"],[1,"fury-flex-form-field"],["mat-icon-button","","aria-label","Example icon-button with menu icon",1,"example-icon",3,"click"],["matTooltip","Reset",1,"icon-color"],["matTooltip","Print","mat-icon-button","",1,"example-icon",3,"click"],["fxLayout","column","fxLayoutGap","2%"],["fxLayout","row","fxLayout.xs","column","fxLayoutGap","2%",2,"width","90%"],["fxFlex",""],[2,"width","75%","margin-right","0px"],["id","floorId","placeholder","Select a Floor",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["type","button","mat-mini-fab","","color","primary",1,"create",2,"height","30px","width","30px","margin-right","0px","margin-left","5px","padding-top","-5px",3,"click"],[2,"height","10px","width","10px","padding-top","-5px","margin-top","-25px","margin-left","-13px"],["name","clientId","id","clientId","placeholder","Client",3,"ngModel","ngModelChange","selectionChange"],["fxFlex","",2,"padding-top","15px"],["fxFlex","","type","file","id","picture","id","InputFile","name","InputFile","max-file-size","100kb",1,"input-file",3,"change"],["profilePic",""],["id","meterId","placeholder","Select a Meter",3,"selectionChange"],["matInput","","focused","'true'","type","text","autocomplete","off","placeholder","search",1,"myInput",3,"keyup"],["myInput",""],["fxLayout","row","fxLayoutGap","10%"],["id","canvas","width","810","height","720",3,"click"],[3,"value"]],template:function(t,e){1&t&&(v.Tb(0,"div",0),v.Tb(1,"mat-toolbar",1),v.Ob(2,"img",2),v.Tb(3,"span",3),v.Rc(4,"Single line diagram"),v.Sb(),v.Ob(5,"span",4),v.Tb(6,"div",5),v.Tb(7,"button",6),v.bc("click",(function(){return e.clear()})),v.Tb(8,"mat-icon",7),v.Rc(9,"refresh"),v.Sb(),v.Sb(),v.Sb(),v.Tb(10,"div",5),v.Tb(11,"button",8),v.bc("click",(function(){return e.onSave()})),v.Tb(12,"mat-icon"),v.Rc(13,"save"),v.Sb(),v.Sb(),v.Sb(),v.Sb(),v.Tb(14,"mat-card",9),v.Tb(15,"div",10),v.Tb(16,"div",11),v.Tb(17,"mat-form-field",12),v.Tb(18,"mat-select",13),v.bc("selectionChange",(function(t){return e.onFloorChange(t)})),v.Pc(19,R,2,2,"mat-option",14),v.Sb(),v.Tb(20,"mat-hint"),v.Rc(21,"Please select Floor."),v.Sb(),v.Sb(),v.Tb(22,"button",15),v.bc("click",(function(){return e.createFloor()})),v.Tb(23,"mat-icon",16),v.Rc(24,"add"),v.Sb(),v.Sb(),v.Sb(),v.Tb(25,"mat-form-field",11),v.Tb(26,"mat-label"),v.Rc(27,"Client"),v.Sb(),v.Tb(28,"mat-select",17),v.bc("ngModelChange",(function(t){return e.clientId=t}))("selectionChange",(function(){return e.onChangeClient()})),v.Pc(29,E,2,2,"mat-option",14),v.Sb(),v.Tb(30,"mat-hint"),v.Rc(31,"Please select Client."),v.Sb(),v.Sb(),v.Tb(32,"div",18),v.Tb(33,"input",19,20),v.bc("change",(function(){return e.uploadPhoto()})),v.Sb(),v.Sb(),v.Tb(35,"mat-form-field",11),v.Tb(36,"mat-select",21),v.bc("selectionChange",(function(t){return e.onMeterChange(t)})),v.Tb(37,"input",22,23),v.bc("keyup",(function(t){return e.search(t.target.value)})),v.Sb(),v.Ob(39,"mat-divider"),v.Pc(40,G,2,2,"mat-option",14),v.Sb(),v.Sb(),v.Sb(),v.Sb(),v.Tb(41,"mat-card",24),v.Tb(42,"canvas",25),v.bc("click",(function(t){return e.getPosition(t)})),v.Sb(),v.Sb(),v.Sb()),2&t&&(v.Cb(2),v.mc("fxHide.xs",!0),v.Cb(17),v.mc("ngForOf",e.floors),v.Cb(9),v.mc("ngModel",e.clientId),v.Cb(1),v.mc("ngForOf",e.clients),v.Cb(11),v.mc("ngForOf",e.meters),v.Cb(2),v.Lc("cursor:crosshair;background:url(",e.image,")"))},directives:[k.d,k.e,T.a,I.b,C.a,M.a,x.a,k.b,w.d,N.a,s.n,w.g,w.h,L.q,L.t,P.b,U.a,D.n],styles:[".common-buttons[_ngcontent-%COMP%]{height:50%;margin-top:10px}.myInput[_ngcontent-%COMP%]{height:50px!important;padding:10px!important}.toolbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.img-style[_ngcontent-%COMP%]{width:32px}.position-fixed[_ngcontent-%COMP%]{position:sticky;position:-webkit-sticky;top:0;z-index:5}"]}),O)}],q=((A=function t(){i(this,t)}).\u0275mod=v.Lb({type:A}),A.\u0275inj=v.Kb({factory:function(t){return new(t||A)},imports:[[o.j.forChild(z)],o.j]}),A),V=r("YUcS"),_=r("bSwM"),j=r("iadO"),B=r("jJIU"),K=((X=function t(){i(this,t)}).\u0275mod=v.Lb({type:X}),X.\u0275inj=v.Kb({factory:function(t){return new(t||X)},providers:[s.f,s.g],imports:[[s.c,B.a,q,L.l,L.w,V.a,C.b,P.c,w.f,N.b,D.o,T.b,x.g,_.b,j.c,M.b,U.b]]}),X)},zP6O:function(t,e,n){"use strict";n.d(e,"a",(function(){return x}));var r=n("3Pt+"),s=n("0IaG"),o=n("/ptB"),c=n("O3qS"),l=n("xXXn"),u=n("fXoL"),d=n("dNgK"),p=n("/t3+"),h=n("bTqV"),f=n("NFeN"),m=n("MutI"),b=n("4FRi"),v=n("XiUz"),g=n("ofXK"),y=n("kmnG"),S=n("qFsG"),k=n("YaQ2"),T=n("/1cH"),I=n("FKr1");function C(t,e){if(1&t&&(u.Tb(0,"mat-option",20),u.Rc(1),u.Sb()),2&t){var i=e.$implicit;u.mc("value",i.description),u.Cb(1),u.Tc(" ",i.description," ")}}function M(t,e){if(1&t){var i=u.Ub();u.Tb(0,"mat-form-field",10),u.Tb(1,"mat-label"),u.Rc(2,"Parent Item"),u.Sb(),u.Tb(3,"input",16),u.bc("ngModelChange",(function(t){return u.Ec(i),u.fc().parentName=t})),u.Sb(),u.Tb(4,"mat-autocomplete",17,18),u.bc("optionSelected",(function(t){return u.Ec(i),u.fc().selectParentMode(t)})),u.Pc(6,C,2,2,"mat-option",19),u.Sb(),u.Sb()}if(2&t){var n=u.Ac(5),a=u.fc();u.Cb(3),u.mc("matAutocomplete",n)("ngModel",a.parentName),u.Cb(3),u.mc("ngForOf",a.filteredParentModes)}}var x=function(){var t=function(){function t(e,n,a,r,s,o){i(this,t),this.dialogRef=e,this.masterDetailsService=n,this.snackbar=a,this.dialog=r,this.modes=s,this.fb=o,this.isCancel=!1,this.parentExists=!1,this.modeId=0,this.parentId=0,this.parentName="",this.parentIdFilter=0,e.disableClose=!0}return a(t,[{key:"ngOnInit",value:function(){var t=this;this.parentId=this.modes[0],this.modeId=this.modes[1],this.parentIdFilter=null==this.modes[2]?0:this.modes[2],this.defaults=new o.a({}),this.form=this.fb.group({parentId:[this.defaults.parentId||""],parentName:[this.defaults.parentName||""],description:[this.defaults.description||"",r.y.required]}),this.modeId&&(this.parentExists=!1,this.form.controls.parentName.clearValidators(),this.form.controls.parentName.markAsUntouched(),this.masterDetailsService.getParentModes(this.modeId).subscribe((function(e){if(e){t.parentIdFilter>0&&(e=e.filter((function(e){return e.id==t.parentIdFilter}))),t.filteredParentModes=e,t.metadataParentModes=e;var i=e.filter((function(e){return e.id==t.parentId}));i&&i.length>0&&(t.parentName=i[0].description,t.form.controls.parentId.setValue(i[0].id)),e&&e.length>0&&(t.parentExists=!0,t.form.controls.parentName.setValidators([r.y.required]))}})),this.form.controls.parentName.updateValueAndValidity()),this.form.controls.parentName.valueChanges.subscribe((function(e){t.filteredParentModes=t.filterParentMode(e)}))}},{key:"filterParentMode",value:function(t){return this.metadataParentModes.filter((function(e){return 0===e.description.toLowerCase().indexOf(t.toLowerCase())}))}},{key:"save",value:function(){var t=this;this.isCancel?(this.isCancel=!1,this.dialog.open(l.a,{data:{label:"Are you sure you want to Cancel?",selected:!1}}).afterClosed().subscribe((function(e){e&&t.dialogRef.close()}))):(Object.assign(this.defaults,this.form.value),this.defaults.mode=this.modeId,""==this.form.controls.parentId.value&&(this.defaults.parentId=0),this.masterDetailsService.createMasterDetails(this.defaults).subscribe((function(e){e?(t.notificationMessage("Master Details Created Successfully.","green-snackbar"),t.dialogRef.close("Success")):t.notificationMessage("Master Details Creation Failed.","red-snackbar")})))}},{key:"notificationMessage",value:function(t,e){this.snackbar.open(t,null,{duration:5e3,verticalPosition:"top",horizontalPosition:"end",panelClass:[e]})}},{key:"selectParentMode",value:function(t){var e=this;this.metadataParentModes.forEach((function(i){t.option.value==i.description&&(e.form.controls.parentName.setValue(i.description),e.form.controls.parentId.setValue(i.id))}))}},{key:"close",value:function(){this.dialogRef.close()}},{key:"closeDialog",value:function(){this.isCancel=!0}}]),t}();return t.\u0275fac=function(e){return new(e||t)(u.Nb(s.h),u.Nb(c.a),u.Nb(d.b),u.Nb(s.b),u.Nb(s.a),u.Nb(r.f))},t.\u0275cmp=u.Hb({type:t,selectors:[["fury-create-user-master"]],decls:27,vars:4,consts:[["mat-dialog-title",""],["role","toolbar",1,"task-header"],[1,"fx-spacer"],["mat-icon-button","",3,"click"],["title","Close","mat-list-icon",""],[3,"formGroup","ngSubmit"],[1,"mat-dlg-content"],[1,"person","padding-top"],["fxLayout","column","fxLayout.gt-sm","row","fxLayoutGap.gt-sm","20px"],["fxFlex","",4,"ngIf"],["fxFlex",""],["type","text","formControlName","description","matInput",""],[3,"ctrl"],["fxLayout","row","fxLayoutAlign","end center"],["mat-button","",3,"click"],["mat-button","",3,"disabled"],["matInput","","formControlName","parentName",3,"matAutocomplete","ngModel","ngModelChange"],[3,"optionSelected"],["parent","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){1&t&&(u.Tb(0,"div",0),u.Tb(1,"mat-toolbar",1),u.Tb(2,"span"),u.Rc(3,"Create Master Details"),u.Sb(),u.Ob(4,"span",2),u.Tb(5,"button",3),u.bc("click",(function(){return e.close()})),u.Tb(6,"mat-icon",4),u.Rc(7,"close"),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Tb(8,"form",5),u.bc("ngSubmit",(function(){return e.save()})),u.Tb(9,"mat-dialog-content",6),u.Tb(10,"fury-card"),u.Tb(11,"fury-card-content"),u.Tb(12,"div",7),u.Tb(13,"div",8),u.Pc(14,M,7,3,"mat-form-field",9),u.Tb(15,"mat-form-field",10),u.Tb(16,"mat-label"),u.Rc(17,"Item Name"),u.Sb(),u.Ob(18,"input",11),u.Ob(19,"app-show-errors",12),u.Tb(20,"mat-hint"),u.Rc(21,"Please enter Item Name"),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Sb(),u.Tb(22,"mat-dialog-actions",13),u.Tb(23,"button",14),u.bc("click",(function(){return e.closeDialog()})),u.Rc(24,"CANCEL"),u.Sb(),u.Tb(25,"button",15),u.Rc(26,"CREATE MASTER DETAILS"),u.Sb(),u.Sb(),u.Sb()),2&t&&(u.Cb(8),u.mc("formGroup",e.form),u.Cb(6),u.mc("ngIf",1==e.parentExists),u.Cb(5),u.mc("ctrl",e.form.get("description")),u.Cb(6),u.mc("disabled",!e.form.valid))},directives:[s.i,p.a,h.a,f.a,m.c,r.z,r.r,r.k,s.f,b.a,b.c,v.d,v.e,g.o,y.d,v.b,y.h,r.c,S.b,r.q,r.i,k.a,y.g,s.c,v.c,T.c,T.a,g.n,I.n],styles:[".task-header[_ngcontent-%COMP%]{background-color:transparent;padding:0 5px;height:20px}.fx-spacer[_ngcontent-%COMP%]{flex:1 1 auto}"]}),t}()}}])}();